Stochastically Transitive Models for Pairwise Comparisons: Statistical and Computational Issues
Nihar B. Shah∗, Sivaraman Balakrishnan , Adityanand Guntuboyina† and Martin J. Wainwright†∗
†Department of Statistics ∗Department of EECS University of California, Berkeley Berkeley, CA 94720 Department of Statistics Carnegie Mellon University,
5000 Forbes Ave, Pittsburgh, PA 15213

arXiv:1510.05610v4 [stat.ML] 28 Sep 2016

Abstract
There are various parametric models for analyzing pairwise comparison data, including the Bradley-Terry-Luce (BTL) and Thurstone models, but their reliance on strong parametric assumptions is limiting. In this work, we study a ﬂexible model for pairwise comparisons, under which the probabilities of outcomes are required only to satisfy a natural form of stochastic transitivity. This class includes parametric models including the BTL and Thurstone models as special cases, but is considerably more general. We provide various examples of models in this broader stochastically transitive class for which classical parametric models provide poor ﬁts. Despite this greater ﬂexibility, we show that the matrix of probabilities can be estimated at the same rate as in standard parametric models. On the other hand, unlike in the BTL and Thurstone models, computing the minimax-optimal estimator in the stochastically transitive model is non-trivial, and we explore various computationally tractable alternatives. We show that a simple singular value thresholding algorithm is statistically consistent but does not achieve the minimax rate. We then propose and study algorithms that achieve the minimax rate over interesting sub-classes of the full stochastically transitive class. We complement our theoretical results with thorough numerical simulations.

1 Introduction

Pairwise comparison data is ubiquitous and arises naturally in a variety of applications, including tournament play, voting, online search rankings, and advertisement placement problems. In rough terms, given a set of n objects along with a collection of possibly inconsistent comparisons between pairs of these objects, the goal is to aggregate these comparisons in order to estimate underlying properties of the population. One property of interest is the underlying matrix of pairwise comparison probabilities—that is, the matrix in which entry (i, j) corresponds to the probability that object i is preferred to object j in a pairwise comparison. The Bradley-Terry-Luce [BT52, Luc59] and Thurstone [Thu27] models are mainstays in analyzing this type of pairwise comparison data. These models are parametric in nature: more speciﬁcally, they assume the existence of an n-dimensional weight vector that measures the quality

Author email addresses: wainwrig@berkeley.edu.

nihar@eecs.berkeley.edu, siva@stat.cmu.edu, aditya@stat.berkeley.edu,

1

or strength of each item. The pairwise comparison probabilities are then determined via some ﬁxed function of the qualities of the pair of objects. Estimation in these models reduces to estimating the underlying weight vector, and a large body of prior work has focused on these models (e.g., see the papers [NOS12, HOX14, SBB+16]). However, such models enforce strong relationships on the pairwise comparison probabilities that often fail to hold in real applications. Various papers [DM59, ML65, Tve72, BW97] have provided experimental results in which these parametric modeling assumptions fail to hold.
Our focus in this paper is on models that have their roots in social science and psychology (e.g., see Fishburn [Fis73] for an overview), in which the only coherence assumption imposed on the pairwise comparison probabilities is that of strong stochastic transitivity, or SST for short. These models include the parametric models as special cases but are considerably more general. The SST model has been validated by several empirical analyses, including those in a long line of work [DM59, ML65, Tve72, BW97]. The conclusion of Ballinger et al. [BW97] is especially strongly worded:
All of these parametric c.d.f.s are soundly rejected by our data. However, SST usually survives scrutiny.
We are thus provided with strong empirical motivation for studying the fundamental properties of pairwise comparison probabilities satisfying SST.
In this paper, we focus on the problem of estimating the matrix of pairwise comparison probabilities—that is, the probability that an item i will beat a second item j in any given comparison. Estimates of these comparison probabilities are useful in various applications. For instance, when the items correspond to players or teams in a sport, the predicted odds of one team beating the other are central to betting and bookmaking operations. In a supermarket or an ad display, an accurate estimate of the probability of a customer preferring one item over another, along with the respective proﬁts for each item, can eﬀectively guide the choice of which product to display. Accurate estimates of the pairwise comparison probabilities can also be used to infer partial or full rankings of the underlying items.
Our contributions: We begin by studying the performance of optimal methods for estimating matrices in the SST class: our ﬁrst main result (Theorem 1) characterizes the minimax rate in squared Frobenius norm up to logarithmic factors. This result reveals that even though the SST class of matrices is considerably larger than the classical parametric class, surprisingly, it is possible to estimate any SST matrix at nearly the same rate as the classical parametric family. On the other hand, our achievability result is based on an estimator involving prohibitive computation, as a brute force approach entails an exhaustive search over permutations. Accordingly, we turn to studying computationally tractable estimation procedures. Our second main result (Theorem 2) applies to a polynomial-time estimator based on soft-thresholding the singular values of the data matrix. An estimator based on hard-thresholding was studied previously in this context by Chatterjee [Cha14]. We sharpen and generalize this previous analysis, and give a tight characterization of the rate achieved by both hard and soft-thresholding estimators. Our third contribution, formalized in Theorems 3 and 4, is to show how for certain interesting subsets of the full SST class, a combination of parametric maximum likelihood [SBB+16] and noisy sorting algorithms [BM08] leads to a tractable two-stage method that achieves the minimax rate. Our fourth contribution is to supplement our minimax lower bound with lower bounds for various known estimators, including those based on thresholding singular values [Cha14], noisy sorting [BM08], as well as parametric estimators [NOS12, HOX14, SBB+16]. These lower bounds show that none of these tractable estimators achieve the minimax rate uniformly over
2

the entire class. The lower bounds also show that the minimax rates for any of these subclasses is no better than the full SST class.
Related work: The literature on ranking and estimation from pairwise comparisons is vast and we refer the reader to various surveys [FV93, Mar96, Cat12] for a more detailed overview. Here we focus our literature review on those papers that are most closely related to our contributions. Some recent work [NOS12, HOX14, SBB+16] studies procedures and minimax rates for estimating the latent quality vector that underlie parametric models. Theorem 4 in this paper provides an extension of these results, in particular by showing that an optimal estimate of the latent quality vector can be used to construct an optimal estimate of the pairwise comparison probabilities. Chatterjee [Cha14] analyzed matrix estimation based on singular value thresholding, and obtained results for the class of SST matrices. In Theorem 2, we provide a sharper analysis of this estimator, and show that our upper bound is—in fact—unimprovable.
In past work, various authors [KMS07, BM08] have considered the noisy sorting problem, in which the goal is to infer the underlying order under a so-called high signal-to-noise ratio (SNR) condition. The high SNR condition means that each pairwise comparison has a probability of agreeing with the underlying order that is bounded away from 12 by a ﬁxed constant. Under this high SNR condition, these authors provide polynomial-time algorithms that, with high probability, return an estimate of true underlying order with a prescribed accuracy. Part of our analysis leverages an algorithm from the paper [BM08]; in particular, we extend their analysis in order to provide guarantees for estimating pairwise comparison probabilities as opposed to estimating the underlying order.
As will be clariﬁed in the sequel, the assumption of strong stochastic transitivity has close connections to the statistical literature on shape constrained inference (e.g., [SS11]), particularly to the problem of bivariate isotonic regression. In our analysis of the least-squares estimator, we leverage metric entropy bounds from past work in this area (e.g., [GW07, CGS15]).
In Appendix D of the present paper, we study estimation under two popular models that are closely related to the SST class, and make even weaker assumptions. We show that under these moderate stochastic transitivity (MST) and weak stochastic transitivity (WST) models, the Frobenius norm error of any estimator, measured in a uniform sense over the class, must be almost as bad as that incurred by making no assumptions whatsoever. Consequently, from a statistical point of view, these assumptions are not strong enough to yield reductions in estimation error. We note that the “low noise model” studied in the paper [RA14] is identical to the WST class.
Organization: The remainder of the paper is organized as follows. We begin by providing a background and a formal description of the problem in Section 2. In Section 3, we present the main theoretical results of the paper. We then present results from numerical simulations in Section 4. We present proofs of our main results in Section 5. We conclude the paper in Section 6.
2 Background and problem formulation
Given a collection of n ≥ 2 items, suppose that we have access to noisy comparisons between any pair i = j of distinct items. The full set of all possible pairwise comparisons can be described by a probability matrix M ∗ ∈ [0, 1]n×n, in which Mi∗j is the probability that item i is preferred to item j. The upper and lower halves of the probability matrix M ∗ are related by
3

the shifted-skew-symmetry condition1 Mj∗i = 1 − Mi∗j for all i, j ∈ [n]. For concreteness, we set Mi∗i = 1/2 for all i ∈ [n].

2.1 Estimation of pairwise comparison probabilities
For any matrix M ∗ ∈ [0, 1]n×n with Mi∗j = 1 − Mj∗i for every (i, j), suppose that we observe a random matrix Y ∈ {0, 1}n×n with (upper-triangular) independent Bernoulli entries, in particular, with P[Yij = 1] = Mi∗j for every 1 ≤ i ≤ j ≤ n and Yji = 1 − Yij. Based on observing Y , our goal in this paper is to recover an accurate estimate, in the squared Frobenius norm, of the full matrix M ∗.
Our primary focus in this paper will be on the setting where for n items we observe the outcome of a single pairwise comparison for each pair. We will subsequently (in Section 3.5) also address the more general case when we have partial observations, that is, when each pairwise comparison is observed with a ﬁxed probability.
For future reference, note that we can always write the Bernoulli observation model in the linear form

Y = M ∗ + W,

(1)

where W ∈ [−1, 1]n×n is a random matrix with independent zero-mean entries for every i ≥ j given by

1 − Mi∗j with probability Mi∗j

Wij ∼ −M ∗ with probability 1 − M ∗ ,

(2)

ij

ij

and Wji = −Wij for every i < j. This linearized form of the observation model is convenient for subsequent analysis.

2.2 Strong stochastic transitivity
Beyond the previously mentioned constraints on the matrix M ∗—namely that Mi∗j ∈ [0, 1] and Mi∗j = 1 − Mi∗j—more structured and interesting models are obtained by imposing further restrictions on the entries of M ∗. We now turn to one such condition, known as strong stochastic transitivity (SST), which reﬂects the natural transitivity of any complete ordering. Formally, suppose that the full collection of items [n] is endowed with a complete ordering π∗. We use the notation π∗(i) < π∗(j) to convey that item i is preferred to item j in the total ordering π∗. Consider some triple (i, j, k) such that π∗(i) < π∗(j). A matrix M ∗ satisﬁes the SST condition if the inequality Mi∗k ≥ Mj∗k holds for every such triple. The intuition underlying this constraint is the following: since i dominates j in the true underlying order, when we make noisy comparisons, the probability that i is preferred to k should be at least as large as the probability that j is preferred to k. The SST condition was ﬁrst described2 in the psychology literature (e.g., [Fis73, DM59]).
The SST condition is characterized by the existence of a permutation such that the permuted matrix has entries that increase across rows and decrease down columns. More precisely, for a given permutation π∗, let us say that a matrix M is π∗-faithful if for every pair (i, j) such that
1In other words, the shifted matrix M ∗ − 21 is skew-symmetric. 2We note that the psychology literature has also considered what are known as weak and moderate stochastic transitivity conditions. From a statistical standpoint, pairwise comparison probabilities cannot be consistently estimated in a minimax sense under these conditions. We establish this formally in Appendix D.

4

π∗(i) < π∗(j), we have Mik ≥ Mjk for all k ∈ [n]. With this notion, the set of SST matrices is given by
CSST = M ∈ [0, 1]n×n | Mba = 1 − Mab ∀ (a, b), and ∃ perm. π∗ s.t. M is π∗-faithful . (3)
Note that the stated inequalities also guarantee that for any pair with π∗(i) < π∗(j), we have Mki ≤ Mkj for all k, which corresponds to a form of column ordering. The class CSST is our primary focus in this paper.

2.3 Classical parametric models
Let us now describe a family of classical parametric models, one which includes Bradley-TerryLuce and Thurstone (Case V) models [BT52, Luc59, Thu27]. In the sequel, we show that these parametric models induce a relatively small subclass of the SST matrices CSST.
In more detail, parametric models are described by a weight vector w∗ ∈ Rn that corresponds to the notional qualities of the n items. Moreover, consider any non-decreasing function F : R → [0, 1] such that F (t) = 1 − F (−t) for all t ∈ R; we refer to any such function F as being valid. Any such pair (F, w∗) induces a particular pairwise comparison model in which

Mi∗j = F (wi∗ − wj∗) for all pairs (i, j).

(4)

For each valid choice of F , we deﬁne

CPAR(F ) = M ∈ [0, 1]n×n | M induced by Equation (4) for some w∗ ∈ Rn .

(5)

For any choice of F , it is straightforward to verify that CPAR(F ) is a subset of CSST, meaning that
any matrix M induced by the relation (4) satisﬁes all the constraints deﬁning the set CSST. As
particular important examples, we recover the Thurstone model by setting F (t) = Φ(t) where Φ is the Gaussian CDF, and the Bradley-Terry-Luce model by setting F (t) = 1+etet , corresponding to the sigmoid function.

Remark: One can impose further constraints on the vector w∗ without reducing the size of the class {CPAR(F ), for some valid F }. In particular, since the pairwise probabilities depend only on the diﬀerences wi∗ − wj∗, we can assume without loss of generality that w∗, 1 = 0. Moreover, since the choice of F can include rescaling its argument, we can also assume that w∗ ∞ ≤ 1. Accordingly, we assume in our subsequent analysis that w∗ belongs to the set
w ∈ Rn | such that w, 1 = 0 and w ∞ ≤ 1. .

2.4 Inadequacies of parametric models
As noted in the introduction, a large body of past work (e.g., [DM59, ML65, Tve72, BW97]) has shown that parametric models, of the form (5) for some choice of F , often provide poor ﬁts to real-world data. What might be a reason for this phenomenon? Roughly, parametric models impose the very restrictive assumption that the choice of an item depends on the value of a single latent factor (as indexed by w∗)—e.g., that our preference for cars depends only on their fuel economy, or that the probability that one hockey team beats another depends only on the skills of the goalkeepers.
This intuition can be formalized to construct matrices M ∗ ∈ CSST that are far away from every valid parametric approximation as summarized in the following result:

5

Proposition 1. There exists a universal constant c > 0 such that for every n ≥ 4, there exist matrices M ∗ ∈ CSST for which

1 inf

inf |||M − M ∗|||2 ≥ c.

(6)

n2 valid F M ∈CPAR(F )

F

Given that every entry of matrices in CSST lies in the interval [0, 1], the Frobenius norm diameter of the class CSST is at most n2, so that the scaling of the lower bound (6) cannot be sharpened.

See Appendix B for a proof of Proposition 1.

What sort of matrices M ∗ are “bad” in the sense of satisfying a lower bound of the form (6)?

Panel (a) of Figure 1 describes the construction of one “bad” matrix M ∗. In order to provide

some intuition, let us return to the analogy of rating cars. A key property of any parametric

model is that if we prefer car 1 to car 2 more than we prefer car 3 to car 4, then we must also

prefer car 1 to car 3 more than we prefer car 2 to car 4.3 This condition is potentially satisﬁed

if there is a single determining factor across all cars—for instance, their fuel economy.

This ordering condition is, however, violated by the pairwise comparison matrix M ∗ from

Figure 1(a).

In this example, we have M1∗2 =

6 8

>

5 8

= M3∗4

and M1∗3 =

7 8

<

8 8

= M2∗4.

Such

an occurrence can be explained by a simple two-factor model: suppose the fuel economies of

cars 1, 2, 3 and 4 are 20, 18, 12 and 6 kilometers per liter respectively, and the comfort levels

of the four cars are also ordered 1 2 3 4, with i j meaning that i is more comfortable

than j. Suppose that in a pairwise comparison of two cars, if one car is more fuel eﬃcient

by at least 10 kilometers per liter, it is always chosen. Otherwise the choice is governed by a

parametric choice model acting on the respective comfort levels of the two cars. Observe that

while the comparisons between the pairs (1, 2), (3, 4) and (1, 3) of cars can be explained by this

parametric model acting on their respective comfort levels, the preference between cars 1 and

4, as well as between cars 2 and 4, is governed by their fuel economies. This two-factor model

accounts for the said values of M1∗2, M3∗4, M2∗4 and M1∗3, which violate parametric requirements. While this was a simple hypothetical example, there is a more ubiquitous phenomenon

underlying our example. It is often the case that our preferences are decided by comparing

items on a multitude of dimensions. In any situation where a single (latent) parameter per

item does not adequately explain our preferences, one can expect that the class of parametric

models to provide a poor ﬁt to the pairwise preference probabilities.

The lower bound on approximation quality guaranteed by Proposition 1 means that any

parametric estimator of the matrix M ∗ should perform poorly. This expectation is conﬁrmed

by the simulation results in panel (b) of Figure 1. After generating observations from a “bad

matrix” over a range of n, we ﬁt the data set using either the maximum likelihood estimate

in the Thurstone model, or the singular value thresholding (SVT) estimator, to be discussed

in Section 3.2. For each estimator M , we plot the rescaled Frobenius norm error |||M−nM2 ∗|||2F versus the sample size. Consistent with the lower bound (6), the error in the Thurstone-based

estimator stays bounded above a universal constant. In contrast, the SVT error goes to zero

with n, an√d as our theory in the sequel shows, the rate at which the error decays is at least as fast as 1/ n.

3 Main results
Thus far, we have introduced two classes of models for matrices of pairwise comparison probabilities. Our main results characterize the rates of estimation associated with diﬀerent subsets
3This condition follows from the proof of Proposition 1.

6

Error ||M−M∗ ||2F /n2

2-5

4 6 7 8

2-6

M ∗ : = 1 2

4

7

8 

∈ Rn×n

8 1 1 4 5

2-7

0034

SVT Thurstone MLE

2-826 27 28 29 210 Number of items n

(a)

(b)

Figure 1. (a) Construction of a “bad” matrix: for n divisible by 4, form the matrix M ∗ ∈ Rn×n shown, where each block has dimensions n/4 × n/4. (b) Estimation for a class of SST matrices that are far from the parametric models. The parametric model (Thurstone MLE) yields a poor ﬁt, whereas ﬁtting using the singular value thresholding (SVT) estimator, which allows for estimates over the full SST class, leads to consistent estimation.

of these classes, using either optimal estimators (that we suspect are not polynomial-time computable), or more computationally eﬃcient estimators that can be computed in polynomialtime.

3.1 Characterization of the minimax risk

We begin by providing a result that characterizes the minimax risk in squared Frobenius norm
over the class CSST of SST matrices. The minimax risk is deﬁned by taking an inﬁmum over the set of all possible estimators, which are measurable functions Y → M ∈ [0, 1]n×n. Here the data matrix Y ∈ {0, 1}n×n is drawn from the observation model (1).

Theorem 1. There are universal constants 0 < c < cu such that

c

1

∗2

log2(n)

n ≤ iMnf M∗s∈uCpSST n2 E[|||M − M |||F] ≤ cu n , (7)

where the inﬁmum ranges over all measurable functions M of the observed matrix Y .
We prove this theorem in Section 5.1. The proof of the lower bound is based on extracting a particular subset of the class CSST such that any matrix in this subset has at least n positions that are unconstrained, apart from having to belong to the interval [ 21 , 1]. We can thus conclude that estimation of the full matrix is at least as hard as estimating n Bernoulli parameters belonging to the interval [ 12 , 1] based on a single observation per number. This reduction leads to an Ω(n−1) lower bound, as stated.
Proving an upper bound requires substantially more eﬀort. In particular, we establish it via careful analysis of the constrained least-squares estimator
M ∈ arg min |||Y − M |||2F. (8a)
M ∈CSST

7

In particular, we prove that there are universal constants (c0, c1, c2) such that, for any matrix M ∗ ∈ CSST, this estimator satisﬁes the high probability bound

1

∗2

log2(n)

−c n

P n2 |||M − M |||F ≥ c0 n ≤ c1e 2 .

(8b)

Since the entries of M and M ∗ all lie in the interval [0, 1], integrating this tail bound leads to the stated upper bound (7) on the expected mean-squared error. Proving the high probability bound (8b) requires sharp control on a quantity known as the localized Gaussian complexity of the class CSST. We use Dudley’s entropy integral (e.g., [VDVW96, Corollary 2.2.8]) in order to derive an upper bound that is sharp up to a logarithmic factor; doing so in turn requires deriving upper bounds on the metric entropy of the class CSST for which we leverage the prior work of Gao and Wellner [GW07].
We do not know whether the constrained least-squares estimator (8a) is computable in time polynomial in n, but we suspect not. This complexity is a consequence of the fact that the set CSST is not convex, but is a union of n! convex sets. Given this issue, it becomes interesting to consider the performance of alternative estimators that can be computed in polynomial-time.

3.2 Sharp analysis of singular value thresholding (SVT)

The ﬁrst polynomial-time estimator that we consider is a simple estimator based on threshold-

ing singular values of the observed matrix Y , and reconstructing its truncated singular value

decomposition. For the full class CSST, Chatterjee [Cha14] analyzed the performance of such

an

estimator

and

proved

that

the

squared

Frobenius

error

decays

as

O

(

n

−

1 4

)

uniformly

over

CSST.

In

this

section,

we

prove

that

its

error

decays

as

O

(

n

−

1 2

),

again

uniformly

over

CSST,

and

moreover, that this upper bound is unimprovable.

Let us begin by describing the estimator. Given the observation matrix Y ∈ Rn×n, we can write its singular value decomposition as Y = U DV T , where the (n × n) matrix D is diagonal,

whereas the (n × n) matrices U and V are orthonormal. Given a threshold level λn > 0, the

soft-thresholded version of a diagonal matrix D is the diagonal matrix Tλn(D) with values

[Tλn(D)]jj = max{0, Djj − λn} for every integer j ∈ [1, n].

(9)

With this notation, the soft singular-value-thresholded (soft-SVT) version of Y is given by Tλn(Y ) = U Tλn(D)V T . The following theorem provides a bound on its squared Frobenius error:

Theorem

2.

There

are

universal √

positive

constants

(cu, c0, c1)

such

that

the

soft-SVT

estimator

Mλn = Tλn(Y ) with λn = 2.1 n satisﬁes the bound

P n12 |||Mλn − M ∗|||2F ≥ √cun ≤ c0e−c1n

(10a)

for any M ∗ ∈ CSST. Moreover, there is a universal constant c > 0 such that for any choice of λn, we have

sup

1 |||Mλ

−

M ∗|||2

≥

c √

.

M ∗∈CSST n2

n

F

n

(10b)

8

A few comments on this result are in order. Since the matrices Mλn and M ∗ have entries in

the

unit

interval

[0, 1],

the

normalized

squared

error

1 n2

|||M

λ

n

−

M

∗

|||2F

is

at

most

1.

Consequently,

by integrating the the tail bound (10a), we ﬁnd that

sup

1 E[ |||Mλ

− M ∗|||2] ≤ √cu

+ c0e−c1n

≤ √cu .

M ∗∈CSST n2

n

F

n

n

On the other hand, the matching lower bound (10b) holds√with probability one, meaning that the soft-SVT estimator has squared error of the order 1/ n, irrespective of the realization of the noise.
To be clear, Chatterjee [Cha14] actually analyzed the hard-SVT estimator, which is based on the hard-thresholding operator

[Hλn (D)]jj = Djj 1{Djj ≥ λn}.

Here 1{·} denotes the 0-1-valued indicator function. In this setting, the hard-SVT estimator is simply, Hλn(Y ) = U Hλn(D)V T . With essentially the same choice of λn as above, Chatterjee showed that the estimate Hλn(Y ) has a mean-squared error of O(n−1/4). One can verify that the proof of Theorem 2 in our paper goes through for the hard-SVT estimator as well. Consequently the performance of the hard-SVT estimator is of the order Θ(n−1/2), and is identical to that of
the soft-thresholded version up to universal constants.
Note that the hard and soft-SVT estimators return matrices that may not lie in the SST
class CSST. In a companion paper [SBW16], we provide an alternative computationally-eﬃcient estimator with similar statistical guarantees that is guaranteed to return a matrix in the SST
class.
Together the upper and lower bounds of Theorem 2 provide a sharp characterization of the
behavior of the soft/hard SVT estimators. On the positive side, t√hese are easily implementable estimators that achieve a mean-squared error bounded by O(1/ n) uniformly over the entire class CSST. On the negative side, this rate is slower than the O(log2 n/n) rate achieved by the least-squares estimator, as in Theorem 1.
In conjunction, Theorems 1 and 2 raise a natural open question: is there a polynomial-time
estimator that achieves the minimax rate uniformly over the family CSST? We do not know the answer to this question, but the following subsections provide some partial answers by analyzing some polynomial-time estimators that (up to logarithmic factors) achieve the optimal O˜(1/n)-
rate over some interesting sub-classes of CSST. In the next two sections, we turn to results of this type.

3.3 Optimal rates for high SNR subclass
In this section, we describe a multi-step polynomial-time estimator that (up to logarithmic factors) can achieve the optimal O˜(1/n) rate over an interesting subclass of CSST. This subset corresponds to matrices M that have a relatively high signal-to-noise ratio (SNR), meaning that no entries of M fall within a certain window of 1/2. More formally, for some γ ∈ (0, 12 ), we deﬁne the class

CHIGH(γ) = M ∈ CSST | max(Mij, Mji) ≥ 1/2 + γ ∀ i = j .

(11)

By construction, for any matrix CHIGH(γ), the amount of information contained in each obser-
vation is bounded away from zero uniformly in n, as opposed to matrices in which some large subset of entries have values equal (or arbitrarily close) to 21 . In terms of estimation diﬃculty,

9

this SNR restriction does not make the problem substantially easier: as the following theorem
shows, the minimax mean-squared error remains lower bounded by a constant multiple of 1/n.
Moreover, we can demonstrate a polynomial-time algorithm that achieves this optimal mean
squared error up to logarithmic factors. The following theorem applies to any ﬁxed γ ∈ (0, 21 ] independent of n, and involves con-
stants (c , cu, c) that may depend on γ but are independent of n.

Theorem 3. There is a constant c > 0 such that

inf sup 1 E |||M − M ∗|||2] ≥ c ,

M M ∗∈CHIGH(γ) n2

Fn

(12a)

where the inﬁmum ranges over all estimators. Moreover, there is a two-stage estimator M , computable in polynomial-time, for which

1

∗ 2 cu log2(n)

P n2 |||M − M |||F ≥ n

valid for any M ∗ ∈ CHIGH(γ).

c ≤ n2 ,

(12b)

As

before,

since

the

ratio

1 n2

|||M

− M ∗|||2F

is

at

most

1,

so

the

tail

bound

(12b)

implies

that

1

∗ 2 cu log2(n) c

cu log2(n)

M∗∈sCuHpIGH(γ) n2 E[|||M − M |||F] ≤ n + n2 ≤

. n

(13)

We provide the proof of this theorem in Section 5.3. As with our proof of the lower bound in Theorem 1, we prove the lower bound by considering the sub-class of matrices that are free only on the two diagonals just above and below the main diagonal. We now provide a brief sketch for the proof of the upper bound (12b). It is based on analyzing the following two-step procedure:

1. In the ﬁrst step of algorithm, we ﬁnd a permutation πFAS of the n items that minimizes the total number of disagreements with the observations. (For a given ordering, we say that any pair of items (i, j) are in disagreement with the observation if either i is rated higher than j in the ordering and Yij = 0, or if i is rated lower than j in the ordering and Yij = 1.) The problem of ﬁnding such a disagreement-minimizing permutation πFAS is commonly known as the minimum feedback arc set (FAS) problem. It is known to be NPhard in the worst-case [ACN08, Alo06], but our set-up has additional probabilistic structure that allows for polynomial-time solutions with high probability. In particular, we call upon a polynomial-time algorithm due to Braverman and Mossel [BM08] that, under the model (11), is guaranteed to ﬁnd the exact solution to the FAS problem with high probability. Viewing the FAS permutation πFAS as an approximation to the true permutation π∗, the novel technical work in this ﬁrst step is show that πFAS is “good enough” for Frobenius norm estimation, in the sense that for any matrix M ∗ ∈ CHIGH(γ), it satisﬁes the bound

n12 |||π∗(M ∗) − πFAS(M ∗)|||2F ≤ c long n

(14a)

with high probability. In this statement, for any given permutation π, we have used π(M ∗)

to denote the matrix obtained by permuting the rows and columns of M ∗ by π. The term

1 n2

|||π∗(M

∗)

−

πFAS(M

∗)|||2F

can

be

viewed

in

some

sense

as

the

bias

in

estimation

incurred

from using πFAS in place of π∗.

10

2. Next we deﬁne CBISO as the class of “bivariate isotonic” matrices, that is, matrices M ∈ [0, 1]n×n that satisfy the linear constraints Mij = 1 − Mji for all (i, j) ∈ [n]2, and Mk ≥ Mij whenever k ≤ i and ≥ j. This class corresponds to the subset of matrices CSST that are faithful with respect to the identity permutation. Letting πFAS(CBISO) = {πFAS(M ), M ∈ C } BISO denote the image of this set under πFAS, the second step involves computing the constrained least-squares estimate

M ∈ arg min |||Y − M |||2F.
M ∈πFAS(CBISO)

(14b)

Since the set πFAS(CBISO) is a convex polytope, with a number of facets that grows polynomially in n, the constrained quadratic program (14b) can be solved in polynomial-time. The ﬁnal step in the proof of Theorem 3 is to show that the estimator M also has mean-squared error that is upper bounded by a constant multiple of logn2(n) .
Our analysis shows that for any ﬁxed γ ∈ (0, 21 ], the proposed two-step estimator works well for any matrix M ∗ ∈ CHIGH(γ). Since this two-step estimator is based on ﬁnding a minimum feedback arc set (FAS) in the ﬁrst step, it is natural to wonder whether an FAS-based estimator works well over the full class CSST. Somewhat surprisingly the answer to this question turns out to be negative: we refer the reader to Appendix C for more intuition and details on why the minimal FAS estimator does not perform well over the full class.

3.4 Optimal rates for parametric subclasses

Let us now return to the class of parametric models CPAR(F ) introduced earlier in Section 2.3. As shown previously in Proposition 1, this class is much smaller than the class CSST, in the sense that there are models in CSST that cannot be well-approximated by any parametric model. Nonetheless, in terms of minimax rates of estimation, these classes diﬀer only by logarithmic factors. An advantage of the parametric class is that it is possible to achieve the 1/n minimax rate by using a simple, polynomial-time estimator. In particular, for any log concave function F , the maximum likelihood estimate wML can be obtained by solving a convex program. This MLE induces a matrix estimate M (wML) via Equation (4), and the following result shows that this estimator is minimax-optimal up to constant factors.

Theorem 4. Suppose that F is strictly increasing, strongly log-concave and twice diﬀerentiable. Then there is a constant c > 0, depending only on F , such that the minimax risk over CPAR(F ) is lower bounded as

inf sup 1 E[|||M − M ∗|||2] ≥ c ,

M M ∗∈CPAR(F ) n2

Fn

(15a)

Conversely, there is a constant cu ≥ c , depending only on F , such that the matrix estimate M (wML) induced by the MLE satisﬁes the bound

sup n12 E[|||M (wML) − M ∗|||2F] ≤ cnu .
M ∗∈CPAR(F )

(15b)

To be clear, the constants (c , cu) in this theorem are independent of n, but they do depend on the speciﬁc properties of the given function F . We note that the stated conditions on F are true for many popular parametric models, including (for instance) the Thurstone and BTL models.

11

We provide the proof of Theorem 4 in Section 5.4. The lower bound (15a) is, in fact, stronger than the the lower bound in Theorem 1, since the supremum is taken over a smaller class. The proof of the lower bound in Theorem 1 relies on matrices that cannot be realized by any parametric model, so that we pursue a diﬀerent route to establish the bound (15a). On the other hand, in order to prove the upper bound (15b), we make use of bounds on the accuracy of the MLE wML from our own past work (see the paper [SBB+16]).

3.5 Extension to partial observations

We now consider the extension of our results to the setting in which not all entries of Y are

observed. Suppose instead that every entry of Y is observed independently with probability

pobs. In other words, the set of pairs compared is the set of edges of an Erd˝os-R´enyi graph

G(n, pobs) that has the n items as its vertices.

In this setting, we obtain an upper bound on the minimax risk of estimation by ﬁrst setting

Yij

=

1 2

whenever

the

pair

(i, j)

is

not

compared,

then

forming

a

new

(n × n)

matrix

Y

as

Y : = 1 Y − 1 − pobs 11T ,

pobs

2pobs

(16a)

and ﬁnally computing the least squares solution

M ∈ arg min |||Y − M |||2F.
M ∈CSST

(16b)

Likewise, the computationally-eﬃcient singular value thresholding estimator is also obtained by thresholding the singular values of Y with a threshold λn = 3 ponbs . See our discussion following Theorem 5 for the motivation underlying the transformed matrix Y .
The parametric estimators continue to operate on the original (partial) observations, ﬁrst computing a maximum likelihood estimate wML of M ∗ using the observed data, and then computing the associated pairwise-comparison-probability matrix M (wML) via (4).

Theorem 5. In the setting where each pair is observed with a probability pobs, there are positive universal constants c , cu and c0 such that:

(a) The minimax risk is sandwiched as

when pobs ≥ cn0 .

c

1

∗ 2 cu(log n)2

pobsn ≤ iMnf M∗s∈uCpSST n2 E[|||M − M |||F] ≤

, pobsn

(17a)

(b) The soft-SVT estimator, Mλn with λn = 3 ponbs , satisﬁes the bound

sup

1 E[|||Mλ

− M ∗|||2] ≤ √ cu

.

M ∗∈CSST n2

n

F

npobs

(17b)

(c) For a parametric sub-class based on a strongly log-concave and smooth F , the estimator M (wML) induced by the maximum likelihood estimate wML of the parameter vector w∗ has mean-squared error upper bounded as

sup

1 E[|||M (w

) − M ∗|||2] ≤

cu ,

n2

ML

F pobsn

M ∗∈CPAR(F )

(17c)

when pobs ≥ c0(long n)2 .

12

The intuition behind the transformation (16a) is that the matrix Y written in a linearized form as

Y

= M∗ +

1 W,

pobs

can equivalently be (18a)

where W has entries that are independent on and above the diagonal, satisfy skew-symmetry, and are distributed as

pobs( 12

−

[M ∗]ij)

+

1 2



[W ]ij =

pobs( 12

−

[M ∗]ij)

−

1 2

pobs( 12 − [M ∗]ij )

with probability pobs[M ∗]ij with probability pobs(1 − [M ∗]ij) with probability 1 − pobs.

(18b)

The proofs of the upper bounds exploit the speciﬁc relation (18a) between the observations Y

and the true matrix M ∗, and the speciﬁc form of the additive noise (18b).

The result of Theorem 5(b) yields an aﬃrmative answer to the question, originally posed

by Chatterjee [Cha14], of whether or not the singular value thresholding estimator can yield a vanishing error when pobs ≤ √1n .
We note that we do not have an analogue of the high-SNR result in the partial observations

case since having partial observations reduces the SNR. In general, we are interested in scalings

of pobs which allow pobs → 0 as n → ∞. The noisy-sorting algorithm of Braverman and Mossel [BM08] for the high-SNR case has computational complexity scaling as eγ−4, and hence

is

not

computable

in

time

polynomial

in

n

when

γ

<

(log

n)−

1 4

.

This

restriction

disallows

most

interesting scalings of pobs with n.

4 Simulations
In this section, we present results from simulations to gain a further understanding of the problem at hand, in particular to understand the rates of estimation under speciﬁc generative models. We investigate the performance of the soft-SVT estimator (Section 3.2) and the maximum likelihood estimator under the Thurstone model (Section 2.3).4 The output of the SVT estimator need not lie in the set [0, 1]n×n of matrices; in our implementation, we take a projection of the output of the SVT estimator on this set, which gives a constant factor reduction in the error.
In our simulations, we generate the ground truth M ∗ in the following ﬁve ways:
• Uniform: The matrix M ∗ is generated by drawing n2 values independently and uniformly at random in [ 12 , 1] and sorting them in descending order. The values are then inserted above the diagonal of an (n × n) matrix such that the entries decrease down a column or left along a row. We then make the matrix skew-symmetric and permute the rows and columns.
• Thurstone: The matrix M ∗ ∈ [−1, 1]n is generated by ﬁrst choosing w∗ uniformly at random from the set satisfying w∗, 1 = 0. The matrix M ∗ is then generated from w∗ via Equation (4) with F chosen as the CDF of the standard normal distribution.
4We could not compare the algorithm that underlies Theorem 3, since it is not easily implementable. In particular, it relies on the algorithm due to Braverman and Mossel [BM08] to compute the feedback arc set minimizer. The computational complexity of this algorithm, though polynomial in n, has a large polynomial degree which precludes it from being implemented for matrices of any reasonable size.
The simulations in this section add to the simulation results of Section 2.4 (Figure 1) demonstrating a large class of matrices in the SST class that cannot be represented by any parametric class.

13

Error ||M−M∗ ||2F /n2

2-5 2-6 2-7 2-8 2-9 2-10 2-11 2-12 26

27 28 29 210 Number of items n

Error ||M−M∗ ||2F /n2

2-5 2-6 2-7 2-8 2-9 2-10 2-11 2-12 26

27 28 29 210 Number of items n

2-6 2-7 2-8 2-9 2-10 2-11 2-12 26

27 28 29 210 Number of items n

Error ||M−M∗ ||2F /n2

(a) Uniform
2-3
2-4
2-5
2-626 27 28 29 210 Number of items n

Error ||M−M∗ ||2F /n2

(b) Thurstone
2-3
2-4
2-526 27 28 29 210 Number of items n

(c) BTL

(d) High SNR

(e) Independent bands

Figure 2. Errors of singular value thresholding (SVT) estimator and the Thurstone MLE under diﬀerent methods to generate M ∗.

Error ||M−M∗ ||2F /n2

• Bradley-Terry-Luce (BTL): Identical to the Thurstone case, except that F is given by the sigmoid function.
• High SNR: A setting studied previously by Braverman and Mossel [BM08], in which the noise is independent of the items being compared. Some global order is ﬁxed over the n items, and the comparison matrix M ∗ takes the values Mi∗j = 0.9 = 1 − Mj∗i for every pair (i, j) where i is ranked above j in the underlying ordering. The entries on the diagonal are 0.5.
• Independent bands: The matrix M ∗ is chosen with diagonal entries all equal to 12 . Entries on diagonal band immediately above the diagonal itself are chosen i.i.d. and uniformly at random from [ 21 , 1]. The band above is then chosen uniformly at random from the allowable set, and so on. The choice of any entry in this process is only constrained to be upper bounded by 1 and lower bounded by the entries to its left and below. The entries below the diagonal are chosen to make the matrix skew-symmetric.
Figure 2 depicts the results of the simulations based on observations of the entire matrix Y . Each point is an average across 20 trials. The error bars in most cases are too small and hence not visible. We see that the uniform case (Figure 2a) is favorable for both estimators, with the error scaling as O( √1n ). With data generated from the Thurstone model, both estimators continue to perform well, and the Thurstone MLE yields an error of the order n1 (Figure 2b).

14

Interestingly, the Thurstone model also ﬁts relatively well when data is generated via the BTL model (Figure 2c). This behavior is likely a result of operating in the near-linear regime of the logistic and the Gaussian CDF where the two curves are similar. In these two parametric settings, the SVT estimator has squared error strictly worse than order n1 but better than √1n . The Thurstone model, however, yields a poor ﬁt for the model in the high-SNR (Figure 2d) and the independent bands (Figure 2e) cases, incurring a constant error as compared to an error scaling as O( √1n ) for the SVT estimator. We recall that the poor performance of the Thurstone estimator was also described previously in Proposition 1 and Figure 1.
In summary, we see that while the Thurstone MLE estimator gives minimax optimal rates of estimation when the underlying model is parametric, it can be inconsistent when the parametric assumptions are violated. On the other hand, the SVT estimator is robust to violations of parametric assumptions, and while it does not necessarily give minimax-optimal rates, it remains consistent across the entire SST class. Finally, we remark that our theory predicts that the least squares estimator, if implementable, would outperform both these estimators in terms of statistical error.

5 Proofs of main results
This section is devoted to the proofs of our main results–namely, Theorems 1 through 5. Throughout these and other proofs, we use the notation {c, c , c0, C, C } and so on to denote positive constants whose values may change from line to line. In addition, we assume throughout that n is lower bounded by a universal constant so as to avoid degeneracies. For any square matrix A ∈ Rn×n, we let {σ1(A), . . . , σn(A)} denote its singular values (ordered from largest to smallest), and similarly, for any symmetric matrix M ∈ Rn×n, we let {λ1(M ), . . . , λn(M )} denote its ordered eigenvalues. The identity permutation is one where item i is the ith most preferred item, for every i ∈ [n].

5.1 Proof of Theorem 1
This section is devoted to the proof of Theorem 1, including both the upper and lower bounds on the minimax risk in squared Frobenius norm.

5.1.1 Proof of upper bound
Deﬁne the diﬀerence matrix ∆: =M - M ∗ between M ∗ and the optimal solution M to the constrained least-squares problem. Since M is optimal and M ∗ is feasible, we must have |||Y − M |||2F ≤ |||Y − M ∗|||2F, and hence following some algebra, we arrive at the basic inequality

1 |||∆|||2 ≤ ∆, W ,

(19)

2

F

where W ∈ Rn×n is the noise matrix in the observation model (1), and A, B : = trace(AT B) denotes the trace inner product.
We introduce some additional objects that are useful in our analysis. The class of bivariate isotonic matrices CBISO is deﬁned as

CBISO : = M ∈ [0, 1]n×n | Mk ≥ Mij whenever k ≤ i and ≥ j .

(20)

15

For a given permutation π and matrix M , we let π(M ) denote the matrix obtained by applying π to its rows and columns. We then deﬁne the set

CDIFF : = π1(M1) − π2(M2) | for some M1, M2 ∈ C , BISO and perm. π1 and π2 .

(21)

corresponding to the set of diﬀerence matrices. Note that CDIFF ⊂ [−1, 1]n×n by construction. One can verify that for any M ∗ ∈ CSST, we are guaranteed the inclusion
{M − M ∗ | M ∈ CSST, |||M − M ∗|||F ≤ t} ⊂ CDIFF ∩ {|||D|||F ≤ t}.

Consequently, the error matrix ∆ must belong to C , DIFF and so must satisfy the properties deﬁning this set. Moreover, as we discuss below, the set CDIFF is star-shaped, and this property plays an important role in our analysis.
For each choice of radius t > 0, deﬁne the random variable

Z(t) : =

sup

D, W .

D∈CDIFF,|||D|||F≤t

(22)

Using our earlier basic inequality (19), the Frobenius norm error |||∆|||F then satisﬁes the bound
12 |||∆|||2F ≤ ∆, W ≤ Z |||∆|||F . (23)
Thus, in order to obtain a high probability bound, we need to understand the behavior of the random quantity Z(δ).
One can verify that the set CDIFF is star-shaped, meaning that αD ∈ CDIFF for every α ∈ [0, 1] and every D ∈ C . DIFF Using this star-shaped property, we are guaranteed that there is a nonempty set of scalars δn > 0 satisfying the critical inequality
E[Z(δn)] ≤ δn2 . (24) 2
Our interest is in the smallest (strictly) positive solution δn to the crit√ical inequality (24), and moreover, our goal is to show that for every t ≥ δn, we have |||∆|||F ≤ c tδn with probability at least 1 − c1e−c2ntδn .
For each t > 0, deﬁne the “bad” event At as

At = ∃∆ ∈ CDIFF | |||∆|||F ≥ tδn and ∆, W ≥ 2|||∆|||F tδn .

(25)

Using the star-shaped property of C , DIFF it follows by a rescaling argument that

P[At] ≤ P Z(δn) ≥ 2δn tδn

for all t ≥ δn.

The entries of W lie in [−1, 1], are i.i.d. on and above the diagonal, are zero-mean, and satisfy skew-symmetry. Moreover, the function W → Z(t) is convex and Lipschitz with parameter t. Consequently, from known concentration bounds(e.g., [Led01, Theorem 5.9], [Sam00]) for convex Lipschitz functions, we have

P Z(δn) ≥ E[Z(δn)] + tδnδn ≤ 2e−c1tδn for all t ≥ δn. √
By the deﬁnition of δn, we have E[Z(δn)] ≤ δn2 ≤ δn tδn for any t ≥ δn, and consequently
P[At] ≤ P[Z(δn) ≥ 2δn tδn ≤ 2e−c1tδn for all t ≥ δn.

16

√

√

Consequently, either |||∆|||F ≤ tδn, or we have |||∆|||F > tδn. In the latter c√ase, conditioning

on

the

complement √

Act ,

our

basic

inequality

implies

that

12 |||∆|||2F

≤

2|||∆|||F

tδn, and hence

|||∆|||F ≤ 4 tδn with probability at least 1 − 2e−c1tδn. Putting together the pieces yields that

|||∆|||F ≤ c0 tδn

(26)

with probability at least 1 − 2e−c1tδn for every t ≥ δn. In order to determine a feasible δn satisfying the critical inequality (24), we need to bound
the expectation E[Z(δn)]. We do using Dudley’s entropy integral and bounding the metric entropies of certain sub-classes of matrices. In particular, the remainder of this section is
devoted to proving the following claim:

Lemma 1. There is a universal constant C such that

E[Z(t)] ≤ C n log2(n) + t n log n ,

(27)

for all t ∈ [0, 2n].
√ Given this lemma, we see that the critical inequality (24) is satisﬁed with δn = C n log n. Consequently, from our bound (26), there are universal positive constants C and c1 such that

|||∆|||2F ≤ C log2(n) ,

n2

n

with probability at least 1 − 2e−c1n(log n)2, which completes the proof.

Proof of Lemma 1: It remains to prove Lemma 1, and we do so by using Dudley’s entropy integral, as well as some auxiliary results on metric entropy. We use the notation log N ( , C, ρ) to denote the metric entropy of the class C in the metric ρ. Our proof requires the following auxiliary lemma:

Lemma 2. For every > 0, we have the metric entropy bound

n2

n2

log N ( , CDIFF, |||.|||F) ≤ 9 2 log + 9n log n.

See the end of this section for the proof of this claim. Letting BF (t) denote the Frobenius norm ball of radius t, the truncated form of Dudley’s entropy integral inequality (e.g., [VDVW96, Corollary 2.2.8]) yields that the mean E[Z(t)] is upper bounded as

t

E[Z(t)]] ≤ c inf nδ +

δ∈[0,n]

δ

2

log N ( , CDIFF ∩ BF (t), |||.|||F)d

t
≤ c n−8 +
12 n−9

log N ( , CDIFF, |||.|||F)d ,

(28)

where the second step follows by setting δ = n−9, and making use of the set inclusion (CDIFF ∩ BF (t)) ⊆ C . DIFF For any ≥ 12 n−9, applying Lemma 2 yields the upper bound
nn log N ( , CDIFF, |||.|||F) ≤ c log + n log n .

17

Over the range

≥ n−9/2, we have log n ≤ c log n, and hence n
log N ( , CDIFF, |||.|||F) ≤ c log n + n log n .

Substituting this bound into our earlier inequality (28) yields E[Z(t)] ≤ c n−8 + n log n log(nt) + t n log n
(i)
≤ c n log n log(n2) + t n log n ≤ c n log2(n) + t n log n ,

where step (i) uses the upper bound t ≤ 2n.

The only remaining detail is to prove Lemma 2.

Proof of Lemma 2: We ﬁrst derive an upper bound on the metric entropy of the class CBISO deﬁned previously in equation (20). In particular, we do so by relating it to the set of all bivariate monotonic functions on the square [0, 1] × [0, 1]. Denoting this function class by F, for any matrix M ∈ C , BISO we deﬁne a function gM ∈ F via

gM (x, y) = M n(1−x) , ny .

In order to handle corner conditions, we set M0,i = M1,i and Mi,0 = Mi,1 for all i. With this deﬁnition, we have

11 2

2

1n n 2 1

2

gM 2 = x=0 y=0(gM (x, y)) dxdy = n2 i=1 j=1 Mi,j = n2 |||M |||F.

As a consequence, the metric entropy can be upper bounded as

log N ( , CBISO, |||.|||F) ≤ log N n , F , . 2

(i) n2

n2

≤ 2 log ,

(29)

where inequality (i) follows from Theorem 1.1 of Gao and Wellner [GW07]. We now bound the metric entropy of CDIFF in terms of the metric entropy of C . BISO For any
> 0, let CBISO denote an -covering set in CBISO that satisﬁes the inequality (29). Consider the set
CDIFF : = {π1(M1) − π2(M2) | for some permutations π1, π2 and some M1, M2 ∈ CB/IS2O}.

For any D ∈ C , DIFF we can write D = π1(M1)−π2(M2) for some permutations π1 and π2 and some

matrices M1

and M2 ∈ C . BISO

We

know

there

exist

matrices

M1, M2

∈

C /2 BISO

such that |||M1 −

M1|||F ≤ /2 and |||M2 − M2|||F ≤ /2. With these choices, we have π1(M1) − π2(M2) ∈ C , DIFF

and moreover

|||D − (π1(M1) − π2(M2))|||2F ≤ 2|||π1(M1) − π1(M1)|||2F + 2|||π2(M2) − π1(M2)|||2F ≤ 2.

18

Thus the set CDIFF forms an -covering set for the class C . DIFF One can now count the number of elements in this set to ﬁnd that
N ( , CDIFF, |||.|||F) ≤ n!N ( /2, CBISO, |||.|||F) 2.
Some straightforward algebraic manipulations yield the claimed result.

5.1.2 Proof of lower bound
We now turn to the proof of the lower bound in Theorem 1. We may assume that the correct row/column ordering is ﬁxed and known to be the identity permutation. Here we are using the fact that revealing the knowledge of this ordering cannot make the estimation problem any harder. Recalling the deﬁnition (20) of the bivariate isotonic class C , BISO consider the subclass

CSST : = {M ∈ CBISO | Mi,j = 1 when j > i + 1 and Mi,j = 1 − Mj,i when j ≤ i}

Any matrix M is this subclass can be identiﬁed with the vector q = q(M ) ∈ Rn−1 with elements qi : = Mi,i+1. The only constraint imposed on q(M ) by the inclusion M ∈ CSST is that qi ∈ [ 12 , 1] for all i = 1, . . . , n − 1.
In this way, we have shown that the diﬃculty of estimating M ∗ ∈ CSST is at least as hard as that of estimating a vector q ∈ [ 12 , 1]n−1 based on observing the random vector Y = {Y1,2, . . . , Yn−1,n} with independent coordinates, and such that each Yi,i+1 ∼ Ber(qi).
For this problem, it is easy to show that there is a universal constant c > 0 such that

inf sup E
q q∈[ 1 ,1]n−1
2

q − q 22 ≥ c2 n,

where the inﬁmum is taken over all measurable functions Y → q. Putting together the pieces, we have shown that

inf sup 1 E[|||Mˆ − M ∗|||2] ≥ 2 inf sup E[ q − q 2] ≥ c ,

M M ∗∈CSST n2

F

n2 q q∈[0.5,1]n−1

2n

as claimed.

5.2 Proof of Theorem 2
Recall from equation (1) that we can write our observation model as Y = M ∗ + W , where W ∈ Rn×n is a zero-mean matrix with entries that are drawn independently (except for the skew-symmetry condition) from the interval [−1, 1].

5.2.1 Proof of upper bound Our proof of the upper bound hinges upon the following two lemmas.
Lemma 3. If λn ≥ 1.01|||W |||op, then
n
|||Tλn (Y ) − M ∗|||2F ≤ c min λ2n, σj2(M ∗) ,
j=1
where c is a positive universal constant.

19

Our second lemma is an approximation-theoretic result:

Lemma 4. For any matrix M ∗ ∈ CSST and any s ∈ {1, 2, . . . , n − 1}, we have

1n 2∗ 1

n2

σj (M

)≤

. s

j=s+1

See the end of this section for the proofs of these two auxiliary results.5 Based on these two lemmas, it is easy to complete the proof of the theorem. The entries of
W are zero-mean with entries in the interval [−1, 1], are i.i.d. on and above the diagonal, and satisfy skew-symmetry. Consequently, we may apply Theorem 3.4 of Chatterjee [Cha14], which guarantees that
P |||W |||op > (2 + t)√n ≤ ce−f(t)n,

where c is a univers√al constant, and the quantity f (t) is strictly positive for each t > 0. Thus, the choice λn = 2.1 n guarantees that λn ≥ 1.01|||W |||op with probability at least 1 − ce−cn, as is required for applying Lemma 3. Applying this lemma guarantees that the upper bound

n
|||Tλn(Y ) − M ∗|||2F ≤ c min n, σj2(M ∗)
j=1

hold with probability at least 1 − c1e−c2n. From Lemma 4, with probability at least 1 − c1e−c2n, we have
n12 |||Tλn(Y ) − M ∗|||2F ≤ c ns + 1s √
for all s ∈ {1, . . . , n}. Setting s = n and performing some algebra shows that

P n12 |||Tλn (Y ) − M ∗|||2F > √cun ≤ c1e−c2n,

as

claimed.

Since

1 n2

|||Tλn

(Y

)

−

M

∗|||2F

≤

1,

we

are

also

guaranteed

that

n12 E[|||Tλn (Y ) − M ∗|||2F] ≤ √cun + c1e−c2n ≤ √cun .

Proof of Lemma 3 Fix δ = 0.01. Let b be the number of singular values of M ∗ above 1+δ δ λn, and let Mb∗ be the version of M ∗ truncated to its top b singular values. We then have

|||Tλn (Y ) − M ∗|||2F ≤ 2|||Tλn (Y ) − Mb∗|||2F + 2|||Mb∗ − M ∗|||2F

n

≤ 2 rank(Tλn (Y ) − Mb∗)|||Tλn (Y ) − Mb∗|||2op + 2

σj2(M ∗).

j=b+1

We claim that Tλn(Y ) has rank at most b. Indeed, for any j ≥ b + 1, we have
σj(Y ) ≤ σj(M ∗) + |||W |||op ≤ λn,
5As a side note, in Section 5.2.2 we present a construction of a matrix M ∗ ∈ CSST using which we show that the bound of Lemma 4 is sharp up to a constant factor when s = o(n); this result is essential in proving the sharpness of the result of Theorem 2.

20

where we have used the facts that σj(M ∗) ≤ 1+δ δ λn for every j ≥ b + 1 and λn ≥ (1 + δ)|||W |||op. As a consequence we have σj(Tλn(Y )) = 0, and hence rank(Tλn(Y ) − Mb∗) ≤ 2b. Moreover, we have

|||Tλn (Y ) − Mb∗|||op ≤ |||Tλn (Y ) − Y |||op + |||Y − M ∗|||op + |||M ∗ − Mb∗|||op δ
≤ λn + |||W |||op + 1 + δ λn ≤ 2λn.

Putting together the pieces, we conclude that

n

(i)

n

|||Tλn(Y ) − M ∗|||2F ≤ 16bλ2n + 2

σj2(M ∗) ≤ C min{σj2(M ∗), λ2n},

j=b+1

j=1

for some constant6 C. Here inequality (i) follows since σj(M ∗) ≤ 1+δ δ λn whenever j ≥ b + 1 and σj(M ∗) > 1+δ δ λn whenever j ≤ b.

Proof of Lemma 4 In this proof, we make use of a construction due to Chatterjee [Cha14].

For a given matrix M ∗, we can deﬁne the vector t ∈ Rn of row sums—namely, with entries

ti =

n j=1

Mi∗j

for

i ∈ [n].

Using

this

vector,

we

can

deﬁne

a

rank

s

approximation

M

to

the

original matrix M ∗ by grouping the rows according to the vector t according to the following

procedure:

• Observing that each ti ∈ [0, n], let us divide the full interval [0, n] into s groups—say of the form [0, n/s), [n/s, 2n/s), . . . [(s − 1)n/s, n]. If ti falls into the interval α for some α ∈ [s], we then map row i to the group Gα of indices.
• For each group Gα, we choose a particular row index k = k(α) ∈ Gα in an arbitrary fashion. For every other row index i ∈ Gα, we set Mij = Mkj for all j ∈ [n].

By construction, the matrix M has at most s distinct rows, and hence rank at most s. Let

us now bound the Frobenius norm error in this rank s approximation. Fixing an arbitrary

group index α ∈ [s] and an arbitrary row in i ∈ Gα, we then have

n

n

(Mi∗j − Mij )2 ≤ |Mi∗j − Mij |.

j=1

j=1

By construction, we either have Mi∗j ≥ Mij for every j ∈ [n], or Mi∗j ≤ Mij for every j ∈ [n]. Thus, letting k ∈ Gα denote the chosen row, we are guaranteed that

n ∗

n

|Mij

− Mij|

≤

|ti − tk|

≤

, s

j=1

where we have used the fact the pair (ti, tk) must lie in an interval of length at most n/s. Putting together the pieces yields the claim.

5.2.2 Proof of lower bound
We now turn to the proof of the lower bound in Theorem 2. We split our analysis into two cases, depending on the magnitude of λn.
6To be clear, the precise value of the constant C is determined by δ, which has been ﬁxed as δ = 0.01.

21

√
Case 1: First suppose that λn ≤ 3n . In this case, we consider the matrix M ∗ : = 21 11T in which all items are equally good, so any comparison is simply a fair coin ﬂip. Let the observation matrix Y ∈ {0, 1}n×n be arbitrary. By deﬁnition of the singular value thresholding operation,
we have |||Y − Tλn(Y )|||op ≤ λn, and hence the SVT estimator Mλn = Tλn(Y ) has Frobenius norm at most

2

2 n2

|||Y − Mλn|||F ≤ nλn ≤

. 9

Since M ∗ ∈ { 21 }n×n and Y ∈ {0, 1}n×n, we are guaranteed that |||M ∗ − Y |||F = n2 . Applying the triangle inequality yields the lower bound

|||Mλn − M ∗|||F ≥ |||M ∗ − Y |||F − |||Mλn − Y |||F ≥ n2 − n3 = n6 .

Case 2: entries

√
Otherwise, we may assume that λn > 3n . Consider the matrix M ∗ ∈ Rn×n with

 1 if i > j



[M ∗]ij =

1 2

if i = j

(30)

 0 if i < j.

By construction, the matrix M ∗ corresponds to the degenerate case of noiseless comparisons. Consider the matrix Y ∈ Rn×n generated according to the observation model (1). (To be
clear, all of its oﬀ-diagonal entries are deterministic, whereas the diagonal is population with i.i.d. Bernoulli variates.) Our proof requires the following auxiliary result regarding the singular values of Y :

Lemma 5. The singular values of the observation matrix Y ∈ Rn×n generated by the noiseless comparison matrix M ∗ satisfy the bounds

n

1

n

1

4π(i + 1) − 2 ≤ σn−i−1(Y ) ≤ π(i − 1) + 2

for all integers i ∈ [1, n6 − 1].

We prove this lemma at the end of this section.√

√

Taking it as given, we get that σn−i−1(Y ) ≤

3n for every integer i ≥ 2

n,

and

σn−i(Y

)

≥

n 50i

for every integer i ∈ [1, 2n5 ]. It follows that

n

√ n

n2

(σi(Y ))21{σi(Y ) ≤ } ≥

n

25 1

3

≥ cn 2 ,

3

2500 √ i2

i=1

i=2 n

√
for some universal constant c > 0. Recalling that λn ≥ 3n , we have the lower bound |||Y − Mλn|||2F ≥ cn 32 . Furthermore, since the observations (apart from the diagonal entries) are noiseless, we have |||Y − M ∗|||2F ≤ n4 . Putting the pieces together yields the lower bound
√ |||Mλn − M ∗|||F ≥ |||Mλn − Y |||F − |||M ∗ − Y |||F ≥ cn 34 − 2n ≥ c n 43 ,

where the ﬁnal step holds when n is large enough (i.e., larger than a universal constant).

22

Proof of Lemma 5: Instead of working with the original observation matrix Y , it is convenient to work with a transformed version. Deﬁne the matrix Y¯ : = Y − diag(Y ) + In, so that the matrix Y¯ is identical to Y except that all its diagonal entries are set to 1. Using this
intermediate object, deﬁne the (n × n) matrix

Y : = (Y¯ (Y¯ )T )−1 − eneTn ,

(31)

where en denotes the nth standard basis vector. One can verify that this matrix has entries


1   2 [Y ]ij = −1   0

if i = j = 1 or i = j = n if 1 < i = j < n if i = j + 1 or i = j − 1 otherwise.

Consequently, it is equal to the graph Laplacian7 of an undirected chain graph on n nodes.

Consequently, from standard results in spectral graph theory [BH11], the eigenvalues of Y are

given

by

{

4

sin2

(

πi n

)

}ni=−01

.

Recall

the

elementary

sandwich

relationship

x 2

≤

sin x

≤

x,

valid

for

every x ∈ [0, π6 ]. Using this fact, we are guaranteed that

πn22i2 ≤ λi+1(Y ) ≤ 4πn22i2 for all integers i ∈ [1, n6 ]. (32)

We now use this intermediate result to establish the claimed bounds on the singular values of Y . Observe that the matrices Y and (Y¯ (Y¯ )T )−1 diﬀer only by the rank one matrix eneTn . Standard results in matrix perturbation theory [Tho76] guarantee that a rank-one perturba-
tion can shift the position (in the large-to-small ordering) of any eigenvalue by at most one. Consequently, the eigenvalues of the matrix (Y¯ (Y¯ )T )−1 must be sandwiched as

π2(in−2 1)2 ≤ λi+1((Y¯ (Y¯ )T )−1) ≤ 4π2(ni 2+ 1)2 for all integers i ∈ [1, n6 − 1].

It follows that the singular values of Y¯ are sandwiched as

n ≤ σn−i−1(Y¯ ) ≤ n

4π(i + 1)

π(i − 1)

for all integers i ∈ [1, n6 − 1].

Observe that Y¯ − Y is a {0, 21 }-valued diagonal matrix, and hence |||Y¯ − Y |||op ≤ 12 . Consequently, we have maxi=1,...,n |σi(Y ) − σi(Y¯ )| ≤ 12 , from which it follows that

n

1

n

1

4π(i + 1) − 2 ≤ σn−i−1(Y ) ≤ π(i − 1) + 2

as claimed.

5.3 Proof of Theorem 3
We now prove our results on the high SNR subclass of CSST, in particular establishing a lower bound and then analyzing the two-stage estimator described in Section 3.3 so as to obtain the upper bound.
7In particular, the Laplacian of a graph is given by L = D − A, where A is the graph adjacency matrix, and D is the diagonal degree matrix.

23

5.3.1 Proof of lower bound
In order to prove the lower bound, we follow the proof of the lower bound of Theorem 1, with the only diﬀerence being that the vector q ∈ Rn−1 is restricted to lie in the interval [ 21 + γ, 1]n−1.

5.3.2 Proof of upper bound
Without loss of generality, assume that the true matrix M ∗ is associated to the identity permutation. Recall that the second step of our procedure involves performing constrained regression over the set CBISO(πFAS). The error in such an estimate is necessarily of two types: the usual estimation error induced by the noise in our samples, and in addition, some form of approximation error that is induced by the diﬀerence between πFAS and the correct identity permutation.
In order to formalize this notion, for any ﬁxed permutation π, consider the constrained least-squares estimator

Mπ ∈ arg min |||Y − M |||2F.
M ∈CBISO(π)

(33)

Our ﬁrst result provides an upper bound on the error matrix Mπ − M ∗ that involves both approximation and estimation error terms.
Lemma 6. There is a universal constant c0 > 0 such that error in the constrained LS estimate (33) satisﬁes the upper bound

|||Mπ − M ∗|||2F

∗

∗2

2

c0

≤ |||M − π(M )|||F + n log (n)

(34)

Approx. error Estimation error

with probability at least 1 − c1e−c2n.

There are two remaining challenges in the proof. Since the second step of our estimator
involves the FAS-minimizing permutation πFAS, we cannot simply apply Lemma 6 to it directly. (The permutation πFAS is random, whereas this lemma applies to any ﬁxed permutation). Consequently, we ﬁrst need to extend the bound (34) to one that is uniform over a set that includes
πFAS with high probability. Our second challenge is to upper bound the approximation error term |||M ∗ − πFAS(M ∗)|||2F that is induced by using the permutation πFAS instead of the correct identity permutation.
In order to address these challenges, for any constant c > 0, deﬁne the set

Π(c) : = {π | max |i − π(i)| ≤ c log n}.
i∈[n]
This set corresponds to permutations that are relatively close to the identity permutation in the sup-norm sense. Our second lemma shows that any permutation in Π(c) is “good enough” in the sense that the approximation error term in the upper bound (34) is well-controlled:
Lemma 7. For any M ∗ ∈ CBISO and any permutation π ∈ Π(c), we have
|||M ∗ − π(M ∗)|||2F ≤ 2c n log n, (35)
where c is a positive constant that may depend only on c.

24

Taking these two lemmas as given, let us now complete the proof of Theorem 3. (We return

to prove these lemmas at the end of this section.) Braverman and Mossel [BM08] showed that

for the class CHIGH(γ), there exists a positive constant c—depending on γ but independent of n—such that

c3

P πFAS ∈ Π(c) ≥ 1 − n2 .

(36)

From the deﬁnition of class Π(c), there is a positive constant c (whose value may depend only on c) such that its cardinality is upper bounded as

(i)
card(Π(c)) ≤ n2c log n ≤ e.5c2n,

where the inequality (i) is valid once the number of items n is larger than some universal

constant. Consequently, by combining the union bound with Lemma 6 we conclude that, with

probability

at

least

1

−

c1e−c2n

−

c3 n2

,

the

error

matrix

∆FAS

:=

MπFAS

−

M∗

satisﬁes

the

upper

bound (34). Combined with the approximation-theoretic guarantee from Lemma 7, we ﬁnd

that

|||∆FAS|||2F

∗

∗2

2

c0 ≤ |||M − πFAS(M )|||F + n log (n)

≤ c n log n + +n log2(n),

from which the claim follows.

It remains to prove the two auxiliary lemmas, and we do so in the following subsections.

Proof of Lemma 6: The proof of this lemma involves a slight generalization of the proof of
the upper bound in Theorem 1 (see Section 5.1.1 for this proof). From the optimality of Mπ and feasibility of π(M ∗) for the constrained least-squares program (33), we are guaranteed that |||Y − Mπ|||2F ≤ |||Y − π(M ∗)|||2F. Introducing the error matrix ∆π : = Mπ − M ∗, some algebraic manipulations yield the modiﬁed basic inequality

|||∆π|||2F ≤ |||M ∗ − π(M ∗)|||2F + 2 W, Mπ − π(M ∗) .

Let us deﬁne ∆ : = Mπ − π(M ∗). Further, for each choice of radius t > 0, recall the deﬁnitions of the random variable Z(t) and event At from equations (22) and (25), respectively. With these deﬁnitions, we have the upper bound

|||∆π|||2F ≤ |||M ∗ − π(M ∗)|||2F + 2Z |||∆|||F .

(37)

δ2

√

Lemma 2 proved earlier shows that the inequality E[Z(δn)] ≤

n
2

is satisﬁed by δn = c

n log n.

In a manner identical to the proof in Section 5.1.1, one can show that

P[At] ≤ P[Z(δn) ≥ 2δn tδn ≤ 2e−c1tδn for all t ≥ δn.

Given these results, we b√reak the next step into two cases depending on the magnitude of ∆. Case I: Suppose |||∆|||F ≤ tδn. In this case, we have
|||∆π|||2F ≤ 2|||M ∗ − π(M ∗)|||2F + 2|||∆|||2F ≤ 2|||M ∗ − π(M ∗)|||2F + tδn.

25

√ Case II: Otherwise, we must have |||∆|||F > tδn. Conditioning on the complement Act , our basic inequality (37) implies that

|||∆π|||2F ≤ |||M ∗ − π(M ∗)|||2F + 4|||∆|||F tδn

∗

∗ 2 |||∆|||2F

≤ |||M − π(M )|||F + 8 + 32tδn,

∗

∗ 2 2|||∆π|||2F + 2|||M ∗ − π(M ∗)|||2F

≤ |||M − π(M )|||F +

8

+ 32tδn,

with probability at least 1 − 2√e−c1tδn. Finally, setting t = δn = c n log(n) in either case and re-arranging yields the bound (34).

Proof of Lemma 7: For any matrix M and any value i, let Mi denote its ith row. Also

deﬁne the clipping function b : Z → [n] via b(x) = min{max{1, x}, n}. Using this notation, we

have

n
|||M ∗ − π(M ∗)|||2F =

Mi∗ − Mπ∗−1(i)

2 2

i=1

n

≤

max { Mi∗ − Mb∗(i−j) 22, Mi∗ − Mb∗(i+j) 22},

0≤j≤c log n

i=1

where we have used the deﬁnition of the set Π(c) to obtain the ﬁnal inequality. Since M ∗ corresponds to the identity permutation, we have M1∗ ≥ M2∗ ≥ · · · ≥ Mn∗, where the inequalities are in the pointwise sense. Consequently, we have

n
|||M ∗ − π(M ∗)|||2F ≤ max
i=1

Mi∗ − Mb∗(i−c log n)

22,

Mi∗ − Mb∗(i+c log n)

2 2

n−c log n

≤2

Mi∗ − Mi∗+c log n 22.

i=1

One can verify that the inequality ki=−11(ai − ai+1)2 ≤ (a1 − ak)2 holds for all ordered sequences of real numbers a1 ≥ a2 ≥ · · · ≥ ak. As stated earlier, the rows of M ∗ dominate each other pointwise, and hence we conclude that

|||M ∗ − π(M ∗)|||2F ≤ 2c log n

M1∗ − Mn∗

2 2

≤

2cn log n,

which establishes the claim (35).

5.4 Proof of Theorem 4
We now turn to our theorem giving upper and lower bounds on estimating pairwise probability matrices for parametric models. Let us begin with a proof of the claimed lower bound.

5.4.1 Lower bound

We prove our lower bound by constructing a set of matrices that are well-separated in Frobenius

norm. Using this set, we then use an argument based on Fano’s inequality to lower bound the

minimax risk. Underlying our construction of the matrix collection is a collection of Boolean

vectors. For any two Boolean vectors b, b ∈ {0, 1}n, let dH(b, b ) =

n j=1

1[bj

=

bj ]

denote

the

Hamming distance between them.

26

Lemma 8. For any ﬁxed α ∈ (0, 1/4), there is a collection of Boolean vectors {b1, . . . , bT } such that

min dH(bj, bk), dH(bj, 0) ≥ αn

for all distinct j = k ∈ {1, . . . , T }, and

1 T ≡ T (α) ≥ exp (n − 1) DKL(2α 2 ) − 1.

(38a) (38b)

Given the collection {bj, j ∈ [T (α)]} guaranteed by this lemma, we then deﬁne the collection of real vectors {wj, j ∈ [T (α)]} via

wj = δ I − 1 11T bj n

for each j ∈ [T (α)],

where δ ∈ (0, 1) is a parameter to be speciﬁed later in the proof. By construction, for each
index j ∈ [T (α)], we have 1, wj = 0 and wj ∞ ≤ δ. Based on these vectors, we then deﬁne the collection of matrices M j, j ∈ [T (α)] via

[M k]ij : = F ([wk]i − [wk]j).

By construction, this collection of matrices is contained within our parametric family. We also claim that they are well-separated in Frobenius norm:

Lemma 9. For any distinct pair j, k ∈ [T (α)], we have

|||M j − M k|||2F α2

2

n2

≥ (F (δ) − F (0)) . 4

(39)

In order to apply Fano’s inequality, our second requirement is an upper bound on the
mutual information I(Y ; J), where J is a random index uniformly distributed over the index set [T ] = {1, . . . , T }. By Jensen’s inequality, we have I(Y ; J) ≤ (T1) j=k DKL(Pj Pk), where
2
Pj denotes the distribution of Y when the true underlying matrix is M j. Let us upper bound these KL divergences.
For any pair of distinct indices u, v ∈ [n]2, let xuv be a diﬀerencing vector—that is, a vector whose components u and v are set as 1 and −1, respectively, with all remaining components
equal to 0. We are then guaranteed that

xuv, wj = δ xuv, bj , and F ( xuv, wj ) ∈ F (−δ), F (0), F (δ) ,

where F (δ) ≥ F (0) ≥ F (−δ) by construction. Using these facts, we have

(i) jk

F ( xuv, wj ) − F ( xuv, wk ) 2

DKL(P P ) ≤ 2

min{F ( xuv, wk ), 1 − F ( xuv, wk )}

u,v∈[n]

≤ 2n2 (F (δ) − F (−δ))2 F (−δ)

≤ 8n2 (F (δ) − F (0))2 , (40) F (−δ)

where the bound (i) follows from the elementary inequality a log ab ≤ (a − b) ab for any two numbers a, b ∈ (0, 1).

27

This upper bound on the KL divergence (40) and lower bound on the Frobenius norm (39), when combined with Fano’s inequality, imply that any estimator M has its worst-case risk over our family lower bounded as

1

j 2 12

2 F (8−δ) n2(F (δ) − F (0))2 + log 2

j∈s[Tu(pα)] n2 E |||M − M (w )|||F ≥ 8 α (F (δ) − F (0)) 1 − n .

Choosing a value of δ > 0 such that (F (δ) − F (0))2 = F8(0−nδ) gives the claimed result. (Such a value of δ is guaranteed to exist with F (−δ) ∈ [ 41 , 12 ] given our assumption that F is continuous and strictly increasing.)

The only remaining details are to prove Lemmas 8 and 9.

Proof of Lemma 8: The Gilbert-Varshamov bound [Gil52, Var57] guarantees the existence of a collection of vectors {b0, . . . , bT¯−1} contained with the Boolean hypercube {0, 1}n such that

T¯ ≥ 2n−1 dH(bj, bk) ≥ αn

αn −1
n − 1 −1, and
=0
for all j = k, j, k ∈ [T¯ − 1].

Moreover, their construction allows loss of generality that the all-zeros vector is a member of the set—say b0 = 0. We are thus guaranteed that dH(bj, 0) ≥ αn for all j ∈ {1, . . . , T¯ − 1}.
Since n ≥ 2 and α ∈ (0, 14 ), we have αnn−−1 1 ≤ 2α ≤ 12 . Applying standard bounds on the tail of the binomial distribution yields

1 2n−1

αn −1 =0

n−1

≤ exp

αn − 1 1 − (n − 1)DKL( n − 1 2 )

≤ exp

1 − (n − 1)DKL(2α 2 ) .

Consequently, the number of non-zero code words T : = T¯ − 1 is at least

1 T (α) : = exp (n − 1)DKL(2α 2 ) − 1.

Thus, the collection {b1, . . . , bT } has the desired properties.

Proof of Lemma 9: By deﬁnition of the matrix ensemble, we have

|||M (wj) − M (wk)|||2F =

(F ( xuv, wj ) − F ( xuv, wk ))2.

(41)

u,v∈[n]

By construction, the Hamming distances between the triplet of vectors {wj, wk, 0} are lower bounded dH(wj, 0) ≥ αn, dH(wk, 0) ≥ αn and dH(wj, wk) ≥ αn. We claim that this implies that

card u = v ∈ [n]2 | xuv, wj = xuv, wk ≥ α2 n2. (42) 4
Taking this auxiliary claim as given for the moment, applying it to Equation (41) yields the lower bound |||M (w1) − M (w2)|||2F ≥ 41 α2n2(F (δ) − F (0))2, as claimed.

28

It remains to prove the auxiliary claim (42). We relabel j = 1 and k = 2 for simplicity in
notation. For (y, z) ∈ {0, 1} × {0, 1}, let set Iyz ⊆ [n] denote the set of indices on which w1 takes value y and w2 takes value z. We then split the proof into two cases:

Case 1: Suppose | I00 ∪ I11 |≥ α2n . The minimum distance condition dH(w1, w2) ≥ αn im-
plies that | I01 ∪ I10 |≥ αn. For any i ∈ I00 ∪ I11 and any j ∈ I01 ∪ I10, it must be that xuv, w1 = xuv, w2 . Thus there are at least α22 n2 such pairs of indices.

Case 2: Otherwise, we may assume that | I00 ∪ I11 |< α2n . This condition, along with the

minimum

Hamming

weight

conditions

dH(w1, 0)

≥

αn

and

dH(w2, 0)

≥

αn,

gives

I10

≥

αn 2

and

I01 ≥ α2n . For any i ∈ I01 and any j ∈ I10, it must be that xuv, w1 = xuv, w2 . Thus there

are at least α42 n2 such pairs of indices.

5.4.2 Upper bound

In our earlier work [SBB+16, Theorem 2b] we prove that when F is strongly log-concave and twice diﬀerentiable, then there is a universal constant cu such that the maximum likelihood estimator wML has mean squared error at most

sup

E[ wML − w∗ 22] ≤ cu.

w∗∈[−1,1]n, w∗, 1 =0

(43)

Moreover, given the log-concavity assumption, the MLE is computable in polynomial-time. Let M (wML) and M (w∗) denote the pairwise comparison matrices induced, via Equation (4), by wML and w∗. It suﬃces to bound the Frobenius norm |||M (wML) − M (w∗)|||F.
Consider any pair of vectors w1 and w2 that lie in the hypercube [−1, 1]n. For any pair of indices (i, j) ∈ [n]2, we have

((M (w1))ij − (M (w2))ij)2 = (F (wi1 − wj1) − F (wi2 − wj2))2 ≤ ζ2((wi1 − wj1) − (wi2 − wj2))2,

where we have deﬁned ζ : = max F (z). Putting together the pieces yields
z∈[−1,1]

|||M (w1) − M (w2)|||2F ≤ ζ2(w1 − w2)T (nI − 11T )(w1 − w2) = nζ2 w1 − w2 22. (44)
Applying this bound with w1 = wML and w2 = w∗ and combining with the bound (43) yields the claim.

5.5 Proof of Theorem 5
We now turn to the proof of Theorem 5, which characterizes the behavior of diﬀerent estimators for the partially observed case.

5.5.1 Proof of part (a) In this section, we prove the lower and upper bounds stated in part (a).

Proof of lower bound: We begin by proving the lower bound in equation (17a). The Gilbert-

Varshamov bound [Gil52, Var57] guarantees the existence of a set of vectors {b1, . . . , bT } in the

Boolean

cube

n
{0, 1} 2

with

cardinality

at

least

T

: = 2cn

such

that

dH(bj, bk) ≥ 0.1n for all distinct pairs j, k ∈ [T ] : = {1, . . . , T }.

29

Fixing some δ ∈ (0, 14 ) whose value is to be speciﬁed later, for each k ∈ [T ], we deﬁne a matrix M k ∈ CSST with entries

[M k]uv =

21 + δ
1 2

if

u

≤

n 2

,

[

bk

]

u

=

1

and

v

≥

n 2

otherwise,

for every pair of indices u ≤ v. We complete the matrix by setting [M k]vu = 1 − [M k]uv for all indices u > v.
By construction, for each distinct pair j, k ∈ [T ], we have the lower bound

|||M j − M k|||2F = nδ2

bj − bk

2 2

≥

c0n2δ2.

Let Pj

and

j
Puv

denote (respectively) the distributions of the matrix Y

and entry Yuv

when

the underlying matrix is M j. Since the entries of Y are generated independently, we have

DKL(Pj Pk) =

DKL(Pjuv Pkuv). The matrix entry Yuv is generated according to the

1≤u<v≤n

model

 1  Yuv = 0
 not observed

w.p. pobsMu∗v w.p. pobs(1 − Mu∗v)
w.p. 1 − pobs.

Consequently, the KL divergence can be upper bounded as

DKL(Pjuv Pkuv)

j

Mujv

j

(1 − Mujv)

= pobs Muv log M k + (1 − Muv) log (1 − M k )

uv

uv

j Mujv − Mukv

≤pobs Muv

Mk

uv

j Mukv − Mujv + (1 − Muv) 1 − M k
uv

(Mujv − Mukv)2

= pobs M k (1 − M k )

uv

uv

≤16pobs (Mujv − Mukv)2,

(45a) (45b) (45c)

where inequality (45a) follows from the fact that log(t) ≤ t−1 for all t > 0; and inequality (45c)

follows

since

the

numbers

{

M

j uv

,

Mukv

}

both

lie

in

the

interval

[ 41 ,

34 ].

Putting

together

the

pieces,

we conclude that

DKL(Pj Pk) ≤ c1pobs|||M j − M k|||2F ≤ c1pobsn2δ2.

Thus, applying Fano’s inequality to the packing set {M 1, . . . , M T } yields that any estimator M has mean squared error lower bounded by

1

k2

2

c1pobsn2δ2 + log 2

ks∈u[Tp] n2 E[|||M − M |||F] ≥ c0δ 1 − cn .

Finally, choosing δ2 = 2c1pc2obsn yields the lower bound supk∈[T ] n12 E[|||M −M k|||2F] ≥ c3 np1obs . Note that in order to satisfy the condition δ ≤ 41 , we must have pobs ≥ 21c61cn2 .

30

Proof of upper bound: For this proof, recall the linearized form of the observation model given in equations (16a), (18a), and (18b). We begin by introducing some additional notation. Letting Π denote the set of all permutations of n items. For each π ∈ Π, we deﬁne the set
π(CBISO) : = M ∈ [0, 1]n×n | Mk ≥ Mij whenever π(k) ≤ π(i) and π( ) ≥ π(j) ,

corresponding to the subset of SST matrices that are faithful to the permutation π. We then deﬁne the estimator Mπ ∈ arg min |||Y − M |||2F, in terms of which the least squares estima-
M ∈π(CBISO)
tor (16b) can be rewritten as
M ∈ arg min |||Y − Mπ|||2F.
π∈Π
Deﬁne a set of permutations Π ⊆ Π as
Π : = {π ∈ Π | |||Y − Mπ|||2F ≤ |||Y − M ∗|||2F}.

Note that the set Π is guaranteed to be non-empty since the permutation corresponding to M always lies in Π . We claim that for any π ∈ Π , we have

P |||Mπ − M ∗|||2 ≤ cu n log2 n ≥ 1 − e−3n log n,

(46)

F

pobs

for some positive universal constant cu. Given this bound, since there are at most en log n permutations in the set Π , a union bound over all these permutations applied to (46) yields

P max |||Mπ − M ∗|||2 > cu n log2 n ≤ e−2n log n.

π∈Π

F

pobs

Since M is equal to Mπ for some π ∈ Π , this tail bound yields the claimed result. The remainder of our proof is devoted to proving the bound (46). By deﬁnition, any
permutation π ∈ Π must satisfy the inequality

|||Y − Mπ|||2F ≤ |||Y − M ∗|||2F.

Letting ∆π : = Mπ − M ∗ denote the error matrix, and using the linearized form (18a) of the observation model, some algebraic manipulations yield the basic inequality

1 |||∆π|||2 ≤ 1 W , ∆π .

(47)

2

F pobs

Now consider the set of matrices

CDIFF(π) : = α(M − M ∗) | M ∈ π(CBISO), α ∈ [0, 1] ,

(48)

and note that CDIFF(π) ⊆ [−1, 1]n×n. (To be clear, the set CDIFF(π) also depends on the value of M ∗, but considering M ∗ as ﬁxed, we omit this dependence from the notation for brevity.) For
each choice of radius t > 0, deﬁne the random variable

1 Zπ(t) : = D∈CsDuIFpF(π), pobs D, W .
|||D|||F≤t

(49)

31

Using the basic inequality (47), the Frobenius norm error |||∆π|||F then satisﬁes the bound

1 |||∆π|||2 ≤ 1 W , ∆π ≤ Zπ |||∆π||| .

(50)

2

F pobs

F

Thus, in order to obtain a high probability bound, we need to understand the behavior of the random quantity Zπ(t).
One can verify that the set CDIFF(π) is star-shaped, meaning that αD ∈ CDIFF(π) for every α ∈ [0, 1] and every D ∈ CDIFF(π). Using this star-shaped property, we are guaranteed that there is a non-empty set of scalars δn > 0 satisfying the critical inequality

E[Zπ(δn)] ≤ δn2 . (51) 2

Our interest is in an upper bound to the smallest (strictly) positive solution δn to the cri√tical inequality (51), and moreover, our goal is to show that for every t ≥ δn, we have |||∆|||F ≤ c tδn with high probability.
For each t > 0, deﬁne the “bad” event

1 At = ∃∆ ∈ CDIFF(π) | |||∆|||F ≥ tδn and pobs ∆, W ≥ 2|||∆|||F tδn . (52)

Using the star-shaped property of CDIFF(π), it follows by a rescaling argument that

P[At] ≤ P[Zπ(δn) ≥ 2δn tδn] for all t ≥ δn.

The following lemma helps control the behavior of the random variable Zπ(δn).

Lemma 10. For any δ > 0, the mean of Zπ(δ) is bounded as E[Zπ(δ)] ≤ cu n log2 n, pobs

and for every u > 0, its tail probability is bounded as

−cu2pobs P Zπ(δ) > E[Zπ(δ)] + u ≤ exp δ2 + E[Zπ(δ)] + u ,

where cu and c are positive universal constants.

From this lemma, we have the tail bound

P Zπ(δn) > E[Zπ(δn)] + δn

√

−c(δn tδn)2pobs

tδn

≤ exp

√, δ2 + E[Zπ(δn)] + (δn tδn)

n

for all t ≥ δn.

√ By the deﬁnition of δn in equation (51), we have E[Z(δn)] ≤ δn2 ≤ δn tδn for any t ≥ δn, and

consequently

√ −c(δn tδn)2pobs

P[At] ≤ P[Z(δn) ≥ 2δn tδn ≤ exp

√

, for all t ≥ δn.

3δn tδn

√

√

Consequently, either |||∆π|||F ≤ tδn, or we have |||∆π|||F > tδn. In the latter ca√se, conditioning

on

the

complement √

Act ,

our

basic

inequality

implies

that

12 |||∆π|||2F

≤

2|||∆π |||F

tδn and hence

|||∆π|||F ≤ 4 tδn. Putting together the pieces yields that

P |||∆π|||F ≤ 4 tδn ≥ 1 − exp − c δn tδnpobs , for all t ≥ δn.

(53)

32

Finally, from the bound on the expected value of Zπ(t) in Lemma 10, we see that the critical inequality (51) is satisﬁed for δn = pcoubns log n. Setting t = δn = pcoubns log n in (53) yields

P |||∆π||| ≤ 4 cun log2 n ≥ 1 − exp − 3n log n ,

(54)

F

pobs

for some universal constant cu > 0, thus proving the bound (46).

It remains to prove Lemma 10.

Proof of Lemma 10 Bounding E[Zπ(δ)]: We establish an upper bound on E[Zπ(δ)] by

using Dudley’s entropy integral, as well as some auxiliary results on metric entropy. We use the

notation log N ( , C, ρ) to denote the metric entropy of the class C in the metric ρ. Introducing

the random variable Zπ : = sup

D, W

, note that we have E[Zπ(δ)] ≤

1 p

E[Zπ ].

The

D∈CDIFF (π )

obs

truncated form of Dudley’s entropy integral inequality yields

E[Zπ] ≤ c

n−8 +

2n 12 n−9

log N ( , CDIFF(π), |||.|||F)d ,

(55)

where we have used the fact that the diameter of the set CDIFF(π) is at most 2n in the Frobenius norm.
From our earlier bound (29), we are guaranteed that for each > 0, the metric entropy is upper bounded as

n2

n2

log N , {αM | M ∈ CBISO, α ∈ [0, 1]}, ||| · |||F ≤ 8 2 log .

Consequently, we have

n2

n2

log N ( , CDIFF(π), |||.|||F) ≤ 16 2 log .

Substituting this bound on the metric entropy of CDIFF(π) and the inequality ≥ 12 n−9 into the Dudley bound (55) yields

E[Zπ] ≤ cn(log n)2.

The inequality E[Zπ(δ)] ≤ po1bs E[Zπ] then yields the claimed result.

Bounding the tail probability of Zπ(δ): In order to establish the claimed tail bound, we use a Bernstein-type bound on the supremum of empirical processes due to Klein and Rio [KR05, Theorem 1.1c], which we state in a simpliﬁed form here.

Lemma 11. Let X : = (X1, . . . , Xm) be any sequence of zero-mean, independent random variables, each taking values in [−1, 1]. Let V ⊂ [−1, 1]m be any measurable set of m-length vectors.
Then for any u > 0, the supremum X† = supv∈V X, v satisﬁes the upper tail bound

P X† > E[X†] + u ≤ exp 2 sup

−u2 E[ v, X 2] + 4E[X†] + 3u .

v∈V

33

We now invoke Lemma 11 with the choices V = CDIFF(π) ∩ B(δ), m = (n × n), X = W , and X† = pobsZπ(δ). The matrix W has zero-mean entries belonging to the interval [−1, +1], and are independent on and above the diagonal (with the entries below determined by the skewsymmetry condition). Then we have E[X†] ≤ pobsE[Zπ(δ)] and E[ D, W 2] ≤ 4pobs|||D|||2F ≤ 4pobsδ2 for every D ∈ V. With these assignments, and some algebraic manipulations, we obtain that for every u > 0,
−u2pobs P Zπ(δ) > E[Zπ(δ)] + u ≤ exp 8δ2 + 4E[Zπ(δ)] + 3u ,
as claimed.

5.5.2 Proof of part (b)
In order to prove the bound (17b), we analyze the SVT estimator Tλn(Y ) with the threshold λn = 3 ponbs . Naturally then, our analysis is similar to that of complete observations case from Section 5.2. Recall our formulation of the problem in terms of the observation matrix Y along with the noise matrix W from equations (16a), (18a) and (18b). The result of Lemma 3 continues to hold in this case of partial observations, translated to this setting. In particular, if λn ≥ p1o.0b1s |||W |||op, then
n
|||Tλn (Y ) − M ∗|||2F ≤ c1 min λ2n, σj2(M ∗) ,
j=1
where c1 > 0 is a universal constant. We now upper bound the operator norm of the noise matrix W . Deﬁne a (2n × 2n) matrix
0W W = (W )T 0 .
From equation (18b) and the construction above, we have that the matrix W is symmetric, with mutually independent entries above the diagonal that have a mean of zero and are bounded in absolute value by 1. Consequently, known result√s in random matrix theory (e.g., see [Tao12, Theorem 2.3.21]) yield the bound |||W |||op ≤ 2.01 2n with probability at least 1 − n−c2, for some universal constant c2 > 1. One can also verify that |||W |||op = |||W |||op, thereby yielding the bound
P |||W |||op > 2.01 2npobs ≤ n−c2 .

With our choice λn = 3 ponbs , the event {λn ≥ p1o.0b1s |||W |||op} holds with probability at least 1 − n−c2. Conditioned on this event, the approximation-theoretic result from Lemma 4 gives

1

∗2

sλ2n 1

n2 |||Tλn(Y ) − M |||F ≤ c

n2

+ s

with probability at least 1 − n−c2. Substituting λn = 3 √pobsn yields the claimed result.

ponbs in this bound and setting s =

34

5.5.3 Proof of part (c)

As in our of proof of the fully observed case from Section 5.4.2, we consider the two-stage estimator based on ﬁrst computing the MLE wML of w∗ from the observed data, and then constructing the matrix estimate M (wML) via Equation (4). Let us now upper bound the mean-squared error associated with this estimator.
Our observation model can be (re)described in the following way. Consider an Erd˝os-R´enyi graph on n vertices with each edge drawn independently with a probability pobs. For each edge in this graph, we obtain one observation of the pair of vertices at the end-points of that edge. Let L be the (random) Laplacian matrix of this graph, that is, L = D − A where D is an (n × n) diagonal matrix with [D]ii being the degree of item i in the graph (equivalently, the number of pairwise comparison observations that involve item i) and A is the (n × n) adjacency matrix of the graph. Let λ2(L) denote the second largest eigenvalue of L. From Theorem 2(b) of our paper [SBB+16] on estimating parametric models,8 for this graph, there is a universal constant c1 such that the maximum likelihood estimator wML has mean squared error upper bounded as

E[ w

− w∗ 2 | L] ≤ c1

n .

ML

2

λ2(L)

The estimator wML is computable in a time polynomial in n. Since pobs ≥ c0 (lognn)2 , known results on the eigenvalues of random graphs [Oli09, CR11,
KOVB14] imply that

1

P λ2(L) ≥ c2npobs ≥ 1 − n4

(56)

for a universal constant c2 (that may depend on c0). As shown earlier in Equation (44),

for

any

valid

score

vectors

w1,

w2,

we

have

|||M (w1) − M (w2)|||2F

≤

nζ 2

w1 − w2

2 2

where

ζ : = maxz∈[−1,1] F (z) is a constant independent of n and pobs. Putting these results together

and performing some simple algebraic manipulations leads to the upper bound

1

∗2

c3 ζ 2

n2 E |||M (wML) − M |||F

≤

,

npobs

which establishes the claim.

6 Discussion
In this paper, we analyzed a ﬂexible model for pairwise comparison data that includes various parametric models, including the BTL and Thurstone models, as special cases. We analyzed various estimators for this broader matrix family, ranging from optimal estimators to various polynomial-time estimators, including forms of singular value thresholding, as well as a multistage method based on a noisy sorting routine. We show that this SST model permits far more robust estimation as compared to popular parametric models, while surprisingly, incurring little penalty for this signiﬁcant generality.9 Our results thus present a strong motivation towards the use of such general stochastic transitivity based models.
8Note that the Laplacian matrix used in the statement of [SBB+16, Theorem 2(b)] is a scaled version of the matrix L introduced here, with each entry of L divided by the total number of observations.
9In Appendix D.1 we show that under weaker notions of stochastic transitivity, the pairwise-comparison probabilities are unestimable.

35

All of the results in this paper focused on estimation of the matrix of pairwise comparison probabilities in the Frobenius norm. Estimation of probabilities in other metrics, such as the KL divergence or estimation of the ranking in the Spearman’s footrule or Kemeny distance, follow as corollaries of our results (see Appendix A). Establishing the best possible rates for polynomial-time algorithms over the full class CSST is a challenging open problem.
We evaluated a computationally eﬃcient estimator based on thresholding the singular values of the observation matrix that is consistent, but achieves a suboptimal rate. In our analysis of this estimator, we have so far been conservative in our choice of the regularization parameter, in that it is a ﬁxed choice. Such a ﬁxed choice has been prescribed in various theoretical works on the soft or hard-thresholded singular values (see, for instance, the papers [Cha14, GD14]). In practice, the entries of the eﬀective noise matrix W have variances that depend on the unknown matrix, and the regularization parameter may be obtained via cross-validation. The eﬀect of allowing a data-dependent choice of the regularization parameter remains to be studied, although we suspect it may improve the minimax risk by a constant factor at best.
Finally, in some applications, choices can be systematically intransitive, for instance when objects have multiple features and diﬀerent features dominate diﬀerent pairwise comparisons. In these situations, the SST assumption may be weakened to one where the underlying pairwise comparison matrix is a mixture of a small number of SST matrices. The results of this work may form building blocks to address this general setting; we defer a detailed analysis to future work.
Acknowledgments: This work was partially supported by ONR-MURI grant DOD-002888, AFOSR grant FA9550-14-1-0016, NSF grant CIF-31712-23800, and ONR MURI grant N0001411-1-0688. The work of NBS was also supported in part by a Microsoft Research PhD fellowship.

References

[ACN08] [Alo06] [BH11] [BM08] [BT52] [BW97] [Cat12] [CGS15] [Cha14]

N. Ailon, M. Charikar, and A. Newman. Aggregating inconsistent information: ranking and clustering. Journal of the ACM (JACM), 55(5):23, 2008.
N. Alon. Ranking tournaments. SIAM Journal on Discrete Mathematics, 20(1):137– 142, 2006.
A. E. Brouwer and W. H. Haemers. Spectra of graphs. Springer, 2011.
M. Braverman and E. Mossel. Noisy sorting without resampling. In Proc. ACMSIAM symposium on Discrete algorithms, pages 268–276, 2008.
R. A. Bradley and M. E. Terry. Rank analysis of incomplete block designs: I. The method of paired comparisons. Biometrika, pages 324–345, 1952.
T. P. Ballinger and N. T. Wilcox. Decisions, error and heterogeneity. The Economic Journal, 107(443):1090–1105, 1997.
M. Cattelan. Models for paired comparison data: A review with emphasis on dependent data. Statistical Science, 27(3):412–433, 2012.
S. Chatterjee, A. Guntuboyina, and B. Sen. On matrix estimation under monotonicity constraints. arXiv:1506.03430, 2015.
S. Chatterjee. Matrix estimation by universal singular value thresholding. The Annals of Statistics, 43(1):177–214, 2014.

36

[CR11] [CS15] [DG77]
[Dia89] [DIS15] [DM59] [Fis73] [FJS13] [FV93] [GD14] [Gil52] [GW07] [HOX14] [KMS07] [KOVB14]
[KR05] [Led01] [Luc59] [Mar96] [ML65]

F. Chung and M. Radcliﬀe. On the spectra of general random graphs. The electronic journal of combinatorics, 18(1):P215, 2011.
Y. Chen and C. Suh. Spectral MLE: Top-k rank aggregation from pairwise comparisons. In International Conference on Machine Learning, 2015.
P. Diaconis and R. L. Graham. Spearman’s footrule as a measure of disarray. Journal of the Royal Statistical Society. Series B (Methodological), pages 262–268, 1977.
P. Diaconis. A generalization of spectral analysis with application to ranked data. The Annals of Statistics, 17(3):949–979, 1989.
W. Ding, P. Ishwar, and V. Saligrama. A topic modeling approach to ranking. International Conference on Artiﬁcial Intelligence and Statistics, 2015.
D. Davidson and J. Marschak. Experimental tests of a stochastic decision theory. Measurement: Deﬁnitions and theories, pages 233–69, 1959.
P. C. Fishburn. Binary choice probabilities: on the varieties of stochastic transitivity. Journal of Mathematical psychology, 10(4):327–352, 1973.
V. F. Farias, S. Jagabathula, and D. Shah. A nonparametric approach to modeling choice with limited data. Management Science, 59(2):305–322, 2013.
M. A. Fligner and J. S. Verducci. Probability models and statistical analyses for ranking data, volume 80. Springer, 1993.
M. Gavish and D. L. Donoho. The optimal hard threshold for singular values is. IEEE Transactions on Information Theory, 60(8):5040–5053, 2014.
E. N. Gilbert. A comparison of signalling alphabets. Bell System Technical Journal, 31(3):504–522, 1952.
F. Gao and J. A. Wellner. Entropy estimate for high-dimensional monotonic functions. Journal of Multivariate Analysis, 98(9):1751–1764, 2007.
B. Hajek, S. Oh, and J. Xu. Minimax-optimal inference from partial rankings. In Advances in Neural Information Processing Systems, pages 1475–1483, 2014.
C. Kenyon-Mathieu and W. Schudy. How to rank with few errors. In Symposium on Theory of computing (STOC), pages 95–103. ACM, 2007.
T. Kolokolnikov, B. Osting, and J. Von Brecht. Algebraic connectivity of Erd¨os-R´enyi graphs near the connectivity threshold. Available online http://www.mathstat.dal.ca/ tkolokol/papers/braxton-james.pdf, 2014.
T. Klein and E. Rio. Concentration around the mean for maxima of empirical processes. The Annals of Probability, 33(3):1060–1077, 2005.
M. Ledoux. The Concentration of Measure Phenomenon. Mathematical Surveys and Monographs. American Mathematical Society, Providence, RI, 2001.
R. D. Luce. Individual choice behavior: A theoretical analysis. New York: Wiley, 1959.
J. I. Marden. Analyzing and modeling rank data. CRC Press, 1996.
D. H. McLaughlin and R. D. Luce. Stochastic transitivity and cancellation of preferences between bitter-sweet solutions. Psychonomic Science, 2(1-12):89–90, 1965.

37

[NOS12]

S. Negahban, S. Oh, and D. Shah. Iterative ranking from pair-wise comparisons. In Advances in Neural Information Processing Systems, pages 2474–2482, 2012.

[Oli09]

R. I. Oliveira. Concentration of the adjacency matrix and of the Laplacian in random graphs with independent edges. arXiv preprint:0911.0600, 2009.

[RA14]

A. Rajkumar and S. Agarwal. A statistical convergence perspective of algorithms for rank aggregation from pairwise data. In International Conference on Machine Learning, pages 118–126, 2014.

[Sam00]

P.-M. Samson. Concentration of measure inequalities for Markov chains and φmixing processes. Annals of Probability, pages 416–461, 2000.

[SBB+16]

N. B. Shah, S. Balakrishnan, J. Bradley, A. Parekh, K. Ramchandran, and M. J. Wainwright. Estimation from pairwise comparisons: Sharp minimax bounds with topology dependence. Journal of Machine Learning Research, 17(58):1–47, 2016.

[SBW16]

N. B. Shah, S. Balakrishnan, and M. J. Wainwright. Feeling the Bern: Adaptive estimators for Bernoulli probabilities of pairwise comparisons. arXiv preprint arXiv:1603.06881, 2016.

[SS11]

M. J. Silvapulle and P. K. Sen. Constrained statistical inference: Order, inequality, and shape constraints, volume 912. John Wiley & Sons, 2011.

[Tao12]

T. Tao. Topics in random matrix theory, volume 132. American Mathematical Society Providence, RI, 2012.

[Tho76]

R. Thompson. The behavior of eigenvalues and singular values under perturbations of restricted rank. Linear Algebra and its Applications, 13(1):69–78, 1976.

[Thu27]

L. L. Thurstone. A law of comparative judgment. Psychological Review, 34(4):273, 1927.

[Tve72]

A. Tversky. Elimination by aspects: A theory of choice. Psychological review, 79(4):281, 1972.

[Var57]

R. Varshamov. Estimate of the number of signals in error correcting codes. In Dokl. Akad. Nauk SSSR, volume 117, pages 739–741, 1957.

[VDVW96] A. Van Der Vaart and J. Wellner. Weak convergence. In Weak Convergence and Empirical Processes, pages 16–28. Springer, 1996.

[WJJ13]

F. L. Wauthier, M. I. Jordan, and N. Jojic. Eﬃcient ranking from pairwise comparisons. In Proceedings of the 30th International Conference on Machine Learning (ICML), 2013.

APPENDICES

A Relation to other error metrics
In this section, we show how estimation of the pairwise-comparison-probability matrix M ∗ under the squared Frobenius norm implies estimates and bounds under other error metrics. In particular, we investigate relations between estimation of the true underlying ordering under the Spearman’s footrule and the Kemeny metrics, and estimation of the matrix M ∗ under the Kullback-Leibler divergence metric.

38

A.1 Recovering the true ordering
Recall that the SST class assumes the existence of some true ordering of the n items. The pairwise-comparison probabilities are then assumed to be faithful to this ordering. In this section, we investigate the problem of estimating this underlying ordering.
In order to simplify notation, we assume without loss of generality that this true underlying ordering is the identity permutation of the n items, and denote the identity permutation as πid. Recall the set CBISO of bivariate isotonic matrices, that is, SST matrices that are faithful to the identity permutation:
CBISO = {M ∈ [0, 1]n×n | Mij = 1 − Mji for all (i, j) ∈ [n]2, and Mi ≥ Mj whenever i < j.}
Then we have that M ∗ ∈ C . BISO Let π be any permutation of the n items. For any matrix M ∈ Rn×n and any integer i ∈ [n] we let Mi denote the ith row of M .
Two of the most popular metrics of measuring the error between two such orderings are the Spearman’s footrule and the Kemeny (or Kendall tau) distance, deﬁned as follows. Spearman’s footrule measures the total displacement of all items in π as compared to πid, namely
n
Spearman’s footrule(π, πid) : = | π(i) − i | .
i=1
On the other hand, the Kemeny distance equals the total number of pairs whose relative positions are diﬀerent in the two orderings, namely,

Kemeny(π, πid) : =

1{sign(π(i) − π(j)) = sign(i − j)},

1≤i<j≤n

where “sign” denotes the sign function, that is, sign(x) = 1 if x > 0, sign(x) = −1 if x < 0 and sign(x) = 0 if x = 0. The Kemeny distance is also known as the Kendall tau metric.
Before investigating the two aforementioned metrics, we remark on one important aspect of the problem of estimating the order of the items. Observe that if the rows of M ∗ corresponding to some pair of items (i, j) are very close to each other (say, in a pointwise sense), then it is hard to estimate the relative position of item i with respect to item j. On the other hand, if the two rows are far apart then diﬀerentiating between the two items is easier. Consequently, it is reasonable to consider a metric that penalizes errors in the inferred permutation based on the relative values of the rows of M ∗. To this end, we deﬁne a reweighted version of Spearman’s footrule as
n
Matrix-reweighted Spearman’s footruleM∗(π, πid) : = |||π(M ∗) − M ∗|||2F = |||Mπ∗(i) − Mi∗|||22 .
i=1
Given these deﬁnitions, the following proposition now relates the squared Frobenius norm metric to the other aforementioned metrics.
Proposition 2.A. Any two matrices M ∗ ∈ C , BISO and M ∈ CSST with π as its underlying permutation, must satisfy the following bound on the matrix-reweighted Spearman’s footrule:
|||M ∗ − π(M ∗)|||2F ≤ 4|||M ∗ − M |||2F.

39

Proposition 2.B. Consider any matrix M ∗ ∈ CBISO that satisﬁes |||Mi∗ − Mi∗+1|||22 ≥ γ2 for some constant γ > 0 and for every i ∈ [n − 1]. Then for any permutation π, the Spearman’s footrule
distance from the identity permutation is upper bounded as

n

1∗

∗2

| i − π(i) |≤ γ2 |||M − π(M )|||F.

i=1

Conversely, there exists a matrix M ∗ ∈ CBISO that satisﬁes |||Mi∗ − Mi∗+1|||22 = γ2 for every i ∈ [n − 1] such that for every permutation π, the Spearman’s footrule distance from the identity
permutation is lower bounded as

n

1

∗

∗2

| i − π(i) |≥ 4γ2 |||M − π(M )|||F.

i=1

Proposition 2.C ([DG77]). The Kemeny distance of any permutation π from the identity permutation πid is sandwiched as

1n

n

| i − π(i) |≤

1{sign(π(i) − π(j)) = sign(i − j)} ≤ | i − π(i) | .

2 i=1 1≤i<j≤n i=1

As a consequence of this proposition, an upper bound on the error in estimation of M ∗ under the squared Frobenius norm yields identical upper bounds (with some constant factors) under the other three metrics. A few remarks are in order:

(a) Treating M ∗ as the true pairwise comparison probability matrix and M as its estimate, Proposition 2.A assumes that M also lies in the matrix class CSST. This set-up is known as proper learning in some of the machine learning literature.

(b) The γ-separation condition of Proposition 2.B is satisﬁed in the models assumed in several earlier works [BM08, WJJ13].

The remainder of this subsection is devoted to the proof of these claims.

A.1.1 Proof of Proposition 2.A
For any matrix M and any permutation π of n items, let π(M ) denote the matrix resulting from permuting the rows of M by π. With this notation, we have
|||π(M ∗) − M ∗|||2F ≤ 2|||π(M ∗) − M |||2F + 2|||M − M ∗|||2F = 2|||M ∗ − π−1(M )|||2F + 2|||M − M ∗|||2F.
We now show that
|||M ∗ − π−1(M )|||2F ≤ |||M ∗ − M |||2F, (57)
which would then imply the claimed result. As shown below, the inequality (57) is a consequence of the fact that M ∗ and π−1(M ) both lie in the SST class and have the same underlying ordering of the rows. More generally, we claim that for any two matrices M ∈ CBISO and M ∈ C , BISO
πid ∈ arg min |||M − π(M )|||2F, (58)
π

40

where the minimization is carried out over all permutations of n items. To see this, consider any two matrices M and M in CBISO and let π be a minimizer of |||M − π(M )|||2F. If π = πid, then there must exist some item i ∈ [n − 1] such that item (i + 1) is ranked higher than item i
in π . Consequently,

|||Mi − Mi+1|||22 + |||Mi+1 − Mi |||22 − |||Mi − Mi |||22 − |||Mi+1 − Mi+1|||22 = 2 Mi − Mi+1, Mi − Mi+1

≥ 0,

where the ﬁnal inequality follows from the fact that M ∈ CBISO and M ∈ C . BISO It follows that
the new permutation obtained by swapping the positions of items i and (i + 1) in π (which now ranks item i higher than item (i + 1)) is also a minimizer of |||M − π(M )|||2F. A recursive application of this argument yields that πid is also a minimizer of |||M − π(M )|||2F.

A.1.2 Proof of Proposition 2.B
We ﬁrst prove the upper bound on the Spearman’s footrule metric. Due to the monotonicity of the rows and the columns of M ∗, we have the lower bound
n
|||M ∗ − π(M ∗)|||2F ≥ |||M ∗ − Mπ∗( )|||22 .
=1

Now consider any ∈ [n] such that π( ) > . Then we have

π( )−1

(i) π( )−1

(ii)

|||M ∗ − Mπ∗( )|||22 = |||

(Mi∗ − Mi∗+1)|||22 ≥

|||Mi∗ − Mi∗+1|||22 ≥ γ2|π(i) − i|,

i=

i=

where the inequality (i) is a consequence of the fact that for every i ∈ [n − 1], every entry of the vector (Mi∗ − Mi∗+1) is non-negative, and the inequality (ii) results from the assumed γ-separation condition on the rows of M ∗. An identical argument holds when π( ) < . This
argument completes the proof of the upper bound.
We now move on to the lower bound on Spearman’s footrule. To this end, consider the matrix M ∗ ∈ CBISO with its entries given as:

 12 + √γ2



[M ∗]ij =

1 2

 12 − √γ2

if i < j if i = j if i > j.

One

can

verify

that

this

matrix

M∗

satisﬁes

the

required

condition

|||M

∗ i

−

M

∗ i+1

|||22

=

γ2

for

every

i ∈ [n−1]. One can also compute that this matrix also satisﬁes the condition |||M ∗ −π(M ∗)|||F =

4γ2

n =1

|

− π( )|, thereby yielding the claim.

A.1.3 Proof of Proposition 2.C
It is well known [DG77] that the Kemeny distance and Spearman’s footrule distance between two permutation lie within a factor of 2 of each other.

41

A.2 Estimating comparison probabilities under Kullback-Leibler divergence
Let PM denote the probability distribution of the observation matrix Y ∼ {0, 1}n×n obtained by independently sampling entry Yij from a Bernoulli distribution with parameter Mij. The Kullback-Leibler (KL) divergence between PM and PM is given by

DKL(PM PM ) = Mij log Mij + (1 − Mij) log 1 − Mij .

Mij

1 − Mij

Before we establish the connection with the squared Frobenius norm, we make one assump-
tion on the pairwise comparison probabilities that is standard in the literature on estimation from pairwise comparisons [NOS12, HOX14, SBB+16, CS15]. We assume that every entry of M ∗ is bounded away from {0, 1}. In other words, we assume the existence of some known constant-valued parameter ∈ (0, 21 ] whose value is independent of n, such that Mi∗j ∈ ( , 1 − ) for every pair (i, j). Given this assumption, for any estimator M of M ∗, we clip each of its entries and force them to lie in the interval ( , 1 − ).10 The following proposition then relates
the Kullback-Leibler divergence metric to estimation under the squared Frobenius norm.

Proposition 3. The probability distributions induced by any two probability matrices M ∗ and M must satisfy the sandwich inequalities:

|||M − M ∗|||2F ≤ DKL(PM PM∗) ≤ (1 1− ) |||M − M ∗|||2F,

where for the upper bound we have assumed that every entry of the matrices lies in ( , 1 − ).

The proof of the proposition follows from standard upper and lower bounds on the natural logarithm (45b). As a consequence of this result, any upper or lower bound on |||M − M ∗|||2F therefore automatically implies an identical upper or lower bound on DKL(PM PM∗) up to constant factors.

B Proof of Proposition 1
We show that the matrix M ∗ speciﬁed in Figure 1a satisﬁes the conditions required by the proposition. It is easy to verify that M ∗ ∈ CSST, so that it remains to prove the approximationtheoretic lower bound (6). In order to do so, we require the following auxiliary result:
Lemma 12. Consider any matrix M that belongs to CPAR(F ) for a valid function F . Suppose for some collection of four distinct items {i1, . . . , i4}, the matrix M satisﬁes the inequality Mi1i2 > Mi3i4 . Then it must also satisfy the inequality Mi1i3 ≥ Mi2i4 .
We return to prove this lemma at the end of this section. Taking it as given, let us now proceed to prove the lower bound (6). For any valid F , ﬁx an arbitrary member M of a class CPAR(F ), and let w ∈ Rn be the underlying weight vector (see the deﬁnition (4)).
Pick any item in the set of ﬁrst n4 items (corresponding to the ﬁrst n4 rows of M ∗) and call this item as “1”; pick an item from the next set of n4 items (rows) and call it item “2”; item “3” from the next set and item “4” from the ﬁnal set. Our analysis proceeds by developing some relations between the pairwise comparison probabilities for these four items that must hold for every parametric model, that are strongly violated by M ∗. We divide our analysis into two possible relations between the entries of M .
10This clipping step does not increase the estimation error.

42

Case I: First suppose that M12 ≤ M34. Since M1∗2 = 6/8 and M3∗4 = 5/8 in our construction, it follows that
(M12 − M1∗2)2 + (M34 − M3∗4)2 ≥ 2156 .
Case II: Otherwise, we may assume that M12 > M34. Then Lemma 12 implies that M13 ≥ M24. Moreover, since M1∗3 = 7/8 and M2∗4 = 1 in our construction, it follows that
(M13 − M1∗3)2 + (M24 − M2∗4)2 ≥ 2156 .

Aggregating across these two exhaustive cases, we ﬁnd that

(Muv − Mu∗v)2 ≥ 2156 .
(u,v)∈{1,2,3,4}

Since this bound holds for any arbitrary selection of items from the four sets, we conclude that

1 n2

|||M

−

M ∗|||2F

is

lower

bounded

by

a

universal

constant

c

>

0

as

claimed.

Finally, it is easy to see that upon perturbation of any of the entries of M ∗ by at most 312 —

while still ensuring that the resulting matrix lies in CSST—the aforementioned results continue

to hold, albeit with a worse constant. Every matrix in this class satisﬁes the claim of this

proposition.

Proof of Lemma 12: It remains to prove Lemma 12. Since M belongs to the parametric family, there must exist some valid function F and some vector w that induce M (see Equation (4)). Since F is non-decreasing, the condition Mi1i2 > Mi3i4 implies that
wi1 − wi2 > wi3 − wi4 .
Adding wi2 − wi3 to both sides of this inequality yields wi1 − wi3 > wi2 − wi4. Finally, applying the non-decreasing function F to both sides of this inequality gives yields Mi1i3 ≥ Mi2i4 as claimed, thereby completing the proof.

C Minimizing feedback arc set over entire SST class
Our analysis in Theorem 3 shows that the two-step estimator proposed in Section 3.3 works well under the stated bounds on the entries of M ∗, i.e., for M ∗ ∈ CHIGH(γ) for a ﬁxed γ. This two-step estimator is based on ﬁnding a minimum feedback arc set (FAS) in the ﬁrst step. In this section, we investigate the eﬃcacy of estimators based on minimum FAS over the full class CSST. We show that minimizing the FAS does not work well over CSST.
The intuition is that although minimizing the feedback arc set appears to minimize disagreements at a global scale, it makes only local decisions: if it is known that items i and j are in adjacent positions, the order among these two items is decided based solely on the outcome of the comparison between items i and j, and is independent of the outcome of the comparisons of i and j with all other items.
Here is a concrete example to illustrate this property. Suppose n is divisible by 3, and consider the following (n × n) block matrix M ∈ CSST:
 12 21 1  M =  12 21 34  ,
0 41 12

43

where each block is of size ( n3 × n3 ). Let π1 be the identity permutation, and let π2 be the permutation [ n3 + 1, . . . , 23n , 1, . . . , n3 , 23n + 1, . . . , n], that is, π2 swaps the second block of n3 items with the ﬁrst block. For any permutation π of the n items and any M ∈ CSST, let π(M ) denote
the (n × n) matrix resulting from permuting both the rows and the columns by π. One can verify that |||π1(M ) − π2(M )|||2F ≥ cn2, for some universal constant c > 0. Now
suppose an observation Y is generated from π1(M ) as per the model (1). Then the distribution of the size of the feedback arc set of π1 is identical to the distribution of the size of the feedback arc set of π2. Minimizing FAS cannot distinguish between π1(M ) and π2(M ) at least 50% of
the time, and consequently, any estimator based on the minimum FAS output cannot perform
well over the SST class.

D Relation to other models
We put things in perspective to the other models considered in the literature. We begin with two weaker versions of stochastic transitivity that are also investigated in the literature on psychology and social science.

D.1 Moderate and weak stochastic transitivity

The model CSST that we consider is called strong stochastic transitivity in the literature on psychology and social science [Fis73, DM59]. The two other popular (and weaker) models are those of moderate stochastic transitivity CMST deﬁned as

CMST : =

M

∈

[0, 1]n×n

|

Mik

≥

min{Mij, Mjk}

for

every

(i, j, k)

satisfying

Mij

≥

1 2

and

Mjk

≥

1 2

,

and weak stochastic transitivity CWST deﬁned as

CWST : =

M

∈

[0, 1]n×n

|

Mik

≥

1 2

for

every

(i, j, k)

satisfying

Mij

≥

1 2

and

Mjk

≥

1 2

.

Clearly, we have the inclusions CSST ⊆ CMST ⊆ CWST. In Theorem 1, we prove that the minimax rates of estimation under the strong stochastic
transitivity assumption are Θ˜ (n−1). It turns out, however, that the two weaker transitivity
conditions do not permit meaningful estimation.

Proposition 4. There exists a universal constant c > 0 such that under the moderate CMST stochastic transitivity model,

inf sup 1 E[|||M − M ∗|||2] > c.

M M ∗∈CMST n2

F

where the inﬁmum is taken over all measurable mappings from the observations Y to [0, 1]n×n. Consequently, for the weak stochastic transitivity model CWST, we also have

inf sup 1 E[|||M − M ∗|||2] > c,

M M ∗∈CWST n2

F

The minimax risk over these two classes is clearly the worst possible (up to a universal

constant) since for any two arbitrary matrices M and M

in

[0, 1]n×n,

we

have

1 n2

|||M

−M

|||2F

≤

1. For this reason, in the paper we restrict our analysis to the strong stochastic transitivity

condition.

44

construction 2 construction 3

CFULL

CPAR CSST

construction 1 all-half matrix construction 4
Figure 3. Relations between various models of pairwise comparisons. The constructions proving these relations are presented as a part of the proof of Proposition 5.
D.2 Comparison with statistical models
Let us now investigate relationship of the strong stochastic transitivity model considered in this paper with two other popular models in the literature on statistical learning from comparative data. Perhaps the most popular model in this regard is the class of parametric models CPAR: recall that this class is deﬁned as
CPAR : = {M | Mij = F (wi∗ − wj∗) for some non-decreasing function F : R → [0, 1], and vector w∗ ∈ Rn}.
The parametric class of models assumes that the function F is ﬁxed and known. Statistical estimation under the parametric class is studied in several recent papers [NOS12, HOX14, SBB+16]. The setting where the function F is ﬁxed, but unknown leads to a semi-parametric variant. The results presented in this section also readily apply to the semi-parametric class.
The second class is that generated from distributions over complete rankings [Dia89, FJS13, DIS15]. Speciﬁcally, every element in this class is generated as the pairwise marginal of an arbitrary probability distribution over all possible permutations of the n items. We denote this class as C . FULL
The following result characterizes the relation between the classes.
Proposition 5. Consider any value of n > 10. The parametric class CPAR is a strict subset of the strong stochastic transitivity class CSST. The class CFULL of marginals of a distribution on total rankings is neither a subset nor a superset of either of the classes CSST, CPAR, and CSST\CPAR.
The various relationships in Proposition 5 are depicted pictorially in Figure 3. These relations are derived by ﬁrst establishing certain conditions that matrices in the classes considered must satisfy, and then constructing matrices that satisfy or violate one or more of these conditions. The conditions on CFULL arise from the observation that the class is the convex hull of all SST matrices that have their non-diagonal elements in {0, 1}; we derive conditions on this convex hull that leads to properties of the CFULL class. To handle the parametric class CPAR, we employ a necessary condition discussed earlier in Section 2.4 and deﬁned formally in Lemma 12. The SST class CSST is characterized using the insights derived throughout the paper.
D.3 Proof of Proposition 4
We will derive an order one lower bound under the moderate stochastic transitivity condition. This result automatically implies the order one lower bound for weak stochastic transitivity.
45

The proof imposes a certain structure on a subset of the entries of M ∗ in a manner that
Θ(n2) remaining entries are free to take arbitrary values within the interval [ 21 , 1]. This ﬂexibility then establishes a minimax error of Θ(1) as claimed.

Let us suppose M ∗ corresponds to the identity permutation of the n items, and that this

information is public knowledge. Set the entries of M ∗ above the diagonal in the following manner. For every i ∈ [n] and every odd j ∈ [n], set Mi∗j = 21 . For every i ∈ [n] and every even j ∈ [n], set Mj∗i = 12 . This information is also assumed to be public knowledge. Let S ⊂ [n]2 denote the set of all entries of M ∗ above the diagonal whose values were not assigned in the

previous step. Let |S| denote the size of set S. The entries below the diagonal are governed by

the skew-symmetry constraints.
We ﬁrst argue that every entry in S can take arbitrary values in the interval [ 12 , 1], and are not constrained by each other under the moderate stochastic transitivity condition. To this

end, consider any entry (i, k) ∈ S. Recall that the moderate stochastic transitivity condition

imposes the following set of restrictions in Mi∗k: for every j, Mi∗k ≥ min{Mi∗j, Mj∗k}. From our

earlier

construction

we

have

that

for

every

odd

value

of

j,

Mi∗j

=

1 2

and

hence

the

restriction

simply reduces to Mi∗k ≥ 12 . On the other hand, for every even value of j, our construction

gives Mj∗k = 21 , and hence the restriction again reduces to Mi∗k ≥ 12 . Given the absence of any

additional restrictions, the error E[|||M − M ∗|||2F] ≥ c|S|. Finally, observe that every entry (i, k) where i < k, i is odd and k is even belongs to the set S. It follows that |S| ≥ n82 , thus proving our claim.

D.4 Proof of Proposition 5
The constructions governing the claimed relations are enumerated in Figure 3 and the details are provided below.
It is easy to see that since F is non-decreasing, the parametric class CPAR is contained in the strong stochastic transitivity class CSST. We provide a formal proof of this statement for the sake of completeness. Suppose without loss of generality that w1 ≥ · · · ≥ wn. Then we claim that the distribution of pairwise comparisons generated through this model result in a matrix, say M , that lies in the SST model with the ordering following the identity permutation. This is because for any i > j > k,

wi − wk ≥ wi − wj F (wi − wk) ≥ F (wi − wj)
Mik ≥ Mij .

We now show the remaining relations with the four constructions indicated in Figure 3.

While these constructions target some speciﬁc value of n, the results hold for any value n

greater than that speciﬁc value. To see this, suppose we construct a matrix M for some n = n0,

and show that it lies inside (or outside) one of these classes. Consider any n > n0, and deﬁne

a (n × n) matrix M

as

having

M

as

the

top-left

(n0

× n0)

block,

1 2

on

the

remaining

diagonal

entries, 1 on the remaining entries above the diagonal and 0 on the remaining entries below the

diagonal. This matrix M will retain the properties of M in terms of lying inside (or outside,

respectively) the claimed class.

In this proof, we use the notation i j to represent a greater preference for i as compared

to j.

46

D.4.1 Construction 1

We construct a matrix M such that M ∈ CFULL but M ∈/ CSST. Let n = 3. Consider the following distribution over permutations of 3 items (1, 2, 3):

P(1 2 3) = 25 , P(3 1 2) = 15 , P(2 3 1) = 25 .

This distribution induces the pairwise marginals

P(1 2) = 35 , P(2 3) = 45 , P(3 1) = 35 .

Set Mij = P(i j) for every pair. By deﬁnition of the class C , FULL we have M ∈ C . FULL

A necessary condition for a matrix M to belong to the class CSST is that there must exist at

least

one

item,

say

item

i,

such

that

Mij

≥

1 2

for

every

item

j.

One

can

verify

that

the

pairwise

marginals enumerated above do not satisfy this condition, and hence M ∈/ CSST.

D.4.2 Construction 2
We construct a matrix M such that M ∈ CSST ∩ CFULL but M ∈/ CPAR. Let n = 4 and consider the following distribution over permutations of 4 items (1, 2, 3, 4):

1 P(3 1 2 4) = 8 ,

1 P(1 2 4 3) = 8

2

4

P(2 1 4 3) = 8 and P(1 2 3 4) = 8 .

One can verify that this distribution leads to the following pairwise comparison matrix M (with the ordering of the rows and columns respecting the permutation 1 2 3 4):

4 6 7 8 M : = 1 2 4 7 8 .
8 1 1 4 5 0034

It is easy to see that this matrix M ∈ CSST, and by construction M ∈ C . FULL Finally, the proof of Proposition 4 shows that M ∈/ CPAR, thereby completing the proof.

D.4.3 Construction 3
We construct a matrix M such that M ∈ CPAR (and hence M ∈ CSST) but M ∈/ C . FULL First observe that any total ordering on n items can be represented as an (n × n) matrix in the SST class such that all its oﬀ-diagonal entries take values in {0, 1}. The class CFULL is precisely the convex hull of all such binary SST matrices.
Let B1, . . . , Bn! denote all (n × n) matrices in CSST whose oﬀ-diagonal elements are restricted to take values in the set {0, 1}. The following lemma derives a property that any matrix in the convex hull of B1, . . . , Bn! must satisfy.

47

Lemma 13. Consider any M ∈ CSST, and consider three items i, j, k ∈ [n] such that M respects

the ordering i

j

k.

Suppose

Mij

= Mjk

=

1 2

and

Mik

= 1.

Further

suppose

that

M

can

be

written as

M= αB,

(59)

∈[n!]

where α ≥ 0 ∀ and Bij = Bjk.

n! =1

α

= 1.

Then for any

∈ [n!] such that α > 0, it must be that

The proof of the lemma is provided at the end of this section. Now consider the following (7 × 7) matrix M ∈ CSST:

 12 21 1 1 1 1 1 

 12 12 21 12 1 1 1 

 0

1

1

1

1

1

 1



2222



M : =  0 12 21 12 21 12 1  .

 0

0

1

1

1

1

 1



2222



 0 0 0 12 21 12 12 

0 0 0 0 0 21 12

(60)

We will now show via proof by contradiction that M cannot be represented as a convex combination of the matrices B1, . . . , Bn!. We will then show that M ∈ CPAR.
Suppose one can represent M as a convex combination M = ∈[n!] α B , where α1, . . . , αn!
are non-negative scalars that sum to one. Consider any such that α = 0. Let B12 = b ∈ {0, 1}. Let us derive some more constraints on B . Successively applying Lemma 13 for the following values of i, j, k implies that B must necessarily have the form (61) shown below. Here ¯b : = 1−b
and ‘∗’ denotes some arbitrary value that is irrelevant to the discussion at hand.

• i = 1, j = 2, k = 3 gives B23 = ¯b • i = 1, j = 2, k = 4 gives B24 = ¯b

• i = 2, j = 3, k = 5 gives B35 = b

• i = 2, j = 4, k = 6 gives B46 = b • i = 3, j = 5, k = 6 gives B56 = ¯b • i = 4, j = 6, k = 7 gives B67 = ¯b.

Thus B must be of the form

 12 b 1 1 1 1 1 

 12 12 ¯b ¯b 1 1 1 

 0

b

1

∗

b

1

 1



2



B =  0 b ∗ 12 ∗ b 1  . (61)

 0

0

¯b

∗

1

¯b

 1



2



 0 0 0 ¯b b 12 ¯b 

0 0 0 0 0 b 12

48

Finally, applying Lemma 13 with i = 5, j = 6 and k = 7 implies that B67 = b, which contradicts the necessary condition in equation (61). We have thus shown that M ∈/ C . FULL
We now show that the matrix M constructed in equation (60) is contained in the class CPAR. Consider the following function F : [−1, 1] → [0, 1] in the deﬁnition of a parametric class:

 0  F (x) = 12
 1

if x < −0.25 if −0.25 ≤ x ≤ 0.25 if x > 0.25.

Let n = 7 with w1 = .9, w2 = .7, w3 = .6, w4 = .5, w5 = .4, w6 = .3 and w7 = .1. One can verify that under this construction, the matrix of pairwise comparisons is identical to that in equation (60).

Proof of Lemma 13 In what follows, we show that 0. The result then follows immediately.

:Bij =1,Bjk=1 α =

:Bij =1,Bjk=1 α =

Consider some ∈ [n!] such that α > 0 and Bij = 0. Since Mik = 1, we must have

Bik = 1. Given that B represents a total ordering of the n items, that is, B is an SST matrix with boolean-valued its oﬀ-diagonal elements, Bij = 0 and Bik = 1 imply that Bjk = 1. We

have thus shown that Bjk = 1 whenever Bij = 0. This result has two consequences. The ﬁrst

consequence is that :Bij=0,Bjk=0 α = 0. The second consequence employs the additional fact

that

Mij

=

1 2

and

hence

:B =0 α = 21 , and then gives ij

:B =0,B =1 α = 12 . Building on,

ij

jk

we have

1

2 = Mjk = α + α ,

:Bij =0,Bjk=1

:Bij =1,Bjk=1

and hence we have :Bij=1,Bjk=1 α = 0, thus completing the proof.

D.4.4 Construction 4
We construct a matrix M such that M ∈ CSST but M ∈/ CFULL and M ∈/ CPAR. Consider n = 11. Let M2 denote the (4 × 4) matrix of Construction 2 and let M3 denote the (7 × 7) matrix of construction 3. Consider the (11 × 11) matrix M of the form

M : = M2 1 . 0 M3
Since M2 ∈ CSST and M3 ∈ CSST, it is easy to see that M ∈ CSST. Since M2 ∈/ CPAR and M ∈/ C , FULL it follows that M ∈/ CPAR and M ∈/ C . FULL This construction completes the proof of Proposition 5.

49

