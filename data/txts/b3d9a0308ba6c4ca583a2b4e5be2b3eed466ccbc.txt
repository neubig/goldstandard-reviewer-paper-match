Distributed Relay Selection in Presence of Dynamic Obstacles in Millimeter Wave D2D Communication
Durgesh Singh, Arpan Chattopadhyay & Sasthi C. Ghosh

arXiv:1910.14367v2 [cs.NI] 12 Feb 2020

Abstract—Millimeter wave (mmWave) device to device (D2D) communication is highly susceptible to obstacles due to severe penetration losses and requires almost a line of sight (LOS) communication path. D2D channel condition is local to devices/user equipments (UEs) and hence is not directly visible to the base station (BS). Thus quality of the D2D channel needs to be propagated to BS by UEs which may incur some delay. Hence the solution provided by BS to UEs using this gathered channel information might become less useful to establish communication due to moving obstacles. These types of obstacles might not be known in advance and hence may cause unpredictable ﬂuctuations to the D2D channel quality. Hence we seek to learn the D2D channels using the ﬁnite horizon partially observable Markov decision process (POMDP) framework to model the uncertainty in such kind of network environments with dynamic obstacles. The objective is to minimize delay when channel quality deteriorates, by making UEs choose locally the best possible decision between i) to continue on the current relay link on which communication is taking place or ii) to switch to another good relay by exploring other possible UEs in its locality. We derive an optimal threshold policy which tells the UE to take appropriate decision locally. Later, we give a simpliﬁed and easy to implement stationary threshold policy which counts the number of successive acknowledgement failures, based on which UE make appropriate decision locally. Through extensive simulation, we demonstrate that our approach outperforms recent algorithms.
I. INTRODUCTION
Device to device (D2D) communication in 5G may bypass the base station (BS) to make devices or user equipments (UE) directly communicate with one another. It helps in reducing outage and reuse resources and to meet the increasing bandwidth requirements of devices. Generally, D2D communication is studied for short distance communication which makes millimeter wave (mmWave) as the suitable candidate for it [1]. Although mmWave has very high available bandwidth, but it suffers from very high propagation losses, which may be compensated using directional beams in multi-input multioutput (MIMO) antennas. However, the penetration loss is also very severe for mmWaves for most of the outdoor materials [2], [3]. Hence, it renders mmWave unsuitable in presence of such obstacles which may completely block the mmWave signal. Selecting relays to avoid obstacles have been studied in various works [4]–[9]. Most of these work carry out analysis
Durgesh Singh and Sasthi C. Ghosh are with the Advanced Computing & Microelectronics Unit, Indian Statistical Institute, Kolkata 700108, India. Email: durgesh.ccet@gmail.com, sasthi@isical.ac.in.
Arpan Chattopadhyay is with the Department of Electrical Engineering, Indian Institute of Technology Delhi. Email: arpanc@ee.iitd.ac.in.
This work was supported by the faculty seed grant and professional development allowance (PDA) of IIT Delhi.

on static obstacles, the problem of choosing relays becomes more challenging where the obstacles are also moving.
The D2D channel condition might deteriorate rapidly due to obstacles and especially due to moving obstacles. This in turn causes link breakage and hence packet loss and delay. The BS cannot sense the quality of D2D channel directly and thus such information needs to be communicated by UEs to the BS. Using this gathered information, the BS may suggest source UE to continue communication via another relay. However this might incur some delays and by the time UEs get global solution provided by the BS, it may become less useful for UEs to communicate due to possible blockage by some dynamic obstacle. There can be other parameters local to a UE (like battery, channel availability, perceived throughput etc.) which may further creates problem in implementing the global solution [10]. For mmWave communication, capturing dynamic obstacles is challenging task whose information may not be available apriori to the local nodes/UEs. Radars can be used to sense the obstacles [11], [12], but it may be too expensive to place radars for detecting the moving obstacles. To deal with the uncertainty caused by the dynamic obstacles, a learning based approached using partially observed Markov decision process (POMDP) [13]–[15] is an appropriate choice. We may use past information of D2D channel quality to learn about it. In fact the dynamic obstacle’s presence is also captured indirectly while learning the channel quality.
In this paper, we are modeling our problem of relay selection at each UE locally as a ﬁnite horizon POMDP to capture the uncertainty caused in a D2D channel due to moving obstacles. The state of D2D channel is not observable at the current time instant. It can only be observed after taking the decision to transmit packets to a chosen link in form of acknowledgements (ACKs). Information about dynamic obstacles are not known at BS a priori and it can only be learned using the feedback from UEs after communication has been established. Even the ACKs can get lost due to presence of dynamic obstacles. A given UE transmitting the data packets may initially choose the relay suggested by the BS. However at later time instants, the channel quality of the suggested link might deteriorate and may cause huge packet loss and delay. We use conditional probability of D2D channel quality given the ACKs history as the sufﬁcient statistics which is also called the belief probability of the given link. We then derive an optimal policy which maps the belief to a set of actions. An action chosen can be either to continue on the current link or to stop and explore other possibly available relay links. Later, by exploiting the derived policy structure,

we obtain a stationary policy which tells the UE whether to continue transmitting along the chosen relay link in case of several successive ACK failure. This helps UE to stop sending the packets on the current link (after some successive ACKs failure) to avoid packet loss and mitigate delay. This method is compared with other state of art solutions i) based on a recent work which selects relays based on maximum throughput [7] and ii) received signal strength (RSS) based approach. We show in simulation that our proposed method outperforms other approaches.
Our contributions in this paper are summarized as follows:
1) We consider the effects of dynamic obstacles on D2D mmWave links, which is a new and challenging topic.
2) We formulate the problem of relay selection as a POMDP, and show that the optimal policy checks whether a certain belief probability exceeds a threshold. This is a nontrivial result that required proof of several interesting intermediate results.
3) Our optimal policy can be implemented locally at each node, thereby facilitating distributed implementation.
4) The threshold policy is further reduced to counting the number of successive ACK failures, which is simple and easy to implement.
The rest of the paper is organized as follows. System model is described in section II. The POMDP formulation is provided in section III. Optimal policy structure is derived in section IV. Numerical results are provided in section V, followed by the conclusions in section VI. All proofs are provided in the appendix.

II. SYSTEM MODEL
We are considering the device-tier of 5G D2D architecture mentioned in [16], where devices can communicate among themselves with or without the help from BS. The service region is divided into various zones or grids as shown in ﬁgure 1 with one BS. Each zone may have many UEs and is assumed to have atleast one D2D device which is ready to take part in D2D communication as a relay or source/destination node. We deﬁne sending zone as that zone where at least one UE wants to transmit data to an UE of some other zone. If i is the sending zone then it may form connection to a UE of another zone j ∈ Ui , where Ui is the viable relay zones of the zone i which is given by the BS. A viable relaying zone of zone i is one which is nearer to the zone containing the destination UE and is in the communication range of the zone i. When the UE in zone i forms a connection with another UE of zone j, then it is termed as link j. Link is formed between UEs of two zones when they are in communication range of each other and the received signal strength is sufﬁcient for the required data rate. Each UE can communicate with one another on mmWave channels using directional antennas. The received signal strength (Qij) on zone j from zone i is modeled as [7]:

Qij = µij · Pi · Gt · Gr · P Lij

(1)

where, µij is the shadowing random variable, Pi is the transmit power of UE i, Gt & Gr are transmit and receive beam-

forming gains respectively. P Lij is the distance dependent path loss function.
Time is discretized as (nN +l)δ as shown in ﬁgure 2, where n belongs to set of nonnegative integers, l takes integer values in [0, N − 1], δ is the smaller discretized time slot when the UEs transmit packets locally. It is assumed that δ (for each l ∈ [0, N − 1]) is large enough to send one packet of size L bytes. Here, N is the number of time slots (of δ duration) between two consecutive global decisions by the BS. Global decision by BS is made at time when nN + l is divisible by N . At this time instant BS takes the channel state information from all UEs in the service region and gives the decision of best relaying UE of a given zone for a given source UE. Hence, in between two consecutive time instants when BS can make global decision, a UE can send at-most N packets of size L to another UE. Note that at time l = 0, the UE chooses the relay link suggested by the BS and at time l ∈ {1, 2, · · · , N − 1}, BS has no control over the UEs. At global time instants, BS sends two types of information to UEs, i) the best relay UE (or node) for a given source UE and ii) viable relaying zones Ui for given source zone i, hence the zone i may choose an appropriate zone for relaying data from the set Ui.
There are static and dynamic obstacles in the service region. There is no facility like radars (to track them) available at BS. The behavior of dynamic obstacles are not known a priori and need to be learned from the received acknowledgement of sent packets in an on-line fashion. Since mmWaves are highly susceptible to obstacles and suffer from severe penetration loss, we assume that even a single moving or static obstacle may break an already established D2D link and can cause packet loss. It is assumed that the mobility of UEs in a zone i for N δ duration do not bring them outside the zone and this do not cause link outage. Hence the only factors responsible for link breakage and packet loss are obstacles and channel condition due to fading.
The source/relay node takes local decision when the current link quality is not good enough and the node locally explores and switches to another one-hop node by incurring penalty. This exploration is done for the zone’s set Ui given by BS to ﬁnd out the best relaying zone for that time instant. Note that the UE is using directional mmWave antennas for exploring the neighbors and this time is assumed to cause some signiﬁcant delay with respect to the duration δ. Here both exploring and packet loss is assumed to consume one time unit δ. It is assumed that the relay link is established within this exploration time.
III. PROBLEM FORMULATION AS POMDP
Zone i is the sending zone which contains at least one UE which needs to transmit data to an UE of some other zone j ∈ Ui. This is termed as a link j for the given sending zone i. Hence zone j may contain a relaying UE or the destination UE. Global decision for the best relay is given by the BS at the time instant nN δ to relay data packet till (n + 1)N δ time instant. There are both static and dynamic obstacles present in the environment which causes uncertainty in channel quality.

(0,M)
Zone j Zone i

(M,M)
Relaying zone Dynamic obstacles
Sending zone

(0,0)

(M,0)

Fig. 1. Service region divided into zones along with dynamic obstacles.

Nδ nN δ

(n + 1)N δ

0 12

δ

δ

··· ··· l
(nN + l)δ

N -2 N -1
δδ

Fig. 2. Discretized time slots with the smallest slot duration of δ.

Also, the BS has no direct knowledge of the D2D channel conditions. This might deteriorate the quality of relay link given by the BS. Which might cause packet loss and delay in data transmission. We need to control this packet loss for N δ duration. However, BS do not have control over the data packets sent between time instants nN δ and (n+1)N δ. Hence the node locally needs to select for the best relay zone from Ui given the uncertainty of D2D channels and the current relay link has become bad. Since behavior of channel condition is uncertain and unknown before actually establishing connection and transferring the packets, hence we will formulate this problem as a ﬁnite horizon POMDP [15].
For the duration between instants nN δ and (n + 1)N δ, the time instants are referred as l ∈ [0, N − 1]. Here we want to derive a decision criterion to choose appropriate action (continue with the current relaying zone or explore and switch to some other zone) which lead the system to good state. Good state is deﬁned by the minimum packet loss (in turn delay) considering all the required penalty costs. Hence our objective is to minimize the delay cost incurred due to packet loss while choosing appropriate relays and keeping the exploring and switching cost as low as possible. For our POMDP problem, we will describe state, action, observation, probabilistic structure of the problem, respective costs and cost function in upcoming paragraphs.
For a given sending zone i, the state for all its possible relay links j ∈ U i is written as xjl ∈ {0, 1}. This signiﬁes if relay link j is in good (G) or bad (G) state for values xjl = 1 and xjl = 0 respectively. The relay link is in good state when the channel quality is as required and packet is transmitted successfully without getting blocked from obstacles, whereas in bad state the channel quality drops and hence packet loss occurs. The action set A is deﬁned as {explore & switch to another link (ajl = 0), transmit on current link (zone) (ajl = 1)}. The local node in zone i, makes observation at each

smaller time instant δ after the packet is sent. This observation is in the form of ACK test which is denoted as zlj ∈ {0, 1}. Here, zlj = 0 represents that the acknowledgement is not received for link j because link is bad which causes packet loss and similarly zlj = 1 represents that the acknowledgement is received and link is good and packet is transmitted successfully. We also represent A and A as the ACK received or not (zlj = 1 or zlj = 0) respectively. Since ACK are quick and are available in negligible amount of time, for state xjl = 1 and action ajl = 1, the observation (ACK) is zlj. The ACK may also be uncertain due to the unpredictable behavior of
the given channel under consideration.
The probabilistic structure of the observation assumed here
is shown in ﬁgure 3 and written as:

P

(z

j l

=

1|xjl

=

1)

=

k

;

P

(z

j l

=

0|xjl

=

1)

=

1

−

k

P

(z

j l

=

1|xjl

=

0)

=

0

;

P

(z

j l

=

0|xjl

=

0)

=

1

If the system is in bad state with xjl = 0 at time l,

then the probability of obtaining good observation is zero

(

P

(z

j l

=

1|xjl

=

0)

=

0)

which

is

intuitive

and

obvious.

The

probabilistic structure assumed for the system state transition

is given as:

P (xjl+1 = 1|xjl = 1) = q; P (xjl+1 = 0|xjl = 1) = 1 − q

P (xjl+1 = 1|xjl = 0) = s; P (xjl+1 = 0|xjl = 0) = 1 − s

Here q, s and k are respectively the probabilities that link is

still good, bad link becomes good and the ACK is received

successfully when the link is in good state. It is intuitive and

legitimate to assume that q > s. The transition probability 1−q

indicates that the good link becomes bad due to obstacles or

signal fading. Similarly (1 − s) is the probability that bad link

is still bad (for obstacles it indicates either obstacle is large

in length or moving slowly and effecting the link for longer

period).

For

a

given

relaying

zone

j,

let

Ilj

=

(z

j 0

,

z

j 1

,

·

·

·

,

z

j l

)

q

G

G

s (1-q) G (1-s) G

k A
(1-k)

1

A

Fig. 3. Probabilistic structure of the problem at a node locally.

denote the information vector available locally to the zone i till smaller time instant l. Let us deﬁne bl as the conditional state distribution acting as the sufﬁcient statistics or belief [15](chapter 5) locally for the given relaying link j as:

bjl = P (xjl = 1|Ilj )

(2)

This equation signiﬁes the probability that the relaying link is in good state given the previous history information. The estimator function of the local system is given as:

bjl+1 = Φ(bjl , zlj+1).

(3)

Using Baye’s rule we get,

where,



1,

bjl+1 =

[qbjl +s(1−bjl )](1−k)

,

 [qbjl +s(1−bjl )](1−k)+[(1−q)bjl +(1−s)(1−bjl )]

if zlj+1 = 1 if zlj+1 = 0
(4)

The cost structure is deﬁned as follows: when packet loss

occurs then C is the penalty (in terms of delay) incurred to

overcome it. Since after a packet loss we may need to explore,

hence, this is the same cost for exploration. When there is no

packet loss then the cost incurred is 0. Cost of testing for ACK

is negligible and hence 0. Here our objective is to derive a

decision rule to choose appropriate action (continue with the

current relaying zone or explore and switch to some other

zone) which leads the system to good state and in turn causes

minimum packet loss considering all the required costs. The

expected cost is formulated as a dynamic program. At the end

of the last period i.e., (N − 1)th period, the expected cost is

deﬁned as:

Ajl (bjl )

=

γl

+

P

(z

j l+

1

=

1|bjl )Jl+1(Φ(bjl ,

1))+

P

(z

j l+

1

=

0|bjl )Jl+1(Φ(bjl ,

0))

(9)

For notation simplicity we will now remove the superscript j from each of the respective notations, e.g., we will write bjl as bl and Ajl () as Al(). Hence Ajl (bjl ) can now be denoted as Al(bl).
We can reduce Al(bl) in equation (9) to:

Al(bl) = (1 − kbl)C + (blq + (1 − bl)s)kJl+1(1) + (1 − (blq + (1 − bl)s)k)Jl+1(Φ(bl, 0)) (10)
As an example we will use this expansion to simplify equation (6) as:

JN−2(bjN−2) = min{C, (1 − kbjN−2)C+ (1 − (bN−2q + (1 − bN−2)s)k)C}. (11)

JN−1(bjN−1) = (1 − kbjN−1)C.

(5)

Note that the for the last time instant N − 1, packet loss can be due to two types of events: i) due to the link being in bad state and causing packet loss and ii) when the link is in good state and the ACK is not received due to bad channel quality. For the time instant l = N − 2, we have,

JN−2(bjN−2) = min{C, γN−2 + E[JN−1(bjN−1)] (6)

where, γN−2 is the expected penalty paid due to packet loss at time l = N − 2 which is (1 − kbjN−2)C. The ﬁrst term in minimization expression denotes the exploring & switching
cost and the second term denotes the cost for continuing in
the current relay link. Similarly we can write the dynamic program for the general expression for each l as:

Jl(bjl ) = min{C, γl + E[Jl+1(Φ(bjl , zlj+1))]}

(7)

where, γl is the expected penalty paid due to packet loss at time instant l which is (1 − kbjl )C. After solving this DP we will get a criterion, based on which the local decision can be
made to switch the link or to remain on that link. Hence for a given relay zone j at time instant l, we want to minimize the cost Jl(bl). The analysis of this criterion is given in the next section where we derive a policy which maps the belief
into action. The policy and hence the respective action taken
optimize our objective function.

IV. DERIVATION OF THE OPTIMAL POLICY

A. Properties of Jl(b)
At the end of the (N − 1)th period, the expected cost is as mentioned in equation (5). For the general expression for the time instant l as mentioned in equation (7), we can write it equivalently as:

Jl(bjl ) = min{C, Ajl (bjl )}

(8)

At the end of (N − 2)th period as shown in above equation (11), the local node has calculated bjN−2 that the relay link i is still the good node or not and further decides whether to continue on the already selected relay link j or needs to explore and switch to another relay node and incur extra cost C. In equation (11), (1 − kbjN−2)C indicates the expected penalty incurred due to packet loss and (1 − (bN−2q + (1 − bN−2)s)k)C indicates the expected cost to be incurred at the upcoming time instant l = N − 1.
We now show that functions Al(bl) are piece-wise linear for each l in proposition 1.
Proposition 1. Al(bl) is piece-wise linear and concave in bl for each l.

Proof. See appendix.

Proposition 2. ∀bl−1, bl, bl+1 ∈ [0, 1],

Al−1(bl−1) ≥ Al(bl) ≥ Al+1(bl+1)

Also,

∀b

l

,

b

′ l

,

0

≤

bl

<

b′l

≤

1,

Al(bl)

≥

Al(b′l).

Proof. See appendix.

B. Policy Structure
The structure of an optimal policy for our POMDP problem is provided in the following theorem.

Theorem 1. The optimal policy for our POMDP problem is a threshold policy. At any time instant l ∈ {0, 1, · · · , N −1}, the
optimal action is to continue transmission on the current relay link if bl ≥ αl, and explore and switch to another better relay link if bl < αl. Also, the threshold αl ∈ [0, 1] is non-increasing in l.

Proof. See appendix.

As l → ∞, αl converges to some scalar α, since a decreasing sequence which is bounded below always converges. Hence, for very large horizon length N , the optimal policy

can be approximated by a stationary threshold policy with a

time-invariant threshold α.

Note that, if zl = 1, then bl = 1. Hence, without loss

of generality, let us assume that b0 = 1. If z0 = 0, then

b1

=

Φ(b0

=

1, z0

=

0)

=

q−qk 1−qk

<

1

=

b0. Now, it

is

easy to check that Φ(b, 0) is a strictly increasing function in

b. Hence, b2 = Φ(b1, 0) < Φ(b0, 0) = b1. Proceeding in this

way, we can show that bl strictly decreases with l whenever

we observe several successive ACK failures. We can deﬁne

recursively a probability πm of getting m successive ACK

failure as: π1 = Φ(1, A), π2 = Φ(π1, A), · · · . Let r be the

smallest integer such that πr ≤ α. We can further simplify the

stationary threshold policy as follows.

Simpliﬁed stationary threshold policy: Let r be the

smallest integer such that πr ≤ α. If there are r successive

ACK failures, explore and switch to another better relay link,

else continue transmission on the current relay link.

V. SIMULATION AND RESULTS
A. Simulation Environment
We have divided the service region of 100 m × 100 m square area into zones in form of grids each of dimension 10 m × 10 m. Each zone have sufﬁcient number of UEs which is enough to form a D2D link with UEs of other zones. In the experiment, δ is taken to be 100 ms. Nodes are using directional transmitter and receiver antennas for 60 GHz frequency with Gr = Gt = 6 dB and we are considering a scenario where line of sight path loss exponent is 2.5 and zero mean log-normal shadowing random variable with standard deviation 3.5 [17], [18]. Thermal noise density is −174 dBm/Hz and devices are using 24 dBm transmit power. Capacity of each link (i, j) is B log2(1+Sij) bits/sec, where B = 20 M Hz [19] is bandwidth and Sij is the received signal to noise ratio. We are assuming ﬁxed packet length of 65535 bytes. There are maximum 16 static and D dynamic obstacles present in the environment, where D ∈ {0, 16, 32, 48, 64}. Static obstacles are placed uniformly in the service region. Each static obstacle is assumed to be of the dimension of a grid. Hence all communication going via that grid where there is an static obstacle will get blocked. Each dynamic obstacles is moving randomly and independently of each other and following a simple blockage model such that with probability 0.5 it will block a given link otherwise it will not block the link. We are assuming that a given zone i can make connection with another zone out of given at-most 16 neighboring zones surrounding it i.e Ui ≤ 16. We assume a single source-destination pair for simplicity and all other devices in a given zone may act as relay.
We have written our own C++ custom code and run them on a GNU 4.8 compiler on Intel core i7 machine. We run our experiments for around 10000 runs and take average results per run and per hop for the packet loss per packet delivered and end to end (E2E) delay per packet. Here packet loss per packet delivered is deﬁned as the ratio of packet loss and successfully delivered packets to the destination. E2E delay is the total time (in seconds) to send a packet successfully from

source UE to the destination UE ignoring the queuing delays. We are analyzing the results on these parameters with respect to number of dynamic obstacles D. We also analyzed the E2E delay on varying number of static obstacles. We are comparing the results of our proposed approach with metrics: 1) which selects relay link based on received signal strength (RSS Based) and 2) an approach which selects relay link based on maximum overall throughput (ThroughPut Based) [7].
B. Simulation Results & Analysis
In ﬁgure 4, we are comparing the results of packet loss per packet delivered successfully over the number of dynamic obstacles. We can see that as the number of dynamic obstacles is increased the packet loss per packet delivered successfully is also increased. The reason is obvious due to the fact that as the number of dynamic obstacles increases, the chance of getting blocked also increases and hence the packet loss. Our proposed method outperforms other algorithms due to the fact that it learns the quality of the D2D links based on ACK and changes to another better relay when the quality of current D2D link deteriorates.
In ﬁgure 5, we are capturing the results of E2E delay per packet over the number of dynamic obstacles. Here also we can see that as the number of dynamic obstacles is increased the delay also increases. This is due to the fact that as the number of dynamic obstacles increases, packet loss increases and hence it causes extra delay. Our proposed method outperforms other algorithms due to the same reason as mentioned in above paragraph.
Similarly, in ﬁgure 6, we are capturing the results of E2E delay per packet over the number of static obstacles keeping no dynamic obstacles. Here also we can see that as the number of static obstacles is increased the delay also increases since packet loss increases due to blockage from static obstacles too.
C. Discussions
The proposed method can be run on each UE locally to choose an optimal relay at time instants when there is no control of the BS and the D2D channel quality becomes bad. It is evident from the results that as the number of obstacles increases, the packet loss increases rapidly. Since with higher number of the obstacles, the chance of a link to get blocked gets increased. Also the expected number of links getting blocked also increases. However, it might be the case that the number of dynamic obstacles are so large that we may not ﬁnd any D2D link which is free from the blockage due to obstacles. In this case our algorithm will not give any better links due to the reason that it will not ﬁnd any link which satisﬁes the derived threshold policy α. In such cases with very dense dynamic obstacles, empirically the packet loss is very negligible but the packet delivered successfully is also very less and hence delay also might increase. In these scenarios, one appropriate solution would be to opt for the relays which are kept at some height above ground or to chose the transmission over traditional micrometer waves of the BS which is less susceptible to the blockage by obstacles.

Packet Loss per Packet Delivered E2E Delay per Packet (sec) E2E Delay per Packet (sec)

Packet Loss vs No. of Dynamic Obstacles 1.5
Proposed ThroughPut Based RSS Based
1

E2E Delay per Packet vs No. of Dynamic Obstacles

0.06

Proposed ThroughPut Based RSS Based

0.05

E2E Delay per Packet vs No. of Static Obstacles 0.07

0.06

Proposed ThroughPut Based RSS Based

0.05

0.04 0.04

0.5

0.03

0.03 0.02

0

0.02

0.01

0

10

20

30

40

50

60

70

0

10

20

30

40

50

60

70

0

No. of Dynamic Obstacles

No. of Dynamic Obstacles

10

20

30

40

50

No. of Static Obstacles

Fig. 4. Packet loss per packet delivered vs No. of dynamic obstacles

Fig. 5. E2E delay per packet (in seconds) vs No. of dynamic obstacles

Fig. 6. E2E delay per packet (in seconds) vs No. of static obstacles

VI. CONCLUSION
Choosing a relay for D2D communication is a challenging task when the dynamic obstacles are present in the environment. This is because D2D channel quality is usually not directly visible to the BS. Dynamic obstacles cause unpredictable ﬂuctuations to the D2D channel quality and hence they need to be learned from the channel statistics. We have modeled the problem of relay selection under the presence of dynamic obstacles as a ﬁnite horizon POMDP framework at each UE. This captures the uncertainty arising due to dynamic obstacles. Using this model, we have derived an optimal threshold policy for each UE that maps belief to action. We then derived a simple stationary policy which tells the UE to locally decide to either continue on the current relay link or to explore and switch to other relay link after successive ACK failures on the current relay link. This stationary policy is simple and easy to implement. Through simulations we show that our approach captures the effects of dynamic obstacles and outperforms other state of art algorithms.
REFERENCES
[1] G. H. Sim, A. Loch, A. Asadi, V. Mancuso, and J. Widmer, “5g millimeter-wave and d2d symbiosis: 60 ghz for proximity-based services,” IEEE Wireless Communications, vol. 24, pp. 140–145, Aug 2017.
[2] H. Zhao, R. Mayzus, S. Sun, M. Samimi, J. K. Schulz, Y. Azar, K. Wang, G. N. Wong, F. Gutierrez, and T. S. Rappaport, “28 ghz millimeter wave cellular communication measurements for reﬂection and penetration loss in and around buildings in new york city,” in 2013 IEEE International Conference on Communications (ICC), pp. 5163–5167, June 2013.
[3] J. Qiao, X. S. Shen, J. W. Mark, Q. Shen, Y. He, and L. Lei, “Enabling device-to-device communications in millimeter-wave 5g cellular networks,” IEEE Communications Magazine, vol. 53, pp. 209–215, January 2015.
[4] T. Bai and R. W. Heath, “Coverage and rate analysis for millimeter-wave cellular networks,” IEEE Transactions on Wireless Communications, vol. 14, pp. 1100–1114, Feb 2015.
[5] B. Xie, Z. Zhang, and R. Q. Hu, “Performance study on relay-assisted millimeter wave cellular networks,” in 2016 IEEE 83rd Vehicular Technology Conference (VTC Spring), pp. 1–5, May 2016.
[6] S. Biswas, S. Vuppala, J. Xue, and T. Ratnarajah, “An analysis on relay assisted millimeter wave networks,” in 2016 IEEE International Conference on Communications (ICC), pp. 1–6, May 2016.
[7] N. Wei, X. Lin, and Z. Zhang, “Optimal relay probing in millimeterwave cellular systems with device-to-device relaying,” IEEE Transactions on Vehicular Technology, vol. 65, pp. 10218–10222, Dec 2016.

[8] W. Kim, J. Song, and S. Baek, “Relay-assisted handover to overcome blockage in millimeter-wave networks,” in 2017 IEEE 28th Annual International Symposium on Personal, Indoor, and Mobile Radio Communications (PIMRC), pp. 1–5, Oct 2017.
[9] B. Ma, H. Shah-Mansouri, and V. W. S. Wong, “Full-duplex relaying for d2d communication in millimeter wave-based 5g networks,” IEEE Transactions on Wireless Communications, vol. 17, pp. 4417–4431, July 2018.
[10] A. Orsino, A. Samuylov, D. Moltchanov, S. Andreev, L. Militano, G. Araniti, and Y. Koucheryavy, “Time-dependent energy and resource management in mobility-aware d2d-empowered 5g systems,” IEEE Wireless Communications, vol. 24, pp. 14–22, Aug 2017.
[11] J. Park and R. W. Heath, “Analysis of blockage sensing by radars in random cellular networks,” IEEE Signal Processing Letters, vol. 25, pp. 1620–1624, Nov 2018.
[12] D. Singh and S. C. Ghosh, “Network-assisted D2D relay selection under the presence of dynamic obstacles,” CoRR, vol. abs/1907.08500, 2019.
[13] M. Abu Alsheikh, D. T. Hoang, D. Niyato, H. Tan, and S. Lin, “Markov decision processes with applications in wireless sensor networks: A survey,” IEEE Communications Surveys Tutorials, vol. 17, pp. 1239– 1267, thirdquarter 2015.
[14] K. Kaza, R. Meshram, and S. N. Merchant, “Relay employment problem for unacknowledged transmissions: Myopic policy and structure,” in 2017 IEEE International Conference on Communications (ICC), pp. 1– 7, May 2017.
[15] D. P. Bertsekas, Dynamic Programming and Optimal Control, Vol. I, 4th Edition.
[16] M. N. Tehrani, M. Uysal, and H. Yanikomeroglu, “Device-to-device communication in 5g cellular networks: challenges, solutions, and future directions,” IEEE Communications Magazine, vol. 52, no. 5, pp. 86–92, 2014.
[17] N. Deng and M. Haenggi, “A ﬁne-grained analysis of millimeter-wave device-to-device networks,” IEEE Transactions on Communications, vol. 65, pp. 4940–4954, Nov 2017.
[18] T. S. Rappaport, G. R. MacCartney, M. K. Samimi, and S. Sun, “Wideband millimeter-wave propagation measurements and channel models for future wireless communication system design,” IEEE Transactions on Communications, vol. 63, pp. 3029–3056, Sep. 2015.
[19] A. Al-Hourani, S. Chandrasekharan, and S. Kandeepan, “Path loss study for millimeter wave device-to-device communications in urban environment,” in Communications Workshops (ICC), 2014 IEEE International Conference on, pp. 102–107, IEEE, 2014.

APPENDIX

Proof of proposition 1:
We will prove this proposition for a general b instead bl. We will prove this by ﬁrst showing that Jl(b) is piece-wise linear and concave for each l using induction. Then we prove our proposition. For time instant (N − 1), we have, JN−1(b) = (1 − kb)C, which is linear. For time instant (N − 2), we have, JN−2(b) = min{C, (1 − kb)C + (1 − (bq + (1 − b)s)k)C} which is also piece-wise linear and concave.
Assuming Jl+1(b) is piece-wise linear and concave in b, we can say that for some suitable scalars, η1, η2, · · · , ηn and β1, β2, · · · , βn, Jl+1(b) can be written as:

Jl+1(b) = min{η1 + β1b, η2 + β2b, · · · , ηn + βnb}.

(12)

We can write Jl(b)=min{C, Al(b)}. Expanding it using equation (10), we get:

Jl(b)=min{C, (1 − kb)C + (bq + (1 − b)s)kJl+1(1) + (1 − (bq + (1 − b)s)k)Jl+1

(bq+s(1−b))(1−k) 1−{bq+s(1−b)}k

}

(13)

Substituting for Jl+1 from equation (12) in above equation (13), we get:

Jl(b)=min{C,

(1

−

kb)C

+

(bq

+

(1

−

b)s)kJl+1(1)

+

(1

−

(bq

+

s(1

−

b))k)

min{η1

+

β1

(bq+s(1−b))(1−k) 1−{bq+s(1−b)}k

,

(bq + s(1 − b))(1 − k)

(bq + s(1 − b))(1 − k)

η2 + β2 1 − {bq + s(1 − b)}k , · · · , ηn + βn 1 − {bq + s(1 − b)}k }} (14)

We can further reduce above equation as:

Jl(b) = min{C, (1 − kb)C + (bq + (1 − b)s)kJl+1(1) + min{η1(1 − {bq + s(1 − b)}k) + β1(bq + s(1 − b))(1 − k), η2(1 − {bq + s(1 − b)}k) + β2(bq + s(1 − b))(1 − k), · · · , ηn(1 − {bq + s(1 − b)}k) + βn(bq + s(1 − b))(1 − k)}} (15)
This is again piece-wise linear and concave in b. Thus the induction is complete. Now we will show that Al(b) is also piece-wise linear and concave in b:

Al(b) = (1 − kb)C + (bq + (1 − b)s)kJl+1(1) + (1 − (bq + (1 − b)s)k)Jl+1(Φ(b, 0)) (16)
The ﬁrst term (1 − kb)C is linear in b. In the second term, (bq + (1 − b)s)k is linear in b and Jl+1(1) is independent of b, hence overall (1 − kb)C + (bq + (1 − b)s)kJl+1(1) is linear in b. Now we prove that (1 − (bq + (1 − b)s)k)Jl+1(Φ(b, 0)) is piece-wise linear in b by expanding it using equation (12), we get,

(bq + s(1 − b))(1 − k) (1 − (bq + (1 − b)s)k)Jl+1(Φ(b, 0)) = (1 − (bq + (1 − b)s)k) min{η1 + β1 1 − {bq + s(1 − b)}k , η2+

(bq + s(1 − b))(1 − k)

(bq + s(1 − b))(1 − k)

β2 1 − {bq + s(1 − b)}k , · · · , ηn + βn 1 − {bq + s(1 − b)}k } (17)

We can reduce above to:

(1 − (bq + (1 − b)s)k)Jl+1(Φ(b, 0)) = min{η1(1 − {bq + s(1 − b)}k) + β1(bq + s(1 − b))(1 − k), η2(1 − {bq + s(1 − b)}k) + β2(bq + s(1 − b))(1 − k), · · · , ηn(1 − {bq + s(1 − b)}k) + βn(bq + s(1 − b))(1 − k)}. (18)
Since minimum of ﬁnite number of concave function is concave, Al(b) is piece-wise linear and concave in b for all l. This proof is similar in spirit to an unsolved exercise given in [15](chapter 5), however the DP and the estimator function
of this paper are different from that given in the book. Hence we had to write a complete proof..

Proof of proposition 2:
We will prove this proposition for a general b for time instants l − 1, l and l + 1 instead of bl−1, bl and bl+1. We will ﬁrst prove Jl(b) ≥ Jl+1(b), then we will use this to prove Al(b) ≥ Al+1(b). First we start for base case l = N − 1 and the ﬁrst term in recursion l = N − 2: JN−1(b) = (1 − kb)C and from equation (11), we have JN−2(b) = min{C, (1 − kb)C + (1 − (bq + (1 − b)s)k)C}. We can easily see that JN−2(b) ≥ JN−1(b). We now prove it for ﬁrst two terms of the recursion JN−2(b) and JN−3(b). We can write JN−3(b) as:

JN−3(b) = min{C, (1 − kb)C + (bq + (1 − b)s)kJN−2(1) + (1 − (bq + (1 − b)s)k)JN−2(Φ(b, 0))}

≥ min{C, (1 − kb)C + (bq + (1 − b)s)kJN−1(1) + (1 − (bq + (1 − b)s)k)JN−1(Φ(b, 0))}

= JN−2(b)

(19)

Hence JN−3(b) ≥ JN−2(b). Similarly it proceeds for other l and hence Jl(b) ≥ Jl+1(b). Now let us see this for Al(b) using previous proof for Jl(b):

Al(b) = (1 − kb)C + (bq + (1 − b)s)kJl+1(1) + (1 − (bq + (1 − b)s)k)Jl+1(Φ(b, 0))

(20)

≥ (1 − kb)C + (bq + (1 − b)s)kJl+2(1) + (1 − (bq + (1 − b)s)k)Jl+2(Φ(b, 0))

(21)

= Al+1(b)

(22)

Hence Al(b) ≥ Al+1(b). This part is proved. To prove the second statement, We will prove it for general b and b′ using induction.

We can see that AN−2(b) = (1 − kb)C + (1 − (bq + (1 − b)s)k)C which is linear and non-increasing function in b. Let us assume this is true for l + 1, such that Al+1(b) ≥ Al+1(b′) for all 0 ≤ b < b′ ≤ 1. Let us now see for l:

Al(b) = (1 − kb)C + (bq + (1 − b)s)kJl+1(1) + (1 − (bq + (1 − b)s)k)Jl+1(Φ(b, 0)). We can rearrange the terms in this to

write as:

Al(b) = C + skJl+1(1) − kb(C − (q − s)Jl+1(1)) + (1 − (bq + (1 − b)s)k)Jl+1(Φ(b, 0))

(23)

This equation can be further reduced as:

Al(b) = C + skJl+1(1) − kbC(1 − (q − s) min{1, Al+1(1)/C}) + (1 − (bq + (1 − b)s)k) min{C, Al+1(Φ(b, 0))} (24)

In above equation, the term Φ(b, 0) ≤ 1 because it is a probability term. Function Φ(b, 0) is increasing in b for q > s
which is clear from equation (4). Hence using this and the induction hypothesis, we can say that Al+1(Φ(b, 0)) is nonincreasing and positive function in b. Also the term (1 − (bq + (1 − b)s)k) is positive (q > s) and non-increasing in b. Hence
we can say that the term (1 − (bq + (1 − b)s)k) min{C, Al+1(Φ(b, 0)) is non-increasing in b. Now let us see the ﬁrst term C +skJl+1(1)−kbC(1−(q−s) min{1, Al+1(1)/C}), here C +skJl+1(1) is a constant and kC(1−(q−s) min{1, Al+1(1)/C}) is a positive quantity (q > s), hence we can say that C + skJl+1(1) − kbC(1 − (q − s) min{1, Al+1(1)/C}) is non-increasing function in b. Sum of these two non-increasing functions is also a non-increasing function, hence, Al(b) is a non-increasing function in b. Hence we can say that Al(b) ≥ Al(b′) for all 0 ≤ b < b′ ≤ 1.

Proof of theorem 1: First let us see the possible cases which exists for the given DP by ﬁxing l = N − 2 and at belief probabilities 0 and 1.
For bN−2 = 0, cost C of exploration is always optimal and for bN−2 = 1, if C < (1 − k)C + (1 − qk)C then continuing on that relay link j for data transmission costs higher than exploring and switching on some other relay link. Similarly if C > (1−k)C +(1−qk)C then continuing on the current link is the best option and exploring other links is never optimal. Hence
we will see the following scenario where we can get the decision criterion for choosing between exploring other links versus continuing on the same relay link. For this case choosing current link is optimal for bN−2 = 1, if C > (1 − k)C + (1 − qk)C. If this condition is true, then there exists a scalar αN−2 with 0 < αN−2 < 1 that determines an optimal policy for the last period as: continue transmission on relay j if bN−2 ≥ αN−2 else stop transmission on relay j and explore and switch to another better relay. Since we are looking for the condition when the communication on given relay link can continue or not. When
it cannot be continued then ﬁrst action is chosen which stops the communication on the current relay link and exploration for
new link begins. Using proposition 1 and proposition 2, we can say that the functions y = C and y = Al(bl) intersect at a single point and
from the DP algorithm in equation (8), we obtain that the optimal policy for each period is determined by the unique scalars αl which are such that: C = Al(αl). Since we get a single point of intersection which decides the optimal choice for choosing an appropriate option, we can say that the optimal policy for the time period l is given as: continue transmission on relaying zone j if bl ≥ αl, else stop transmission on relaying zone j and explore and switch to another better relay.
Second part of this theorem: Using proposition 2, Al(bl) are monotonically non-increasing with respect to l. Hence we can say that sequence of αl is also non-increasing with l (using proposition 1 and 2).

