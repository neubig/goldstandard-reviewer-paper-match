1
Local Relay Selection in Presence of Dynamic Obstacles in Millimeter Wave D2D Communication
Durgesh Singh, Arpan Chattopadhyay & Sasthi C. Ghosh

arXiv:2011.01537v1 [cs.NI] 1 Nov 2020

Abstract—Blockage due to obstacles in millimeter wave (mmWave) device to device (D2D) communication is a prominent problem due to their severe penetration losses. Potential user equipments (UEs) in vicinity of the source UE must be explored in order to select a new relay when the current link gets blocked. However, dynamic obstacles are not known in advance and thus may cause unpredictable ﬂuctuations to D2D channel quality causing newly selected relay link also to be susceptible to blockage. This might cause frequent relay switching leading to call drops and high energy consumption. We have proposed the idea of reducing frequency in relay exploration and switching and thus average end-to-end delay (in seconds) at the expense of additional exploration time units (few milliseconds) during beam alignment. We seek to learn the uncertainty in D2D link qualities by modeling the problem as ﬁnite horizon partially observable Markov decision process (POMDP) framework locally at each UE. We have derived an optimal threshold policy which maps the state to set of actions. We then give a simpliﬁed and easy to implement stationary threshold policy which counts the number of successive acknowledgment successes/failures for making decisions of selecting or not selecting a given relay locally. Through extensive simulation, we validate our theoretical ﬁndings and demonstrate that our approach captures the tradeoff between average exploration time and average end-to-end (E2E) delay in presence of dynamic obstacles.
Index Terms—Relay selection, Millimeter wave D2D communication, Exploration, Dynamic Obstacles, POMDP.
I. INTRODUCTION
Device to device (D2D) communication enables proximity devices or user equipments (UEs) to directly communicate with one another bypassing the base station (BS) [1]. High available bandwidth and short range transmission of millimeter wave (mmWave) is a lucrative choice for D2D communication [2]–[4]. Although very high propagation losses of mmWave are compensated by transmitting directional beams using antennas arrays, severe penetration loss of mmWave make it susceptible to very high blockage from various obstacles [2], [5], [6]. Obstacles may block the mmWave signal completely, thus needing an almost line of sight (LOS) path. Additionally, the presence of dynamic obstacles might deteriorate D2D channel condition rapidly & abruptly causing unprecedented
Durgesh Singh and Sasthi C. Ghosh are with the Advanced Computing & Microelectronics Unit, Indian Statistical Institute, Kolkata 700108, India. Email: durgesh.ccet@gmail.com, sasthi@isical.ac.in.
Arpan Chattopadhyay is with the Department of Electrical Engineering, Indian Institute of Technology Delhi. Email: arpanc@ee.iitd.ac.in.
This work was supported by the faculty seed grant and professional development allowance (PDA) of IIT Delhi.

link breakage and hence packet loss, delay and high energy consumption.
In case of blockage by dynamic obstacle, a new relay is chosen by exploring new relay links through beam-forming [7], [8] which are in the source UE’s vicinity. This is a directional search of new relay and has a considerable delay. A detailed techniques for beam-alignment and beam-management under various scenarios can be found in [9]. The new relaying UE must be chosen carefully during exploration time (ranging from few microseconds to 10 ms [7] for short range), because it may get blocked during data transmission time (100-1000 times higher than exploration time) due to presence of dynamic obstacles, even when the source and relay beams are perfectly aligned to achieve highest data rate as shown in ﬁgure 1. This might lead to frequent relay exploration and switching which causes increased delay, energy consumption and probably outage leading to call drops. In addition, exchange of channel state information with the BS might cause extra delay [10] since the D2D channel is not directly visible to the BS. Hence the decision to explore and select a relay must be made locally.

Perfectly aligned beam during exploration phase

Relay UE Source UE
Relay UE

Approaching Dynamic Obstacle

Relay UE

Relay UE

Destination UE

Fig. 1. Perfectly aligned beam of source-destination during exploration susceptible for blockage due to dynamic obstacles.

Most of the works [11]–[14] deal with static obstacles. However, dynamic obstacles are unpredictable which must be captured and their effects taken into account. The authors in [6] showed a signiﬁcant drop in data rate when a pedestrian act as a blockage. The authors in [15], [16] used radar to capture the movement of UEs and obstacles. Vision cameras and machine learning (ML) techniques were used by the authors in [4], [6], [17], [18] for tracking obstacle’s spatio-temporal behavior. However all these require either expensive hardware or high processing time and energy usage. These might be apt at the BS but not at the UE which needs a local solution in an online fashion. The ML based solution in [17] might need re-training when there is change in the environment. Moreover, it requires that the link breakage event must follow some well deﬁned pattern with some known distribution. However, due to the presence of obstacles, variations in link quality behavior is

2

abrupt. So these factors may not be perfectly modeled as also argued in [19], thus requiring an online approach. The authors in [4] mentioned an online ML technique at the BS which learns about the dynamics of the environment for enabling beam training to prevent blockages. However in this work we aim to learn the dynamics of the environment at the UE locally in a timely manner. To account for the dynamic obstacles locally, partially observable Markov decision process (POMDP) [20]–[22] can be used in modeling the variations in unobserved D2D links. The authors in [23] utilized POMDP to derive an optimal policy which tells the UE locally when to go for exploration after suspending communication on current relay link after successive packet losses. Whereas, in contrast, this work deals with selecting an appropriate relaying UE during the exploration phase locally. The probabilistic model and cost structure are also accordingly different in this work.
In our work, we have investigated the idea of reducing frequency in relay switching and thus average end-to-end (E2E) delay at the expense of additional exploration time during beam alignment. We have modeled the problem as a ﬁnite horizon POMDP. The states are the D2D relay link qualities which are not observable at the current time instant. It can only be observed after receiving the acknowledgements (ACKs) of the probe packets which are sent in order to access a link. Even the ACKs can get lost due to presence of dynamic obstacles. Information about dynamic obstacles are not known at BS a priori and it can only be learned through ACKs of probe packets. The goal is to take decision of whether selecting or not selecting a relay which minimizes packet loss and in-turn delay by sending additional exploration probe packets to learn the channel quality. Optimal threshold policies have been derived which maps the belief to a set of actions. By exploiting the derived policy structure, we have obtained a stationary policy which tells the UE during exploration that after how many successive ACK successes or ACK failures to take the decision of whether selecting or not selecting the relay respectively. Theoretical analysis is validated through extensive simulation. Our major contributions in this paper are summarized as follows:
1) We modeled relay selection problem during the exploration time locally considering the presence of dynamic obstacles as a POMDP. This model can be applied to a scenario without explicitly knowing the dynamic obstacle’s distribution.
2) The model learns the channel quality in an online fashion using ACKs which can also get lost. The model does not require to undergo a training phase and hence suitable when there is a change in the environment.
3) We showed that the optimal policy is threshold type policy. This is a non-trivial result that required proof of several interesting intermediate results. Our optimal policy can be implemented locally at each UE, thereby facilitating distributed implementation.
4) The threshold policy for the problem is further reduced to counting the number of successive ACK successes or ACK failures, which is simple and easy to implement.

II. SYSTEM MODEL

We are considering the device-tier of 5G D2D architecture
mentioned in [24], where devices or UEs can communicate
among themselves with or without the help from BS. The
service region is discretized into various zones or grids as
shown in ﬁgure 2(a) with one BS. Each zone may have many
UEs and is assumed to have at least one D2D device which
is ready to take part in D2D communication as a relay or source/destination node. A zone i containing the source UE may form connection to a UE of another zone j ∈ Ui , where Ui is the viable relay zones of the zone i which is given by the BS. A viable relaying zone of zone i is one which is nearer to the zone containing the destination UE and is in the communication range of the zone i. When the source UE in the ﬁxed zone i forms a connection with another UE of zone j ∈ Ui, then the link formed between zones i and j is termed as link j. Link is formed between UEs of two zones when they are in communication range of each other and the received
signal strength is sufﬁcient for the required data rate. Each
UE can communicate with one another on mmWave channels using directional antennas. The received signal strength (Qij) on zone j from zone i is modeled as [13]:

Qij = µ · P · Gt · Gr · P Lij

(1)

where, µ is the shadowing random variable, P is the transmit power of the UE, Gt & Gr are transmit and receive beamforming gains respectively. P Lij is the distance dependent path loss function between zone i and zone j.
Time is discretized as (nN + l)δ as shown in ﬁgure 2(b), where n belongs to set of nonnegative integers, l takes integer values in [0, N −1], δ is the smaller discretized time slot when the UEs transmit packets locally. It is assumed that δ (for each l ∈ [0, N − 1]) is large enough to send one packet of size L bytes. Here, N is the number of time slots (of δ duration) between two consecutive global decisions by the BS. Global decision by BS is made at time when nN + l is divisible by N . At this time instant BS takes the channel state information from all UEs in the service region and gives the decision of
best relaying UE of a given zone for a given source UE. Hence, in between two consecutive time instants when BS can make global decision, a UE can send at-most N packets of size L to another UE. Note that at time l = 0, the UE chooses the relay link suggested by the BS and at time l ∈ {1, 2, · · · , N − 1}, UEs do not get channel state information from the BS. At
global time instants, BS sends two types of information to UEs, i) the best relaying UE for a given source UE and ii) viable relaying zones Ui for given source zone i, hence the zone i may choose an appropriate zone for relaying data from the set Ui by undergoing exploration.
Exploration: When the current link quality is not good
enough then source UE locally explores for an appropriate
relaying UE from given viable set. One of the basic procedure in the exploration phase involves sequentially searching space
in all directions to align transmitter and receiver beams (beam alignment). The quality of link is piggy-back to the sending
UE. This overall process of beam alignment is termed as
the exploration phase. Any of the state of art approaches

3

Relaying zone Exploration zone nN δ

Zone j Zone i

0 12 δδ

Nδ (n + 1)N δ

··· ···

l

N -2 N -1

(nN + l)δ δ δ

Sending zone

Dynamic obstacles
()
(a)

···

0 12
ǫǫ

V −1

δ

(b)

Fig. 2. (a) Service region divided into zones along with dynamic obstacles. (b) Discretized time slots with exploration time unit.

mentioned in [9] can be applied for the exploration phase. We have considered an abstraction of this phase and thus it is considered as a black box. It is assumed that the beams are perfectly aligned after the exploration phase and thus we focus on the effects of dynamic obstacle’s blockage on a given D2D link. This exploration by source UE in zone i is done for UEs belonging only in the set Ui to ﬁnd out the best relaying zone for that time instant. Note that the UE is using directional mmWave antennas for exploring the neighbors and hence explorations cause some signiﬁcant delay. Each exploration time duration is denoted by ǫ < δ as shown in ﬁgure 2(b). In a given duration δ, we can perform a number of explorations. Each of the time instants during exploration time of duration ǫ is denoted by m ∈ {0, 1, · · · , V − 1}, where V = ⌊δ/ǫ⌋. The overall exploration time is bounded by the maximum value M which can be more than V . It is assumed that once exploration is complete, switching takes negligible time.
There are static and dynamic obstacles in the service region. There is no external facility like radars or vision cameras available at BS to track them. The behavior of dynamic obstacles are not known a priori and need to be learned from the received ACKs of probe packets during exploration phase in an online fashion. Since mmWaves are highly susceptible to obstacles and suffer from severe penetration losses, we assume that even a single moving or static obstacle may break an already established D2D link and can cause packet loss.
III. PROBLEM FORMULATION AS POMDP
Zone i containing source UE forms a link with an UE (relay or destination) of some other zone j ∈ Ui. Global decision for the best relay is given by the BS at the time instant nN δ to relay data packet till (n + 1)N δ time instant. The quality of link given by the BS may deteriorate due to presence of dynamic obstacles resulting in link outage and a new relay link needs to be explored from the viable set Ui locally. A newly found relay link might provide very good data rate initially during exploration phase, but it may gradually deteriorate in future data transmission time because of dynamic obstacles. This problem is subtle due to the fact that exploration time is very small (ranging from few microseconds to 10 ms [7]) in contrast to the data transmission time which is in order of seconds (usually 100-1000 times more than search time). The main idea is to reduce the E2E delay on the cost of sending

additional probe packets till decision of whether selecting or
not selecting a given relay for data transmission considering
dynamic obstacles can be learned. This process is limited upto maximum M exploration time units where each exploration time duration is of ǫ time. If the given relay is not selected within this time then the exploration process again starts for another possible relaying UE in a zone belonging to Ui.
We model this problem of relay selection during exploration
as that of POMDP considering uncertainty in relay link quality.
We will deﬁne the POMDP as follows: For all the possible links j ∈ Ui, the state is written as ymj ∈ {0, 1} for exploration time instant m. Values 1 and 0 signify if relay link j is in good or bad state respectively. Good and bad notion denotes that
whether link will be formed successfully or not respectively. State represented by G and G respectively denote the good and bad state as shown in ﬁgure 3. The action set is deﬁned as {do not select relay link, select relay link, decision cannot be made thus continue sending probe packets}. The ﬁrst action signiﬁes that the current link is bad, hence stop exploring it and
start a new exploration. The second action signiﬁes that the
current link being explored is of good quality, hence choose
it for data transmission. The third action signiﬁes that the
decision of relay selection cannot be made and exploration should continue for another ǫ unit of time to learn the relay link quality. The action is denoted by ajm for link j at time instant m. The link quality is observed by the ACKs of the received probe packet signal. The ACK test for link j at time m is denoted as wmj ∈ {0, 1} for a given state ymj and action ajm, may also be uncertain due to the unpredictable channel condition. In ﬁgure 3, A and A denotes whether ACKs are received successfully or not respectively.
Figure 3 represents the probabilistic structure of the problem
as shown below.

P (wmj = 1|ymj = 1) = k; P (wmj = 0|ymj = 1) = 1 − k

P (wmj = 1|ymj = 0) = g; P (wmj = 0|ymj = 0) = 1 − g

However, note that the ACK piggyback in current time instant will show quality of the channel for probe packet sent in previous time instant. Hence a transition probability of g is introduced above. The probabilistic structure assumed for the system state transition is given below. We have assumed that q > s and k > g which signify respectively that the probability of a link becoming good from previous good state is higher than that of previous bad state and probability of successful ACK from good state is higher than that of bad state.

P

(y

j m

+

1

=

1|ymj

=

1)

=

q;

P

(y

j m

+

1

=

0|ymj

=

1)

=

1

−

q

P

(y

j m

+

1

=

1|ymj

=

0)

=

s;

P

(y

j m

+

1

=

0|ymj

=

0)

=

1

−

s

For a given relaying zone j, let us deﬁne the information

vector available locally to the zone i till time instant m as Hmj = (w0j , w1j, · · · , wmj ). The sufﬁcient statistics or belief [22] (chapter 5) for this problem is deﬁned locally for relaying

zone j as:

rmj

=

P

(y

j m

=

1|Hmj )

(2)

4

q G

k

G

A

(1-k) s (1-q) g

G (1-s) G 1-g A

where w ∈ {0, 1} is a variable denoting ACKs failure/success. Note that the notation wmj deﬁned earlier denotes the ACK failure/success of link j at time instant m, whereas w is used
to denote a general variable for ACK failure/success. We will
derive the optimal policy for this problem in section IV.

Fig. 3. Probabilistic structure of the exploration problem at a UE locally.

This equation gives the probability that a relaying link/zone is in good state given the previous history of information. The estimator function for the local system can be deﬁned as:

rmj +1 = Φ′(rmj , wmj +1).

(3)

Using Baye’s rule we get,

IV. DERIVATION OF THE OPTIMAL POLICY IN EXPLORATION PHASE
A. Properties of Kmj (r) The general expression for time instant m as mentioned in
equation (7), can be written equivalently as:

Kmj (r) = min{rD1, (1 − r)D2, Emj (r)}

(8)

where,

rj = (qrm j +(1H−rm j )s)k ,

if wmj +1 = 1 (4)

m+1

(qrm j +(1−Jrm j )s)(1−k) , if wmj +1 = 0

Emj (r) = cǫ + P (w = 1|r)Kmj +1(Φ′(r, 1))+ P (w = 0|r)Kmj +1(Φ′(r, 0)) (9)

where,

For notation simplicity we will now remove the superscript j

H = (qrmj + (1 − rmj )s)k + (rmj (1 − q) + (1 − rmj )(1 − s))g

from each of the respective notations, e.g., we will write Emj () as Em(). Hence Emj (r) can now be denoted as Em(r). Now

J = (qrmj +(1−rmj )s)(1−k)+(rmj (1−q)+(1−rmj )(1−s))(1−g) equation (9) can be further reduced as:

Cost structure: The cost for stopping the exploration for both cases when link cannot be and can be formed is 0. However, if the link which seems to be good and selected, may become bad in upcoming time instants and thus causes packet loss. So it will incur D1 cost to compensate for the packet loss. Similarly, the link which was bad and not selected could have been a good relay link in upcoming time instants. Then it will incur some cost D2 in order to compensate for further exploration. If decision of relay selection cannot be made in current time instant, then probe packets are sent for another ǫ time unit to continue the exploration. The cost incurred here is cǫ. This will go on till time M which is the upper bound on the exploration time for a single link. The objective is to derive a decision criterion, whether to select or not select the given relay link, or if this decision cannot be made then continue learning the current relay link quality. The expected cost is formulated as a dynamic program. At the end of the (M −1)th period, the expected cost is:

KMj −1(r) = min{rD1, (1 − r)D2}

(5)

where r is a variable denoting belief. For the time instant m = M − 2, we have,

KMj −2(r) = min{rD1, (1 − r)D2, cǫ + E[KMj −1(r)] (6)

where E[·] is the mathematical expectation over the observations. Here the ﬁrst term in minimization expression denotes the expected cost (rD1 + (1 − r)0) incurred when the learning of the current link being explored is stopped since it was in the bad state. The second term denotes the expected cost for selecting the current relay link being explored. The third cost is the expected cost for continuing exploring the current relay link for another round of ǫ unit of time. We can write a general expression as:

Km j (r) = min{rD1, (1 − r)D2, cǫ + E[Km j +1(Φ′(r, w))]}

(7)

Em(r) = cǫ+ (qr + (1 − r)s)k + (r(1 − q) + (1 − r)(1 − s))g Km+1(Φ′(r, 1))+
1 − (qr + (1 − r)s)k + (r(1 − q) + (1 − r)(1 − s))g Km+1(Φ′(r, 0)) (10)
The expected cost for the base case at the end of (M − 1)th period is mentioned in equation (5). We now show some of the properties of Em(r).
Proposition 1. Em(r) is piece-wise linear and concave in r.
Proof. Proof given in Appendix A.
Proposition 2. ∀r ∈ [0, 1],
Em−1(r) ≤ Em(r) ≤ Em+1(r)
Proof. Proof given in Appendix B.
B. Policy Structure
The structure of an optimal policy for our POMDP problem is provided in the following theorem.
Theorem 1. The optimal policy for exploration in POMDP problem is a threshold policy. At any time instant m ∈ {0, 1, · · · , M −1}, the optimal action is to stop exploration on current relay link and start exploring other relay links from Ui if rm ≤ αm, or stop exploration on current relay link and choose it for data transmission if rm ≥ βm, otherwise continue sending probe packet once more on the current relay link which is being explored to check the link quality if αm < rm < βm. Here αm, βm are appropriate constants. Also, we can say for the thresholds: · · · ≥ αm ≥ αm−1 ≥ · · · ≥ α1 and similarly · · · ≤ βm ≤ βm−1 ≤ · · · ≤ β1.
Proof. Proof given in Appendix C.
Using above result, we can say as m → ∞, αm and βm converges to some scalar α and β respectively. This is because

5

βm is bounded below and αm is bounded above. Hence, for very large horizon length M , the optimal policy can be approximated by a stationary threshold policy with a timeinvariant threshold α and β. In this case we can say that at time instant m, if rm ≤ α then stop exploration on current link and start exploring other links from Ui, if rm ≥ β then stop exploration on current link and choose it for data transmission, otherwise if α < rm < β then continue sending probe packet once more on the current link which is being explored to check
the link quality. It is easy to check that Φ(r, w) is a non-decreasing function
in r. Let us denote r0 as the prior belief. We can say that, when prior belief satisﬁes r0 > Φ(r0, w) = r1, then r2 = Φ(r1, 0) < Φ(r0, 0) = r1 and r2 = Φ(r1, 1) < Φ(r0, 1) = r1. Proceeding in this way, we can show that rm strictly decreases with m whenever we observe several successive ACK failures/successes. Similarly, when the prior belief satisﬁes r0 < Φ(r0, w) = r1, then we can say that r2 = Φ(r1, 0) > Φ(r0, 0) = r1 and r2 = Φ(r1, 1) > Φ(r0, 1) = r1. Proceeding in this way, we can show that rm strictly increases with m whenever we observe several successive ACK failures/successes. For getting x successive ACK failures, we can deﬁne recursively a probability πx as: π1 = Φ(r0, A), π2 = Φ(π1, A), · · · , πx = Φ(πx−1, A) with π0 = r0. Similarly, for getting x successive ACK successes, we can deﬁne recursively a probability πx′ as: π1′ = Φ(r0, A), π2′ = Φ(π1′ , A), · · · , πx′ = Φ(πx′ −1, A) with π0′ = r0. Let c and d be the smallest integer such that πc ≤ α and πd′ ≥ β respectively. We can further simplify the stationary threshold
policy as follows.
Corollary 1. Using theorem 1, we can simplify the optimal policy further as follows. Let c and d be the smallest integer such that πc ≤ α and πd′ ≥ β respectively. If there are c successive ACK failures, stop exploring on current relay link being explored and start exploring some other relay link. If there are d successive ACK successes, stop exploring on current relay link being explored and choose it for data
transmission. Otherwise, decision cannot be made and more
probe packets are needed to be sent to learn the link quality.
V. EXPERIMENTS AND RESULTS
Service region of dimension 100 m × 100 m is divided into grid zones each of dimension 10 m × 10 m. We have taken δ = 100 ms and ǫ = 1 ms. UEs are using directional transmitter and receiver antennas for 60 GHz frequency with Gr = Gt = 6 dB. LOS path loss exponent is 2.5 and zero mean log-normal shadowing random variable with standard deviation 3.5 [25], [26]. Thermal noise density is −174 dBm/Hz and devices are using 24 dBm transmit power. Capacity of each link (i, j) is B log2(1+Sij) bits/sec, where B = 20 M Hz [27] is bandwidth and Sij is the received signal to noise ratio. The packet length is ﬁxed and of size 65535 bytes. A source UE in a grid zone i can transmit data to a maximum of 24 grids surrounding it (|Ui| ≤ 24). There are maximum of 16 static and D dynamic obstacles present in these 24 grids surrounding the source UE, where D ∈ {0, 4, 8, 12, 16}. Each static obstacle is placed uniformly

in the service region. Each dynamic obstacles is moving randomly and independently of each other and following a simple blockage model such that with probability 0.5 it will block a given link otherwise it will not block the link. A single source-destination pair is assumed for simplicity and all other devices in a given zone may act as relay. We have written our own C++ custom code and run them on a GNU 4.8 compiler on Intel core i7 machine and average of 1000 runs are taken. The average exploration time and E2E delay for sending 100 packets are the main parameters considered. We have compared our results with the received signal strength (RSS Based) approach which is most commonly used for relay selection during exploration after transmitter and receiver beams are perfectly aligned.
Value of M is derived experimentally in ﬁgure 4. This value should not be too small, otherwise there won’t be sufﬁcient exploration to lead to a decision. Also M should not be too big, otherwise a lot of time would be wasted in exploration. Figure 4 shows the percentage of time the decision could not be made on varying values of M for different D. It is clear that for almost all values of D, decision cannot be made when M is 1 and 2. For D = 16 and M = 3, for around 3.5% of cases decision cannot be made a shown in ﬁgure 5. This ﬁgure shows that with dynamic obstacles, no. of times the decision of relay selection cannot be made, also increases. We have chosen M = 4 for performing further simulations.
Figure 6 shows the effect of dynamic obstacles on percentage of times new relays are explored and switched. With dynamic obstacles, the probability of link breakage increases and thus number of times new relays are explored and switched also increases. Our approach outperforms the RSS based approach because it chooses the link by learning dynamic obstacle’s presence while RSS based approach greedily chooses a link based on best RSS values which might have higher chance of blockage. Figure 7 shows following results: ﬁrst with dynamic obstacles, average E2E delay is increased which follows from previous result of ﬁgure 6. Since higher number of dynamic obstacles will have higher chance of breaking a link and thus causes increase in E2E delay. Similarly, following the argument of previous result of ﬁgure 6, our approach outperforms RSS based approach. Secondly, with dynamic obstacles, average exploration time is increased because higher link breakage with dynamic obstacles would cause more exploration and switching of relays. Here RSS based approach performs better since it always takes one time unit of exploration, whereas our approach takes additional exploration time units to learn the quality of link considering dynamic obstacles. Thirdly, it can be seen from above two results that, average exploration time is higher in our approach at the cost of reducing the cost of average E2E delay signiﬁcantly compared to the RSS based approach. This describes the trade-off of additional exploration time over the average E2E delay.
VI. CONCLUSION
The problem of selecting a given relay during exploration is investigated taking into account presence of dynamic obstacles. We have modeled this problem as a ﬁnite horizon

6

% of times decision cannot be made % of times decision cannot be made % of times relay is explored and switched
Average exploration time (s) Average E2E delay (s)

100 80 60 40 20 0 0

Dynamic Obstacles=4 Dynamic Obstacles=8 Dynamic Obstacles=12 Dynamic Obstacles=16

2

4

6

8

10

M (Max. no. of exploration units)

Fig. 4. M vs % of times no decision can be made

3.5 3
2.5 2
1.5 1
0.5 0 2

Dynamic Obstacles=4 Dynamic Obstacles=8 Dynamic Obstacles=12 Dynamic Obstacles=16

4

6

8

10

M (Max. no. of exploration units)

Fig. 5. M vs % of times no decision can be made when M ≥ 3

70 Proposed RSS based
60

50

40

30

20

10

4

6

8

10

12

14

16

No. of Dynamic Obstacles

Fig. 6. No. of times relay are explored and switched with dynamic obstacles.

0.18 0.16 0.14 0.12
0.1 0.08 0.06 0.04 0.02
4

Exploration (Proposed) Exploration (RSS based) E2E delay (Proposed) E2E delay (RSS based)

6

8

10

12

14

No. of Dynamic Obstacles

7 6.5 6 5.5 5 4.5 4 3.5 3 2.5 16

Fig. 7. Trade-off for average exploration time and average E2E delay.

POMDP framework at each UE. Using this model, an optimal
threshold policy is derived for each UE which is then sim-
pliﬁed to a stationary policy. This policy governs the source
UE to take decisions based on successive ACK failures or
success on the current relay link under exploration. Through
simulations, the trade-off between average exploration time
and E2E delay is shown, where our approach captures the
effects of dynamic obstacles signiﬁcantly compared to the RSS
based approach.
REFERENCES
[1] D. Singh and S. C. Ghosh, “Mobility-aware relay selection in 5g d2d communication using stochastic model,” IEEE Transactions on Vehicular Technology, vol. 68, no. 3, pp. 2837–2849, 2019.
[2] J. Qiao, X. S. Shen, J. W. Mark, Q. Shen, Y. He, and L. Lei, “Enabling device-to-device communications in millimeter-wave 5g cellular networks,” IEEE Communications Magazine, vol. 53, pp. 209–215, January 2015.
[3] G. H. Sim, A. Loch, A. Asadi, V. Mancuso, and J. Widmer, “5g millimeter-wave and d2d symbiosis: 60 ghz for proximity-based services,” IEEE Wireless Communications, vol. 24, pp. 140–145, Aug 2017.
[4] G. H. Sim, S. Klos, A. Asadi, A. Klein, and M. Hollick, “An online context-aware machine learning algorithm for 5g mmwave vehicular communications,” IEEE/ACM Transactions on Networking, vol. 26, no. 6, pp. 2487–2500, 2018.
[5] M. Gapeyenko, A. Samuylov, M. Gerasimenko, D. Moltchanov, S. Singh, M. R. Akdeniz, E. Aryafar, N. Himayat, S. Andreev, and Y. Koucheryavy, “On the temporal effects of mobile blockers in urban millimeter-wave cellular scenarios,” IEEE Transactions on Vehicular Technology, vol. 66, no. 11, pp. 10124–10138, 2017.
[6] Y. Koda, K. Nakashima, K. Yamamoto, T. Nishio, and M. Morikura, “Handover management for mmwave networks with proactive performance prediction using camera images and deep reinforcement learning,” IEEE Transactions on Cognitive Communications and Networking, vol. 6, no. 2, pp. 802–816, 2020.
[7] M. Giordani, M. Mezzavilla, and M. Zorzi, “Initial access in 5g mmwave cellular networks,” IEEE Communications Magazine, vol. 54, no. 11, pp. 40–47, 2016.
[8] H. Soleimani, R. Parada, S. Tomasin, and M. Zorzi, “Fast initial access for mmwave 5g systems with hybrid beamforming using online statistics learning,” IEEE Communications Magazine, vol. 57, no. 9, pp. 132–137, 2019.
[9] M. Giordani, M. Polese, A. Roy, D. Castor, and M. Zorzi, “A tutorial on beam management for 3gpp nr at mmwave frequencies,” IEEE Communications Surveys Tutorials, vol. 21, no. 1, pp. 173–196, 2019.
[10] M. Johnston and E. Modiano, “Wireless scheduling with delayed csi: When distributed outperforms centralized,” IEEE Transactions on Mobile Computing, vol. 17, no. 11, pp. 2703–2715, 2018.
[11] T. Bai and R. W. Heath, “Coverage and rate analysis for millimeter-wave cellular networks,” IEEE Transactions on Wireless Communications, vol. 14, pp. 1100–1114, Feb 2015.
[12] S. Biswas, S. Vuppala, J. Xue, and T. Ratnarajah, “An analysis on relay assisted millimeter wave networks,” in 2016 IEEE International Conference on Communications (ICC), pp. 1–6, May 2016.
[13] N. Wei, X. Lin, and Z. Zhang, “Optimal relay probing in millimeterwave cellular systems with device-to-device relaying,” IEEE Transactions on Vehicular Technology, vol. 65, pp. 10218–10222, Dec 2016.

[14] W. Kim, J. Song, and S. Baek, “Relay-assisted handover to overcome blockage in millimeter-wave networks,” in 2017 IEEE 28th Annual International Symposium on Personal, Indoor, and Mobile Radio Communications (PIMRC), pp. 1–5, Oct 2017.
[15] J. Park and R. W. Heath, “Analysis of blockage sensing by radars in random cellular networks,” IEEE Signal Processing Letters, vol. 25, pp. 1620–1624, Nov 2018.
[16] D. Singh and S. C. Ghosh, “Network-assisted d2d relay selection under the presence of dynamic obstacles,” in 2019 IEEE 44th Conference on Local Computer Networks (LCN), pp. 129–132, 2019.
[17] H. Zhang, S. Chong, X. Zhang, and N. Lin, “A deep reinforcement learning based d2d relay selection and power level allocation in mmwave vehicular networks,” IEEE Wireless Communications Letters, vol. 9, no. 3, pp. 416–419, 2020.
[18] M. Alrabeiah, A. Hredzak, and A. Alkhateeb, “Millimeter wave base stations with cameras: Vision-aided beam and blockage prediction,” in 2020 IEEE 91st Vehicular Technology Conference (VTC2020-Spring), pp. 1–5, 2020.
[19] L. Kong, L. Ye, F. Wu, M. Tao, G. Chen, and A. V. Vasilakos, “Autonomous relay for millimeter-wave wireless communications,” IEEE Journal on Selected Areas in Communications, vol. 35, no. 9, pp. 2127– 2136, 2017.
[20] M. Abu Alsheikh, D. T. Hoang, D. Niyato, H. Tan, and S. Lin, “Markov decision processes with applications in wireless sensor networks: A survey,” IEEE Communications Surveys Tutorials, vol. 17, pp. 1239– 1267, thirdquarter 2015.
[21] K. Kaza, R. Meshram, and S. N. Merchant, “Relay employment problem for unacknowledged transmissions: Myopic policy and structure,” in 2017 IEEE International Conference on Communications (ICC), pp. 1– 7, May 2017.
[22] D. P. Bertsekas, Dynamic Programming and Optimal Control, Vol. I, 4th Edition.
[23] D. Singh, A. Chattopadhyay, and S. C. Ghosh, “Distributed relay selection in presence of dynamic obstacles in millimeter wave d2d communication,” in ICC 2020 - 2020 IEEE International Conference on Communications (ICC), pp. 1–6, 2020.
[24] M. N. Tehrani, M. Uysal, and H. Yanikomeroglu, “Device-to-device communication in 5g cellular networks: challenges, solutions, and future directions,” IEEE Communications Magazine, vol. 52, no. 5, pp. 86–92, 2014.
[25] N. Deng and M. Haenggi, “A ﬁne-grained analysis of millimeter-wave device-to-device networks,” IEEE Transactions on Communications, vol. 65, pp. 4940–4954, Nov 2017.
[26] T. S. Rappaport, G. R. MacCartney, M. K. Samimi, and S. Sun, “Wideband millimeter-wave propagation measurements and channel models for future wireless communication system design,” IEEE Transactions on Communications, vol. 63, pp. 3029–3056, Sep. 2015.
[27] A. Al-Hourani, S. Chandrasekharan, and S. Kandeepan, “Path loss study for millimeter wave device-to-device communications in urban environment,” in Communications Workshops (ICC), 2014 IEEE International Conference on, pp. 102–107, IEEE, 2014.

7

APPENDIX A PROOF OF PROPOSITION 1 We will prove this by ﬁrst showing that Km(r) is piecewise linear and concave for each m using induction. Then we prove our proposition. For time instant (M − 1), we have,
KM−1(r) = min{rD1, (1 − r)D2}
which is piece-wise linear and concave. For time instant (M − 2), we have,
KM−2(r) = min{rD1, (1 − r)D2, EM−2(r)}
where,
EM−2(r) = cǫ + min qr + s(1 − r) kD1, r(1 − q) + (1 − s)(1 − r) gD2 + min qr + s(1 − r) 1 − k D1, r(1 − q) + (1 − s)(1 − r) 1 − g D2}.
This overall equation is also piece-wise linear and concave. Assuming Km+1(r) is piece-wise linear and concave in r,
we can say that for some suitable scalars, η1, η2, · · · , ηn and β1, β2, · · · , βn, Km+1(r) can be written as:
Km+1(r) = min{η1 + β1r, η2 + β2r, · · · , ηn + βnr}. (11)
We can write,
Km(r) = min{rD1, (1 − r)D2, Em(r)}. Expanding above using equation (10), we get:

Km(r) = min rD1, 1 − r D2, cǫ+

rq + (1 − r)s k + r(1 − q) + (1 − r)(1 − s) g ×

Km+1

rq + (1 − r)s k +
rq + (1 − r)s k + r(1 − q) + (1 − r)(1 − s) g

1 − (rq + (1 − r)s)k + (r(1 − q) + (1 − r)(1 − s))g ×

rq + (1 − r)s 1 − k Km+1 1 − ((rq + (1 − r)s)k + (r(1 − q) + (1 − r)(1 − s))g) .
(12)

Let us substitute Y for ((rq + (1 − r)s)k + (r(1 − q) + (1 − r)(1 − s))g) to simplify the calculations. Now using equation (11), the equation (12) is reduced as:

Km(r)=min rD1, (1 − r)D2, cǫ+

(qr + s(1 − r))k

Y min η1 + β1

Y

,

(qr + s(1 − r))k

(qr + s(1 − r))k

η2 + β2

Y

, · · · , ηn + βn

Y

+

(qr + s(1 − r))(1 − k)

(1 − Y ) min η1 + β1

(1 − Y )

, η2+

(qr + s(1 − r))(1 − k)

β2

(1 − Y )

,··· ,

(qr + s(1 − r))(1 − k)

ηn + βn

(1 − Y )

(13)

We can further reduce above equation as:

Km(r)=min rD1, (1 − r)D2, cǫ + min{(Y )η1+ β1(qr + s(1 − r))k, (Y )η2 + β2(qr + s(1 − r))k, · · · ,
(Y )ηn + βn(qr + s(1 − r))k} + min{(1 − Y )η1+ β1(qr + s(1 − r))(1 − k), (1 − Y )η2 + β2(qr + s(1 − r))(1 − k),
· · · , (1 − Y )ηn + βn(qr + s(1 − r))(1 − k)} (14)
This is again piece-wise linear and concave in r. Thus the induction is complete.
Now we will show that Em(r) is also piece-wise linear and concave in r:
Em(r) = cǫ+(Y )Km+1(Φ′(r, 1))+(1−Y )Km+1(Φ′(r, 0)) (15)
The ﬁrst term cǫ is constant. For the next two terms (Y )Km+1(Φ′(r, 1)) and (1 − Y )Km+1(Φ′(r, 0)), by expanding them using equation (11), we get,

(Y )Km+1(Φ′(r, 1)) + (1 − Y )Km+1(Φ′(r, 0)) =

(qr + s(1 − r))k

(qr + s(1 − r))k

(Y ) min η1 +β1

Y

, η2 +β2

Y

,

(qr + s(1 − r))k

· · · , ηn + βn

Y

+ (1 − Y ) min η1+

(qr + s(1 − r))(1 − k)

(qr + s(1 − r))(1 − k)

β1

1−Y

, η2 + β2

1−Y

,

(qr + s(1 − r))(1 − k)

· · · , ηn + βn

1−Y

(16)

We can reduce above to:

(Y )Km+1(Φ′(r, 1)) + (1 − Y )Km+1(Φ′(r, 0)) = min η1(Y )+β1(qr+s(1−r))k, η2(Y )+β2(qr+s(1−r))k, · · · ,
ηn(Y ) + βn(qr + s(1 − r))(1 − k) + min η1(1 − Y )+ β1(qr+s(1−r))(1−k), η2(1−Y )+β2(qr+s(1−r))(1−k), · · · ,
ηn(1 − Y ) + βn(qr + s(1 − r))(1 − k) . (17)

Since minimum of ﬁnite number of concave function is concave, Em(r) is piece-wise linear and concave in r.

APPENDIX B PROOF OF PROPOSITION 2
We will ﬁrst prove Km(r) ≥ Km+1(r), then we will use this to prove Em(r) ≥ Em+1(r). First we start for base case m = M − 1 and the ﬁrst term in recursion m = M − 2:
KM−1(r) = min{rD1, (1 − r)D2}
and
KM−2(r) = min{rD1, (1 − r)D2, EM−2(r)}
respectively. We can easily see that KM−1(r) ≥ KM−2(r). We now prove it for ﬁrst two terms of the recursion KM−2(r)

8

and KM−3(r). Let’s denote Y = (rq + (1 − r)s)k + (r(1 − q) + (1 − r)(1 − s))g, we can write KM−3(r) as:
KM−3(r) = min{rD1, (1 − r)D2, cǫ + (Y )KM−2(Φ′(r, 1))+ (1 − Y )KM−2(Φ′(r, 0))}
≤ min{rD1, (1 − r)D2, cǫ + (Y )KM−1(Φ′(r, 1))+ (1 − Y )KM−1(Φ′(r, 0))}
= KM−2(r)

D1 D2 D1 +D2
Cost: Km(r) cǫ
(0,0)

KM −1 (r) EM −2 (r) EM −3 (r)
βM −3 αM−2 (ρ,0) βM−2 (1,0)
Belief (r)

D1 D2 D1 +D2

Cost: Km(r) cǫ

KM −1 (r)

EM −2 (r) EM −3 (r) EM −3 (r0 )

(0,0)

αr0

βr0

(ρ,0)

Belief (r)

(1,0)

Hence KM−2(r) ≥ KM−3(r). Similarly it proceeds for other m and hence Km+1(r) ≥ Km(r). Now let us see this for Em(r) using previous proof for Km(r):

(a)

Cost

structure

when

EM −2 (r)

<

D1 D2 D +D

1

2

(b)

Cost

structure

when

EM −2 (r)

>

D1 D2 D +D

1

2

Fig. 8. Cost structure of the problem for two cases.

Em(r) = cǫ + (Y )Km+1(Φ′(r, 0)) + (1 − Y )Km+1(Φ′(r, 0)) (18)
≤ cǫ + (Y )Km+2(Φ′(r, 0)) + ((1 − Y )Km+2(Φ′(r, 0)) (19)

= Em+1(r)

(20)

Hence Em+1(r) ≥ Em(r).

this for other instants m that αm ≤ αm+1 and βm ≥ βm+1. Hence we can say that with respect to m:
· · · ≥ αm ≥ αm−1 ≥ · · · ≥ α1 and similarly
· · · ≤ βm ≤ βm−1 ≤ · · · ≤ β1.

APPENDIX C PROOF OF THEOREM 1
For the last time period M − 1, there exists ρ = D1D+2D2 such that stop exploration on current link and start exploring other links from Ui if r < ρ, otherwise stop exploration on current link and choose it for data transmission if r ≥ ρ. At ρ, KM−1(ρ) attains it maximum value of DD12+DD12 .
For general time instants m, we can say that Em(0) > cǫ and Em(1) > cǫ. Using this fact, proposition 1 and proposition 2, we can say that if for some r′, EM−2(r′) < DD12+DD12 , then EM−2(r) and subsequent Em(r) will intersect min{rD1, (1− r)D2} at two points. Hence we can say that for general time instant m we will get an optimal policy as: stop exploration on current link and start exploring other links from Ui if rm ≤ αm, or stop exploration on current link and choose it for data transmission if rm ≥ βm, otherwise continue sending probe packet once more on the current link which is being explored to check the link quality if αm < rm < βm. Here αm and βm are found by satisfying the corresponding equations: αmD1 = Em(αm) and (1 − βm)D2 = Em(βm).
If for all r′, EM−2(r′) > DD12+DD12 , then terms rD1 and (1 − r)D2 will contribute to the single threshold ρ which is trivial for time instant M − 2 due to proposition 1. In this case, using proposition 1 and proposition 2 one can have either single or two thresholds for other time instants m depending upon whether Em(r) intersects min{rD1, (1 − r)D2} at two or no points as shown in ﬁgure below.
For the second part, using proposition 2 and if EM−2(ρ) < DD12+DD12 , we can say that αM−2 < ρ < βM−2. This is easy to see because KM−1(r) ﬁrst increases till ρ and then decreases. Also,
KM−1(r) ≥ KM−2(r) = min{KM−1(r), EM−2(r)}
and αM−1 = βM−1 = ρ. Hence, αM−2 ≤ αM−1 and βM−1 ≤ βM−2. Similarly, using proposition 2 we can say

