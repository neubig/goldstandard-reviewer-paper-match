Cell planning for mobility management in heterogeneous cellular networks
Arpan Chattopadhyay, Bartłomiej Błaszczyszyn, Eitan Altman

arXiv:1605.07341v1 [cs.NI] 24 May 2016

Abstract—In small cell networks, high mobility of users results in frequent handoff and thus severely restricts the data rate for mobile users. To alleviate this problem, we propose to use heterogeneous, two-tier network structure where static users are served by both macro and micro base stations, whereas the mobile (i.e., moving) users are served only by macro base stations having larger cells; the idea is to prevent frequent data outage for mobile users due to handoff. We use the classical two-tier Poisson network model with different transmit powers (cf [1]), assume independent Poisson process of static users and doubly stochastic Poisson process of mobile users moving at a constant speed along inﬁnite straight lines generated by a Poisson line process. Using stochastic geometry, we calculate the average downlink data rate of the typical static and mobile (i.e., moving) users, the latter accounted for handoff outage periods. We consider also the average throughput of these two types of users deﬁned as their average data rates divided by the mean total number of users co-served by the same base station. We ﬁnd that if the density of a homogeneous network and/or the speed of mobile users is high, it is advantageous to let the mobile users connect only to some optimal fraction of BSs to reduce the frequency of handoffs during which the connection is not assured. If a heterogeneous structure of the network is allowed, one can further jointly optimize the mean throughput of mobile and static users by appropriately tuning the powers of micro and macro base stations subject to some aggregate power constraint ensuring unchanged mean data rates of static users via the network equivalence property (see [2]).
Index Terms—Heterogeneous network, small cells, Poisson routes, mobility, handoff, cell planning, spectral efﬁciency, throughput, resource allocation, stochastic geometry.
I. INTRODUCTION
The proliferation of high-speciﬁcation handheld/mobile devices such as smartphones and tablets has led to unprecedented growth in cellular trafﬁc over the past few years, and is expected to grow continuously even further. These devices are often equipped with 3G or 4G communication capabilities, and are able to run applications such as video streaming or downloading, image or media ﬁle transfer via e-mail, social networking applications, and access to several cloud services. In order to meet the enormous bandwidth demand for these applications, the use of small cell networks (see [3]) assisted by macro base stations (see [4], [5], [6], [7]) have recently become popular; the major idea behind such heterogeneous network architecture is that the small cells (such as femtocells and picocells) can meet the bandwidth demand of the users, while the macro base stations provide cellular coverage.
Arpan Chattopadhyay and Bartłomiej Błaszczyszyn are with Inria/ENS, Paris, France. Eitan Altman is with Inria, Sophia-Antipolis, France. Email: arpan.chattopadhyay@inria.fr, Bartek.Blaszczyszyn@ens.fr, eitan.altman@sophia.inria.fr

Small cell networks (e.g., picocell networks) can provide high throughput to the static users, but may signiﬁcantly deteriorate the performance of mobile (i.e., moving) users. Indeed, very high mobility of users in small cell networks result in frequent handoff at cell boundaries, thereby resulting in potentially huge signaling overhead (see [8], [9], [10]) among the base stations and mobile users. In case of hard handoff, the existing connection to the base station is terminated before the connection to a new base station is established. As a result of this and the signaling overhead, during some short time period for each hard handoff, the mobile user is not able to receive any data from the base station ([11, Section 3] says that a moving user requires some ﬁxed amount of communication with the base stations for each handoff; this can be modeled as a temporary outage for the desired data transmission). This happens even if we assume that every hard handoff attempt is successful, i.e., the target cell can always accommodate a new handoff request.1 In case of soft handoff, the mobile user maintains connection to more than one base stations during the handoff period (which is a signiﬁcant amount of time), thereby reducing the spectral efﬁciency (apart from the throughput loss due to signaling overhead). As a consequence, if the mobility of users is very high and/or network cells are too small, then a signiﬁcant loss in average data-rate can be experienced by the mobile users. A solution to the data outage problem (due to hard handoff) is predictive channel reservation as described in [12], where handoff requests are sent to adjacent cells when the mobile users reach within a given distance of the cell boundary depending on rather complicated user location and velocity estimation 2. This idea is useful in preventing the temporary data outage due to handoff, but it is unable to address the problem of frequent handoff and consequently huge signaling overhead rate due to high mobility of users.
As a solution to the above problem, we propose to use a heterogeneous network architecture, where only macro base stations can serve the mobile users; the relatively large cell size of the macro base stations result in a much smaller handoff rate in this architecture. However, macro base stations are less power-efﬁcient as compared to micro base stations, and micro base stations provide high throughput to the static users. Clearly, there is a trade-off between the fraction of macro and micro base stations to be chosen by the network service provider, and also between the transmit power levels at which these two classes of base stations should operate. In this paper, under certain modeling assumptions, we provide a stochastic
1LTE does not use any soft handoff. 2GPS tracking of users is not allowed by the legislation of some countries.

2

geometry framework which can be used to ﬁnd the optimal fraction of macro base stations and the transmit power levels of macro and micro base stations, as a function of the densities of static and mobile users and the velocity of mobile users. Our main ﬁndings in this matter are as follows.
• In a homogeneous network scenario, if the product of the mobile user speed, handoff time and the square root of the network density is large then it is advantageous to let the mobile users connect only to some fraction of base stations to reduce the frequency of handoffs during which their data-rate drops down. Obviously too small such fraction will result is low data rate due to large distance from base stations. Our model allows us to calculate the optimal value of this fraction in function of mobile speed and other network parameters.
• If a heterogeneous structure of the network is allowed, it is possible to further optimize the mean throughput of mobile and static users; a good compromise between the performance of static and mobile users is obtained by appropriately choosing the transmit power levels and densities of macro and micro base stations.
A. Related Work
There has been a lot of work in the literature on the impact of mobility of users in wireless networks. In fact, the authors in [13] have shown that mobility increases the capacity of ad-hoc networks. [14] deals with the trade-off of delay and throughput in ad-hoc networks in presence of mobility. The authors of [15], [16], [17], [18] discuss the impact of inter and intra cell mobility on capacity, ﬂow level performance and the trade-off between throughput and fairness; these results show that mobility increases the capacity of cellular networks when base stations interact among themselves, since the cooperation among base stations allows the users to improve performance from multi-user diversity, opportunistic scheduling etc.
However, in practice, handoff results in an outage in connection and high signaling overhead, which none of the mentioned references care about. As a result, researchers have recently focused on analyzing the impact of user mobility on call block and call drop probabilities and optimal cell size in picocell networks deployed on a line; see [19], [11], [20].
Unlike these papers, we consider a macro-assisted small cell network on the two-dimensional plane where only macro base stations are allowed to serve the mobile users; our goal is to choose the network design parameters in such a way that the time-average of a linear combination of the rates of static and mobile users is maximized, depending on the handoff duration and user velocity. Handoff control by macro-assisted small cell networks has been proposed before (see [21], [7]), but no indepth mathematical analysis was provided that can be used as a guideline to choose network design parameters such as the density of macro base stations and transmit power levels of the two classes of base stations.
B. Our Contribution
Our contributions in this paper are summarized as follows:

• In stochastic geometric analysis of Poisson multi-tier network, Theorem 1 provides a simpliﬁed expression for the SIR coverage probability by one tier for the whole domain of SIR. It is based on the explicit evaluation of the integral function In,β(·) deﬁned in [22, Equation (13)] and capturing the impact of the noise, when this latter has the distribution of a Poisson-shot noise variable (here the interference from the non-serving tier). 3 This expression is used to evaluate and optimize the (static and mobile) user mean downlink bit-rates.
• We provide explicit or integral expressions for several primitive characteristics of the two-tier Poisson network with Poisson-line road system, including mean areas of different types of zero-cells (cells covering the origin; they are statistically larger than the respective typical cells), mean number of static and mobile users served in these cells, the intensity of cell boundary crossings (handoffs) for a user traveling along a given line. We believe these expressions are new to the wireless literature.
• Using the above expressions we evaluate and optimize (over the densities and transmit power levels of the macro and micro base stations) the mean throughput of static and mobile users, the latter accounted for handoff outage periods. The mean throughput of a typical (static or mobile) user is deﬁned as the mean bit-rate of this user divided by the mean number of all users co-served by the same station.
C. Organization
The rest of the paper is organized as follows. A two-tier Poisson network model with Poisson-line route system for stochastic geometric analysis of the performance of static and mobile users is provided in Section II. In Section III, using this model, we evaluate the mean data rate and throughput of the typical mobile and static user. Next, in Section IV we formulate and solve the problem of the optimal network design with respect to these performance metrics of static and mobile users. Finally, we conclude in Section V. All proofs are provided in the appendix.
II. HETEROGENEOUS POISSON NETWORK MODEL WITH POISSON ROAD SYSTEM
A. System Assumptions
In this paper, we consider radio part of the downlink trafﬁc in a network consisting of two types of base stations (BSs) using constant but possibly different powers. The coverage in the network is ensured by macro stations which typically transmit with larger powers. Micro stations, which typically transmit with smaller powers, are used to meet the capacity request. Both types of BSs transmit over the entire available bandwidth. The above assumptions are satisﬁed e.g. for practical cellular network, such as LTE networks.
We consider also two types of users: static and mobile ones, the latter moving along some road system with constant
3The numerical evaluation of the original integral In,β (·) is quite tricky, as reported in [23].

3

velocity. We think, for example, of a urban or suburban road system with users sitting in moderately fast moving cars and downloading contents from the base stations. In general, all users are served by the respective BSs received with the strongest powers. However mobiles users, which are subject to handoff procedures when changing the serving stations, are allowed not to connect to micro BSs, the goal being to reduce the handoff frequency. During the handoff event, which takes some ﬁxed time, the quality of the mobile users connection drops down (in particular due to more heavy signaling) or even suffers a temporary outage period. We assume that the applications being run in the user ends are enough delay tolerant and that they resume perfectly once the communication with a new base station is established immediately after handoff is over.
Regarding the radio channel assumptions, we consider interference limited scenario, where the peak data rate available at any location is limited by the interference from the base stations not serving this location. Again this is a reasonable scenario for urban and suburban environment.

Fig. 1. Two-tier heterogeneous network with straight line route system. Statics users are distributed everywhere, whereas mobile users are moving along the routes. The blue circles correspond to macro BSs, and the tiny dots correspond to micro BSs. The regions around the micro BSs correspond to the regions where a micro BS sends the strongest signal. The Voronoi tessellation is generated solely by the process Φmacro. Static users are shown using human symbols, and the mobile users (moving along straight lines) are shown using car symbols.

B. Two Tier Network Model
We consider a heterogeneous network (hetnet) model composed of two tiers of base stations (BSs) modeled by two independent Poisson point processes, Φmacro and Φmicro of intensity pλBS and (1 − p)λBS, respectively, where p ∈ [0, 1] is the fraction of macro BSs. Macro and micro BSs transmit with constant but possibly different powers Pmacro, Pmicro respectively. It is natural to assume Pmacro > Pmicro. These powers, together with p, are network design parameters subject to some network equivalence condition that will be explained in Section II-G. Note that the superposition of two tiers Φ := Φmacro + Φmicro forms a Poisson point process of intensity λBS and p is the fraction of BSs which are macro stations. We will denote the locations of BS in the two tiers by Φ = {Xi}, Xi ∈ R2, with arbitrary, countable labeling of BSs by index i.
C. Static Users and Mobile Users on the Routes
We consider two classes of users. Locations of static users (SU) are modeled by points of a Poisson point process Ustatic of intensity λSU . Mobiles users (MU) are moving with same constant speed v on a system of directed routes modeled by straight lines of a directed homogeneous Poisson line process L on the plane, of intensity λL that corresponds to the mean total length of routes per unit of surface, (see [24, Chapter 8]). We assume that, given a realization of the Poisson line process, at time instant t = 0, MUs form a Poisson point process Umobile on L of intensity λMU MUs per unit of route length. 4 This means, in particular, that any two successive MUs on any line of L are separated by a distance having exponential distribution with mean 1/λMU . Moreover, constant mobility of MUs implies that at any time instance t the relative locations (and hence distribution) of MUs on the lines of L remain
4More formally, the process Umobile is a doubly stochastic Poisson point process with random intensity λMU L.

unchanged. Also, one observes MUs crossing any point of a line according to a time homogeneous Poisson process with rate λMU v. We assume that all processes Φmacro, Φmicro, Ustatic and Umobile are independent. A sketch of the network model with the both types of users is depicted in Figure 1.
D. Downlink Wireless Channel Model
The path-loss at a distance r from a BS is given by (Ar)β, where A > 0 and β > 2 are two constants. We ignore all random propagation effects (fading, shadowing) in the channel. Moreover, we focus on the interference limited regime ignoring any thermal noise at the user receivers.
E. Downlink Service Discipline
Static users are served by the respective BSs in Φ which are received with the strongest power 5. This means that a static user located at x on the plane is served by the station Xi ∈ Φ which maximizes the value Pi(A|Xi − x|)−β, where Pi = Pmacro if Xi ∈ Φmacro and Pi = Pmicro if Xi ∈ Φmicro. Mobile users are served only by macro BSs in Φmacro, with the choice of the serving station also based on the stronger received power. Due to constant power emitted by macro BSs, this is equivalent to saying that mobile users are served by the respective closest macro BS.
For any micro or macro BS, by its hetnet cell we call the subset of the plane where this station serves static users. For macro BSs, besides their hetnet cells, we consider also macro cells; these are Voronoi cells generated by Φmacro (ignoring Φmicro), where the macro BSs serve mobile users. Note that the hetnet cells generated by the macro BSs are subsets of the respective macro (Voronoi) cells of these BSs. Also, if Pmacro > Pmicro then the hetnet cells of macro BSs are
5With any tie-breaking rule; in fact the probability that a user receives the same power from two or more different stations of Φ is null.

4

statistically larger than the hetnet cells of the micro BSs. This situation is depicted via Figure 1.
F. Handoff in the Network
As a MU moves along a line l ∈ L, it traverses across various macro cells (Voronoi cells generated by Φmacro). On the macro cell boundaries, one macro BS has to hand over the MU to the BS of the neighboring cell; this event is called handoff. We assume in this paper that handoff is always successful (we will discuss in the conclusion how the possibility of handoff failure due to overload in the target cell can be taken care of in our current framework). However, a signiﬁcant signaling involved during the handoff seriously affects the (downlink) transmission rate during the handoff (see [11, Section 3]; a MU requires some ﬁxed amount of signaling/overhead communication with the base stations for each handoff). In case of hard handoff, the existing connection to the base station is terminated before the connection to a new base station is established. As a result of this and the signaling overhead, during some short time period for each hard handoff, the mobile user is not able to receive any data from the base station. In case of soft handoff, the mobile user maintains connection to more than one base stations during the handoff period, thereby reducing the spectral efﬁciency (apart from the throughput loss due to signaling overhead). In order to account for the throughput loss due to handoff in a simpliﬁed way, we assume that during handoff, the MU is not able to receive any data from either of the two neighbouring base stations for a constant time Th.
Note that MUs do not stop, but keep moving with the usual speed v during the handoff event. Again for simplicity, we assume that the segment of the line l (of length vTh) traversed during the handoff period is bisected by the traversed cell boundary.
Note that, if the density of macro BSs is high (and therefore the macro cells sizes are small) with respect to the MU speed v, then frequent handoff events have serious detrimental effect on the average downlink data rate of MUs. The reason that we allow only the macro base stations to serve the MUs is to reduce handoff rate by using only large cells for MUs. The goal of the hetnet optimization in p, Pmacro, Pmicro considered in Section IV is to optimize the performance of the MUs while (at least) preserving the performance of the static users.

users experience the same mean service characteristics based on the collection of powers they receive from all macro and micro stations as in the equivalent homogeneous network. 6
III. PERFORMANCE EVALUATION OF THE HETEROGENEOUS NETWORK
In what follows we shall evaluate the performance of mobile and static users in our hetnet model. We consider mean bit rates of a single, typical SU or MU, the latter accounted for handoff outage events. For both types of users, we also consider the mean throughput, which is deﬁned as the mean peak bit rate divided by the mean number of all (static and mobile) users served by the station serving the typical user. The above performance metrics are subject to network design optimization in Section IV.

A. Downlink Bit Rate of Mobile Users
Denote by X∗ the macro BS that is closest to the origin; it is the BS serving the typical MU present at the origin of the plane. Denote by E[Rmacro(0)] the mean downlink (Shannon) bit-rate7 at the origin from X∗, where Rmacro(0) = log2(1 + SIRmacro(0)) , with

SIRmacro(0) :=

Pmacro(A|X∗|)−β , Xi∈Φ,Xi=X∗ Pi(A|Xi|)−β

where Pi = Pmacro if Xi ∈ Φmacro and Pi = Pmicro if

Xi ∈ Φmicro. Observe that MUs treat the power received

form micro BSs as noise. We have

∞

E[Rmacro(0)] =

P{SIRmacro(0) > (2t − 1)} dt (2)

0

and the distribution of SIRmacro(0) is the subject of the
following result. Theorem 1: For any τ > 0, we have:

P(SIRmacro(0) > τ )

1 τ

− 2n

=

(−1)n−1

τ

β

τ

Jn,β

n=1 1 − (n − 1)τ

1 − (n − 1)τ

2

β

2

n

(1 − p)Pmβicro −n

×× 2

βΓ(1 − 2 )Γ(1 + 2 )

1+

2

β

β

pPmβacro

where Jn,β(x) is deﬁned in Appendix A, Subsection A (taken from [22, Equation (16)] with x1 = x2 = · · · = xn = x). In particular, for τ ≥ 1, we have:

G. Network Equivalence

When optimizing the network design in p, Pmacro, Pmicro, we will consider the following constraint

pPm2/aβcro + (1 − p)Pm2/iβcro = P 2/β ,

(1)

where P is some given ﬁxed transmission power. Condition (1) ensures that the interference ﬁeld over R2 generated by the hetnet will have the same marginal distributions as the homogeneous Poisson network of density λBS, where each base station transmits at ﬁxed power P . For details, see the notion of equivalent homogeneous network as explained in [2, 22]. The equality of the marginal distributions means that all static

2

2

2

2

(1 − p)Pmβicro −1

P(SIRmacro(0) > τ ) = τ β Γ(1− )Γ(1+ ) 1+

2

.

β

β

pPmβacro

Proof: See Appendix A, Subsection B.

Remark 1: 1) Under the equivalent network tion (1), we have:

2

2

1 + (1 − p)Pmβicro = P β .

2

2

pPmβ acro

pPmβ acro

condi-

6Note that the constraint (1) is different from the constraint on the mean
transmit power per base station pPmacro + (1 − p)Pmicro = P . 7In fact it is the spectral efﬁciency, i.e., the bit-rate per unit of bandwidth.

5

2) In case of homogeneous network Pmacro = Pmicro = P with only a fraction p of stations potentially serving the origin, the above quantity becomes equal to 1/p. Then, for τ ≥ 1, the probability P(SIR > τ ) increases linearly in p.
3) Further assuming p = 1 one obtains the coverage probability in the so called equivalent homogeneous network. It is equal to the coverage probability of the typical static user connecting to the strongest station (macro or micro) in the hetnet, cf. Section III-D.
Remark 2: By the ergodicity of the model, the expectation E[Rmacro(0)] is equal almost surely to the sample average data rate along any line of the Poisson line process L. See Appendix A, Subsection C for more explanations.

B. Accounting for handoff

Note that E[Rmacro(0)] does not account for the handoff outage events. An exact way of taking into ac-

count this latter phenomenon would require calculating E0MU [Rmacro(0)1(0 not in handoff)] (where E0MU is the expectation w.r.t. the Palm probability that a mobile user is

located at the origin), which is not amenable to explicit

analysis, in particular because of the dependence between Rmacro(0) and the event {0 not in handoff}. Regarding the handoff probability we have the following bound that involves

the intensity

√ λc = 4 λBSp
π

of crossings of a ﬁxed straight line with the boundaries of
the macro cells, which are Voronoi cells of Φmacro, cf [25, Equations 5.7.4 with m = 2] 8.
Lemma 1: P0MU {0 not in handoff} ≥ (1 − λcvTh). Proof: See Appendix A, Subsection D.

The above bound is meaningful only for λcvTh smaller than 1 and tight when it is close to 0. With the above precautions, for

the sake of analytical tractability, we will consider the product (1 − λcvTh)E[Rmacro(0)] as a substitute for the typical MU bit-rate accounted for handoff outage.

C. Accounting for Other Users — Mean Throughput of MUs
The expression (1 − λcvTh)E[Rmacro(0)] is only the mean bit-rate of a single MU served by X∗ and does not account for the fact that X∗ needs to share its resources with other MUs and SUs.
In order to account for the rate sharing with other users, denote by Vmacro(0) the macro cell of X∗, and by |Vmacro(0)| the area of this macro cell. This is the macro cell (generated by Φmacro alone) covering the origin; cf Figure 2 left. Following standard stochastic geometric terminology we call it zero macro cell. By N MU,macro := E0MU [|Umobile(Vmacro(0))|] we denote the mean number of MUs present in this zero macro cell under the Palm distribution for MUs (i.e., given the typical MU at the origin).
8Since Φmacro is motion invariant, λc is invariant with respect to the choice of the ﬁxed line.

Fig. 2. Left: The macro BS X∗ closest to the origin and its macro-cell, called zero-macro cell. Right: the hetnet cell of X∗. Note it is not necessarily the hetnet cell covering the origin.
Moreover, let Vhet(X∗) be the hetnet cell of X∗; cf Figure 2 right. Note, it is not necessarily the hetnet cell covering the origin. This is the region where all SUs receive the service from the macro BS X∗ serving the typical MU present at the origin. Let N SU,macro := E0MU [|Ustatic(Vhet(X∗))|] be the mean number of SUs present in the hetnet cell of X∗ under the Palm distribution for MUs. Note that, by the independence of Umobile, Ustatic, Φmacro and Φmicro, we can replace E0MU here simply by E.
We have the following results regarding the two mean number of users.
Theorem 2: The mean number of MUs served by the macro BS serving a typical MU located at the origin is given by:
N M U,macro = 1 + 1.2λ8B0S2pλL + π√3.λ2B16S p λM U . Proof: See Appendix A, Subsection E.
For any two points (x1, x2) and (y1, y2) on R2, we deﬁne r0 := ( PPmicro ) β1 y12 + y22 and A((x1, x2), (y1, y2)) as the
macro
area of the union of two circles with centers at (x1, x2) and (y1, y2) and radii x21 + x22 and y12 + y22 respectively.
Theorem 3: The mean number of SUs served by the macro BS serving a typical MU located at the origin is given by:
N SU,macro
= λSU λBS p
(x1,x2)∈R2 (y1,y2)∈R2
e−λBS pA((x1,x2),(y1,y2))−λBS (1−p)πr02 dx1dx2dy1dy2
Proof: See Appendix A, Subsection F. The two mean number of users allow us to deﬁne the mean MU throughput as
rMU := (1 − λcvTh)E[Rmacro(0)] . (3) N SU,macro + N M U,macro
1) An approximation for N SU,macro: Since the expression for N SU,macro in Theorem 3 is not easy for numerical computation, we approximate it by the expected number of static users served by a typical macro BS in the heterogeneous network λSU E0macro[|Vhet(0)|], where E0macro denotes expectation w.r.t. the Palm probability distribution given that a macro BS is located at the origin. We denote this approximation by NˆSU,macro.
Theorem 4: NˆSU,macro := λSU E0macro[|Vhet(0)|] =

× . pPm 2/aβcro
pPm 2/aβcro +(1−p)Pm 2/iβcro

λSU λBS p

Proof: See Appendix A, Subsection G.

Theorem 5: NˆSU,macro ≤ N SU,macro.

Proof: See Appendix A, Subsection H.

2) An upper bound for N SU,macro: Theorem 6: N SU,macro ≤ 1.2λ8B02SλpSU .
Proof: See Appendix A, Subsection I.

6
Fig. 3. Zero hetnet cell; it may be a macro cell (left) or a micro cell (right). It serves a typical SU at the origin.

D. Downlink Throughput of Static Users

Following the same line of thought as for MUs, we denote by
E[Rhet(0)] = E[log2(1 + SIRhet(0))]

the mean downlink bit-rate at the origin from the base station whose hetnet cell is serving the origin;

SIRhet(0) :=

maxi Pi(A|Xi|)−β . Xi∈Φ Pi(A|Xi|)−β − maxi Pi(A|Xi|)−β

Here Pi ∈ {Pmicro, Pmacro} is the transmit power from the base station located at Xi ∈ Φ. We consider E[Rhet(0)] as the peak bit-rate of the typical SU.

When the condition (1) is satisﬁed, by the network equiv-

alence principle, cf [2, 22], E[Rhet(0)] = E[Requivalent(0)] where this latter expectation corresponds to E[Rmacro(0)] in the one-tier network consisting of only macro BS of intensity

λBS and using transmit power P . Thus E[Requivalent(0)] can be evaluated using the expressions in Theorem 1 with p = 1

and Pmicro = Pmacro = P , cf. Remark 1.

In order to account for the resource sharing let Vhet(0) be the zero hetnet cell, i.e., the cell of the (macro or micro) BS

that serves a typical SU when present at the origin; cf Figure 3.

Denote by N SU,het := E0SU [|Ustatic(Vhet(0))|] (| · | denotes the cardinality of the set here) the mean number of SUs present

in the zero hetnet cell under the Palm distribution for SUs.

Let N MU,het := E0SU [|Umobile(Vmacro(0))|1(Vhet(0) = Vhet(X∗))] be the mean number of MUs present in the zero macro cell under the Palm distribution for SUs, provided the

BS serving the hetnet cell covering the origin is a macro BS.

Note that these are mobile users sharing the service with the

typical SU at the origin. Note that, by the independence of Umobile, Ustatic, Φmacro and Φmicro, we can replace E0SU here simply by E.

In order to express these two mean numbers denote

by B((x1, x2), (y1, y2)) the area of the union of two

circles with centers at (x1, x2) and (y1, y2) and radii

( ) Pmicro

1 β

P

x21 + x22

and

( ) Pmicro

1 β

P

y12 + y22 respectively.

macro

macro

The function D((x1, x2), (y1, y2)) is deﬁned as the area of

the union of two circles with centers at (x1, x2) and (y1, y2)

and radii ( PPmacro ) β1

x21 + x22

and

( ) Pmacro

1 β

P

y12 + y22 re-

micro

micro

spectively.

Theorem 7: The mean number of SUs served by the (macro or micro) BS serving a typical SU located at the origin is given

by:

N SU,het = 1 +

λSU λBS p

e−λBS pA((x1,x2),(y1,y2))

(x1 ,x2 ,y1 ,y2 )∈R4

×e−λBS (1−p)B((x1,x2),(y1,y2))dx1dx2dy1dy2

+λSU λBS (1 − p)

e−λBS (1−p)A((x1,x2),(y1,y2))

(x1 ,x2 ,y1 ,y2 )∈R4

×e−λBS pD((x1,x2),(y1,y2))dx1dx2dy1dy2.

Proof: See Appendix A, Subsection J. Theorem 8: The mean number of MUs served by the same BS serving a typical SU located at the origin is given by:
N MU,het = λLλMU N SU,macro λSU
Proof: This follows from the mass transport principle, since λSU N MU,het = λLλMU N SU,macro.
We deﬁne the mean SU throughput as
rSU := E[Requivalent(0)] . (4) N SU,het + N MU,het

1) An approximation for N MU,het: In order to obtain a computationally simple expression, we deﬁne NˆMU,het :=
P{Vhet(0) = Vhet(X∗)}E[|Umobile(Vmacro(0))|]. This is

an approximation to N MU,het since the event {Vhet(0) = Vhet(X∗)} and the random variable |Umobile(Vmacro(0))| are

not independent.

Theorem 9: NˆMU,het

=

pPm 2/aβcro

×

pPm 2/aβcro +(1−p)Pm 2/iβcro

. 1.2802λL λM U
λBS p

Proof: See Appendix A, Subsection K.

2) An approximation for N SU,het: As to N SU,het, we deﬁne NˆSU,het := 1
Vhet(X∗)}E0macro[|Ustatic(Vhet(0))|] + Vhet (X ∗ )}E0micro [|Ustatic (Vhet (0))|].
Theorem 10:

an approximation + P{Vhet(0) = P{Vhet(0) =

NˆSU,het = 1 +

pPm2/aβcro

2/β

2/β

pPmacro + (1 − p)P

2 λSU λBS p

micro

+ (1 − p)Pm2/iβcro 2 λSU (5) pPm2/aβcro + (1 − p)Pm2/iβcro λBS (1 − p)

Proof: See Appendix A, Subsection L.

7

IV. OPTIMAL DESIGN OF THE HETEROGENEOUS NETWORK
Let us ﬁrst consider the network in which all stations transmit with the same power Pmacro = Pmicro = P . In this homogeneous network, if the density of BSs λBS is high (and hence the cells are small) it might be advantageous to let the mobile users connect only to some fraction p < 1 of BSs to reduce the frequency of handoffs during which the connection is not assured. Obviously too small p will result is low data rate due to large distance from BSs. Our model allows us to calculate the optimal value of p as a function of mobile speed v and other network parameters. If a heterogeneous structure of the network is allowed, it might be interesting to further optimize jointly the performance of mobile and static users appropriately tuning the powers Pmacro and Pmicro.
We consider ﬁrst the optimization of the data rate of mobile users and then optimize the throughput of static and mobile users. The optimal proportion of macro stations and the transmit powers provide a guideline for the design of the heterogeneous network.

as the optimal fraction of BSs to which MUs should connect so as to optimize their bit-rate. However, it has to be kept in mind that this formula is being used only to provide an intuitive explanation for not using all the base stations to serve the MUs.
2) When a heterogeneous architecture is allowed, the value of (7) with p = p∗ can be further maximized in Pmacro under constraint (1). I is easy to see that the optimal choice consists in taking Pmacro := (p∗)β/2P and Pmicro = 0. This means that using micro BSs is counterproductive from the point of view of the maximization of the bit-rate of MUs. Shutting down micro BSs and increasing appropriately the power of macro BSs (so as to ensure the equivalent service for static users) appears to be an optimal solution. This observation complies with the fact that the micro BSs are meant to provide extra capacity (and not rate-coverage) to the network. Indeed, we shall see in the next section that only a joint optimization of the throughput (which is a capacity metric) of static and mobile users suggest a usage of micro BSs.

A. Optimizing Data Rate of Mobile Users

Consider the following optimization of the data rate of mobile users accounted for handoff events (cf Section III-B) within the class of equivalent heterogeneous networks

sup

(1 − λcvTh)E[Rmacro(0)] (6)

0≤p≤1,Pmicro ,Pmacro ≥0

such that (1) holds

for some given P and other model parameters. The above problem needs to be solved numerically since the dependence of the integral (2) for E[Rmacro(0)] with the distribution of SIR given in Theorem 1 cannot be analytically evaluated with respect to the optimization parameters.
However, in order to have some insight into the structure of the MU rate optimization let us revisit (6) with E[Rmacro(0)] approximated by E[Rmacro(0)1(SIRmacro(0) > 1)]. 9 Deﬁne the constant
∞
C := (Γ(1 + 2/β)Γ(1 − 2/β))−1 (2t − 1)−2/β dt
1

Then, under constraint (1), E[Rmacro(0)1(SIRmacro(0) > 1)] = Cp(Pmacro/Pmicor)2/β and hence

(1 − λcvTh)E[Rmacro(0)1(SIRmacro(0) > 1)] =

(1 − 4vTh λBS p/π)Cp(Pmacro/Pmicro)2/β.

(7)

It is easy to see (calculating the derivative in p) that the value of (7) is maximized with p ∈ [0, 1] for p = p∗, where

p∗ := min(1, π2/(36v2Th2λBS)) .

(8)

Remark 3: 1) Note that the value of p∗ in (8) does not
depend on the power values Pmacro, Pmicro. In case of a homogeneous network these powers are ﬁxed and equal to Pmacro = Pmicro = P . In this case p∗ can be interpreted

9This corresponds to the bit-rate with adaptive coding available only for SIR larger than 1.

B. Optimizing User Throughput
We consider now optimization of the user throughput. Our ﬁrst observation is that if one focuses only on the throughput of mobile users rMU given by (3), i.e. considers
sup (1 − λcvTh)E[Rmacro(0)] , (9) 0≤p≤1,Pmicro,Pmacro≥0 N SU,macro + N M U,macro
such that (1) holds
then, as in the case of MU rate optimization considered in Section IV-A, the √optimal solutions consists in taking some p < 1 when vTh λBSp too large, do not use micro BSs (Pmicro = 0) and adapt appropriately the power of macro BSs (observed numerically). This can be again explained by the observation that micro BSs are meant to provide capacity to static users. When rSU is absent from the optimization then there is no reason to use micro BSs.
This takes us to our ultimate problem of a joint optimization of the throughput of static and mobile users

sup

rMU + ξrSU

0≤p≤1,Pmicro ,Pmacro ≥0

such that (1) holds

(10)

where rMU and rSU is the throughput of mobile and static user given by (3) and (4), respectively, and ξ is a multiplier
that captures the emphasis we put on the rate of the typical static user in the objective function. 10 As we shall see in
Section IV-C, if enough emphasis is put on the throughput of
static users then the usage of micro stations is advantageous. Let us denote the optimal solution of (10) by p∗(ξ),
Pm∗ icro(ξ) and Pm∗ acro(ξ), and the corresponding optimal rates by rM ∗ U (ξ) and rS∗ U (ξ).
Lemma 2: rM ∗ U (ξ) + ξrS∗U (ξ) is convex, increasing in ξ. Proof: See Appendix A, Subsection M.

10E.g. taking the ratio of the intensities of the two types of users ξ = λSU /(λMU λL) one considers in (10) the mean throughput of the typical user (static or mobile).

8

Fig. 4.

Variation of rSU

with p and

Pmicro P

for system parameters chosen

in Section IV-C. When p and Pmicro are both 0, there are only micro base

stations with 0 transmit power. Hence, all users get zero data rate. This

situation is excluded from this plot.

Lemma 3: rS∗U (ξ) is increasing in ξ, and rM ∗ U (ξ) is decreasing in ξ.
Proof: See Appendix A, Subsection N.
Problem (10) can be used to solve the following constrained problem:

sup
0≤p≤1,Pmicro ,Pmacro ≥0 such that (1) holds
such that rSU ≥ r0

rM U

(11)

The following standard result tells us how to choose ξ. Theorem 11: If there exists ξ∗ ≥ 0 such that, under the optimal solution of (10) with ξ = ξ∗, the constraint in (11) is met with equality, then that solution is optimal for the constrained problem (11) as well.

C. Numerical Results and Insights to the Network Design Problem

We consider a networks with P = 1 unit (the results

presented in this section are invariant w.r.t. P ; the reason is

that if we scale the transmit power at each BS by a constant

factor, the SIR at any location and the cell structure remain
unchanged), λBS = 25100 /m2 (one base station per 50m×50m area), v = 20m/sec (72 kmph), Th = 2 second (note that, the

results in this section will remain unchanged if we vary v and

Th while keeping their product constant), λSU = 4100 /m2 (one

static

user

per

20m × 20m

area),
√

λM U

=

210 /m

(one

MU

per

20 m distance) and λL = 502 /m (equivalent to the length of

the diagonal in a 50m × 50m square).

The

variation

of

rSU

and

rM U

with

p

and

Pmicro P

are

shown

in Figure 4 and 5 respectively. Several observations can be

made from these plots as discussed below:

• As p or Pmicro increases, the network becomes more and more homogeneous, and rSU increases.
• As Pmicro increases for a ﬁxed p, the throughput rMU decreases because Pmacro decreases and interference

Fig. 5.

Variation of rMU

with p and

Pmicro P

for system parameters chosen

in Section IV-C. The situation when p and Pmicro are both 0 is not included

in the plot.

ξ

p∗

Pm ∗ icro

P

0.001 0.4

0

0.01 0.41

0

0.1 0.5

0

0.2 0.62

0

0.29 0.73

0

0.3 0.9

1

0.4 0.9

1

0.5 0.9

1

1

0.9

1

Pm ∗ acro P
4.9704 4.7602 3.3636 2.3084 1.7345
1 1 1 1

rS∗ U (ξ) (bits/sec/Hz)
107.0036 109.5806 132.5683 162.6537 189.6808 253.8792 253.8792 253.8792 253.8792

rM ∗ U (ξ) (bits/sec/Hz)
33.2543 33.2408 31.9570 27.3609 20.6754 1.4436 1.4436 1.4436 1.4436

TABLE I EFFECT OF ξ ON THE OPTIMAL HETEROGENEOUS NETWORK DESIGN
UNDER THE EQUIVALENT NETWORK CONDITION

from micro BSs increases. • As p increases keeping Pmicro ﬁxed, rMU ﬁrst increases
and then decreases. Initially rMU increases because more macro BSs are added that can serve the MUs. But beyond certain value of p, the throughput loss due to frequent handoff starts dominating, and hence rMU decreases with p. • The performance of MUs is very sensitive to the value of Pmicro; rMU drops rapidly as Pmicro increases from 0. Hence, the value of Pmicro should be small if we want high rMU , and the value of p has to be chosen optimally as shown in Figure 4 and 5.
Now we focus on numerical solution to the problem (10). Let us recall that the optimal solution of (10) is denoted by p∗(ξ), Pm∗ icro(ξ) and Pm∗ acro(ξ), and the corresponding optimal rates are denoted by rM ∗ U (ξ) and rS∗U (ξ). From the numerical results in Table I, we observe that p∗ < 1, Pm∗ acro > P and Pm∗ icro = 0 for small values of ξ, whereas p∗ < 1, Pm∗ acro = Pm∗ icro = P above certain value of ξ.11 This is explained by the fact that small ξ puts more weightage on the throughput of mobile users, and hence micro base stations
11We have used programs from [23] to compute the function Jn,β (·).

9

(which cause interference to MU downlink) are shut down, and a fraction of BSs are used as macro BSs with high power. On the other hand, large value of ξ puts more weightage on the throughput of static users, thereby resulting in a homogeneous network design with Pm∗ acro = Pm∗ icro = P . The results also demonstrate that using macro BSs can improve the rate of MUs in practice (which is not intuitive since macro BSs reduce handoff rate, but at the same time a typical MU is co-served with more SUs and MUs, and the macro cell size increases). The interesting part of the observation is that the network should always be homogeneous in both cases; this is a consequence of the sensitivity of rMU with p and Pmicro as discussed in the previous paragraph. Of course, the optimal design will depend on parameters such as λBS, v, Th, λMU and λL, and also the choice of ξ; hence, choice of the optimal fraction and power levels of macro and micro base stations will depend on the estimates of user densities and user velocity estimates. The choice will also depend on the physicals constraints of the system designer (e.g., availability and cost for macro and micro BSs, maximum transmit power available at macro BSs etc.) For example, for large v, the macro BSs may need very high power, but the commercially available BSs may not be able to meet this power requirement.
From Table I, we can solve the constrained problem (11) by choosing appropriate ξ∗ as described in Theorem 11.

challenging, since the association of the mobile users to the densely deployed base stations are supposed to change rapidly over time, resulting in an unprecedented amount of handoff trafﬁc, (vii) In this paper, we have assumed that macro base stations serve SUs and MUs, while micro BSs serve only SUs. There can be other service disciplines, such as macro base stations serving only MUs and micro base stations serving only SUs, or a fraction of macro BSs serving only MUs and some other fraction serving SUs and MUs; performance of such service disciplines needs to be investigated. (viii) The results in this paper do not guarantee a minimum throughput for the users all the time; if a user is located where there is no BS close to it, it will experience poor throughput. A grid-like base station process may be able to solve this issue, but the optimal design procedure of such networks needs to be explored. (ix) A simple way to address the problem of handoff failure due to overload in the target cell would be to multiply the throughput of MUs by the probability that the target macro BS rejects a handoff request (this probability has to be averaged over all macro BSs), and solve the same optimization as in this paper. However, in practice, this probability will be a function of the network design parameters and user densities; hence, the numerical optimization will be more complicated than that solved in this paper. We propose to pursue some of these topics in our future research endeavours.

V. CONCLUSION
In this paper, we have explored the design (or cell planning) of heterogeneous cellular networks to combat throughput loss due to handoff. Analytical results and numerical exploration demonstrate the performance and tradeoffs.
Even though we have solved the basic problem in this paper, there are many possible extensions as well as numerous issues to improve upon: (i) We assumed full interference from all base stations, but it would be of interest to consider the effect of frequency reuse (e.g., in wireless standards such as LTE-A) on the design and resource allocation problems addressed in this paper, (ii) An interesting problem will be cell planning for other models of user mobility such as random waypoint model ([26]), (iii) In practice, there can be multiple possible values of user velocity (generally the network operator will classify user velocities into a discrete set). Hence, a multi-tier network architecture needs to be developed. However, our numerical work has left the open question about the choice of design parameters in such multi-tier networks, since the numerical work with formulation (10) proposes a homogeneous network whereas that formulation cannot achieve all feasible tuples of (rMU , rSU ) (and a solution suboptimal to this formulation has to be adopted), (iv) Extension to the realistic situation where (random) shadowing variation over space modulates the path-loss function is a challenging problem, since this will result in unpredictable behaviour of handoff request generation process due to lack of an accurate statistical characterization of the variation of shadowing over space, (v) Cooperative transmission by multiple base stations to the mobile users can also be explored as a potential solution for throughput loss due to handoff, (vi) Extension to future 5G network models is very

REFERENCES
[1] H.S. Dhillon, R.K. Ganti, F. Baccelli, and J.G. Andrews. Modeling and analysis of K-tier downlink heterogeneous cellular networks. Selected Areas in Communications, IEEE Journal on, 30(3):550–560, april 2012.
[2] B. Błaszczyszyn and Holger Paul Keeler. Equivalence and comparison of heterogeneous cellular networks. In Proc. of PIMRC/WDN-CN, 2013.
[3] J. Andrews, H. Claussen, M. Dohler, S. Rangan, and M. Reed. Femtocells: Past, present and future. IEEE Journal on Selected Areas in Communications, 30(3):497–508, 2012.
[4] V. Pauli, J. Diego Naranjo, and E. Seidel. Heterogeneous LTE networks and inter-cell interference coordination. http://nomor.de/home/technology/white-papers/lte-hetnetand-icic, 2010. Nomor Research White Paper.
[5] O. Stanze and A. Weber. Heterogeneous networks with lteadvanced technologies. Bell Labs Technical Journal, 18(1):41— 58, 2013.
[6] T. Nakamura, S. Nagata, A. Benjebbour, Y. Kishiyama, T. Hai, S. Xiaodong, Y. Ning, and L. Nan. Trends in small cell enhancements in lte advanced. IEEE Communications Magazine, 51(2):98–105, 2013.
[7] H. Ishii, Y. Kishiyama, and H. Takahashi. A novel architecture for lte-b c-plane/u-plane split and phantom cell concept. In IEEE Globecom Workshops, pages 624–630, 2012.
[8] T. Camp, J. Boleng, and V. Davies. A survey of mobility models for ad hoc network research. Wireless Communication and Mobile Computing (WCMC): Special Issue on Mobile Ad Hoc Networking: Research, Trends and Applications, 2:483– 502, 2002.
[9] E. Halepovic and C. Williamson. Characterizing and modeling user mobility in a cellular data network. In Proc. 2nd ACM international workshop on Performance evaluation of wireless ad hoc, sensor and ubiquitous networks, pages 71—78. ACM, 2005.
[10] I. F. Akyildiz, J. McNair, J. S. Ho, H. Uzunalioglu, and W. Wang. Mobility management in next-generation wireless

10

systems. Proceedings of the IEEE, 87(8):1347–1384, August 1999. [11] V. Kavitha, S. Ramanath, and E. Altman. Spatial queueing for analysis, design and dimensioning of picocell networks with mobile users. Performance Evaluation, 68:710–727, 2011. [12] Z. Ye, L.K. Law, S.V. Krishnamurthy, Z. Xu, S. Dhirakaosal, S.K. Tripathi, and M. Molle. Predictive channel reservation for handoff prioritization in wireless cellular networks. Computer Networks, 51(3):798–822, 2007. [13] M. Grossglauser and D.N.C. Tse. Mobility increases the capacity of ad hoc wireless networks. IEEE/ACM Transactions on Networking, 10(4):477–486, 2002. [14] N. Bansal and Z. Liu. Capacity, delay and mobility in wireless ad-hoc networks. In Twenty-Second Annual Joint Conference of the IEEE Computer and Communications (INFOCOM), Vol. 2, pages 1553—1563. IEEE, 2003. [15] T. Bonald, S. Borst, N. Hegde, M. Jonckheere, and A. Proutiere. Flow-level performance and capacity of wireless networks with user mobility. Queueing Systems: Theory and Applications, 63:131–164, 2009. [16] T. Bonald, S.C. Borst, and A. Proutiere. How mobility impacts the ﬂow-level performance of wireless data systems. In Twentythird Annual Joint Conference of the IEEE Computer and Communications Societies (INFOCOM), Vol. 3, pages 1872— 1881. IEEE, 2004. [17] S. Borst, A. Proutiere, and N. Hegde. Capacity of wireless data networks with intra- and inter-cell mobility. In 25th IEEE International Conference on Computer Communications (INFOCOM), pages 1—12. IEEE, 2006. [18] P.V. Orlik and S.S. Rappaport. On the handoff arrival process in cellular communications. Wireless Networks, 7:147–157, 2001. [19] S. Ramanath, V. Kavitha, and E. Altman. Spatial queueing analysis for mobility in pico cell networks. In Proceedings of the 8th International Symposium on Modeling and Optimization in Mobile, Ad Hoc and Wireless Networks (WiOpt), pages 152— 159. IEEE, 2010. [20] S. Ramanath, V. Kavitha, and E. Altman. Impact of mobility on call block, call drops and optimal cell size in small cell networks. In IEEE 21st International Symposium on Personal, Indoor and Mobile Radio Communications Workshops (PIMRC Workshops), pages 157—162. IEEE, 2010. [21] C.H. Lee and Z.S. Syu. Handover analysis of macro-assisted small cell networks. In 2014 IEEE International Conference on Internet of Things (iThings 2014), Green Computing and Communications (GreenCom 2014) and Cyber-Physical-Social Computing (CPSCom 2014), pages 604—609. IEEE, 2014. [22] B. Blaszczyszyn and H.K. Keeler. Studying the sinr process of the typical user in poisson networks using its factorial moment measures. IEEE Transactions on Information Theory, 61(12):6774–6794, 2015. [23] Homepage of H.P. Keeler. https:// www.wias-berlin.de/ people/ keeler/ ?lang=1. [24] S.N. Chiu, D. Stoyan, W.S. Kendall, and J. Mecke. Stochastic Geometry and its Applications. Wiley, 2013. [25] A. Okabe, B. Boots, K. Sugihara, and S.N. Chiu. Spatial Tessellations, Second Edition. Wiley, 1999. [26] E. Hyytia and J. Virtamo. Random waypoint mobility model in cellular networks. Wireless Networks, 13:177—188, 2007. [27] Bartlomiej Blaszczyszyn and Paul Muhlethaler. Interference and SINR coverage in spatial non-slotted Aloha networks. Annales des telecommunications–annals of telecommunications, 70(7):345–358, 2015. Publised online 19 February 2015. [28] R. Meester and R. Roy. Continuum Percolation. Cambridge University Press, 1996. [29] F. Baccelli and B. Błaszczyszyn. Stochastic Geometry and Wireless Networks, Volume I — Theory, volume 3, No 3–4 of Foundations and Trends in Networking. NoW Publishers, 2009.

Arpan Chattopadhyay obtained his B.E. in Electronics and Telecommunication Engineering from Jadavpur University, Kolkata, India in the year 2008, and M.E. and Ph.D in Telecommunication Engineering from Indian Institute of Science, Bangalore, India in the year 2010 and 2015, respectively. He is currently working in INRIA, Paris as a postdoctoral researcher. His research interests include networks, machine learning, information theory and control.

Bartlomiej Blaszczyszyn received his PhD degree and Habilitation qualiﬁcation in applied mathematics from University of Wrocaw (Poland) in 1995 and 2008, respectively. He is now a Senior Researcher at Inria (France), and a member of the Computer Science Department of Ecole Normale Suprieure in Paris. His professional interests are in applied probability, in particular in stochastic modeling and performance evaluation of communication networks. He coauthored several publications on this subject in major international journals and conferences, as well as a two-volume book on Stochastic Geometry and Wireless Networks NoW Publishers, jointly with F. Baccelli.

Eitan Altman received the B.Sc. degree in electrical engineering (1984), the B.A. degree in physics (1984) and the Ph.D. degree in electrical engineering (1990), all from the Technion-Israel Institute, Haifa. In (1990) he further received his B.Mus. degree in music composition in Tel-Aviv University. Since 1990, he has been with INRIA (National research institute in informatics and control) in Sophia-Antipolis, France. His current research interests include performance evaluation and control of telecommunication networks and in particular congestion control, wireless communications and networking games. He is in the editorial board of several scientiﬁc journals: JEDC, COMNET, DEDS and WICON. He has been the (co)chairman of the program committee of several international conferences and workshops on game theory, networking games and mobile networks.

APPENDIX A A. Expression for Jn,β(·) function
The function Jn,β(x1, x2, · · · , xn) is deﬁned as follows:

(1 +

n j=1

xj

)

n

where

n−1 i( β2 +1)−1

2

Πi=1 vi

(1 − vi) β dv1dv2 . . . dvn−1

[0,1]n−1

Πni=1(xi + ηi)

η1 = v1v2 . . . vn−1 η2 = (1 − v1)v2 . . . vn−1 η3 = (1 − v2)v3 . . . vn−1
··· ηn = 1 − vn−1

The function Jn,β(x) is calculated by substituting x1 = x2 = · · · = xn = x in the expression for Jn,β(x1, x2, · · · , xn).

11

B. Proof of Theorem 1

D. Proof of Lemma 1

Denote SIR = SIRmacro(0) and denote the interference

at the origin by the base stations belonging to Φmicro

by Imicro. For a given realization of Imicro, using [22,

Corollary 19]), we can write that, P(SIR > τ |Imicro) = nτ=1 1(−1)n−1τn− 2βn Jn,β (τn)In,β (Imicroa− β2 ), where τn :=
2
1−(nτ−1)τ , a = πλBSApP2mβacro , and the function In,β (·) is

deﬁned in [22, Equation (13)]. For completeness, we provide

2n ∞ u2n−1e−u2−uβ xΓ(1−2/β)−β/2 du

the expression In,β(x) :=

0
β n−1 (n−1)!Γ(1−2/β )n Γ(1+2/β )n

.

Unconditioning

I

n,β

(I

micr

o

a

−

β 2

)

over

Imicro,

we

obtain:

Recall that λc is the density of handoffs (macro cell boundary crossings) on every line of L. Observe that vTh is the length of the segment corresponding to each handoff event. If the segments corresponding to different handoffs on a given line were disjoint the fraction of the line where mobiles are not in handoff would be equal to 1 − λcvTh. The inequality results from the fact that two different handoff events may have overlapping segments on the line, or, in other words, that (in case of crossing small cells) a MU may not recover from the previous handoff before going into the next one.

E[In,β

(Imicro

a−

β 2

)]

−1 n−1

2

n

= β (n − 1)!

Γ(1 − 2 )Γ(1 + 2 )

β

β

∞

β

β

×

u2n−1e−u2 E[e−Imicroa−

2

uβ Γ(1−

2 β

)−

2

]du.

0

From [27, Equation (3.3)], we can write the Laplace transform

E

[e

−

I

micr

o

a

−

β 2

uβ Γ(1− β2

)−

β 2

]

=

LI

(a−

β 2

uβ

Γ(1

−

2

)−

β 2

)

micro

β

2
= e−λBS (1−p)A−2a−1u2πPmβicro

= e .2
−u2(1−p)/p(Pmicro/Pmacro) β

Putting this into the expression of P(SIR > τ ) we obtain

P(SIR > τ )

1

τ

− 2n

−1

=

(−1)n−1τn β Jn,β (τn) × βn−1(n − 1)!

n=1

2

× Γ(1 − 2 )Γ(1 + 2 )

β

β

n
×

∞ −u2
u2n−1 e
0

2

(1−p)P β

1+

micro 2

pPmβacro

2
Substituting v := u2 1+ (1−p)2Pmβicro in the above integral
pPmβacro
and simplifying it further, we prove the lemma. It might be also
useful to observe that 2/(Γ(1− β2 )Γ(1+ β2 ) = β/π sin(2π/β + π)

C. Proof of Remark 2
Consider a given directed line l on the plane. Note that the couple (Φmacro, Φmicro) is ergodic (by [28, Proposition 2.6]) and the σ-ﬁeld σ(Φmacro, Φmicro) is countably generated. Hence, by [28, Proposition 2.7], the sample average data rate (average of Rmacro(x) taken over all points x along line l), exists and is almost surely equal to a constant cl for all, except for at most countably many number of lines l, with cl = E[Rmacro(xl)] for arbitrary xl ∈ l. Since the couple (Φmacro, Φmicro) is translation invariant E[Rmacro(xl)] = E[Rmacro(0)]. Finally, probability that the Poisson line process L places some of its lines in the at most countable subset of lines l is null.

E. Proof of Theorem 2

Under E0MU the typical MU is located at the origin, while other MUs form a Poisson process of intensity λMU on lines of the original, independent L appended with one extra line,
crossing the origin and independently, uniformly oriented. This
is the line along which moves the typical user. Denote by Lmacro(0) the intersection of this extra line with Vmacro(0) and by |Vmacro(0)| and |Lmacro(0)| the respective area and length. Knowing that the expected total length of intersection of L with any given set is equal to λL times the surface of this set we have:

N MU,macro = 1+(λLE[|Vmacro(0)|+E0MU [|Lmacro(0)|])λMU ,

(12) where we replaced E0MU [...] by E[...] in the ﬁrst term due to independence of L and Φ. By the inverse formula

of Palm calculus, cf. [29, Theorem 4.1 and Corollary

4.4], we have E[|Vmacro(0)|]

=

, E0macro [|Vmacro (0)|2 ] 0

Emacro [|Vmacro (0)|]

where E0macro corresponds to Palm distribution for

Φmacro (i.e. given a macro BS at the origin). Now,

duE0macro[|Vmacro(0)|] = 1/(λBSp), (cf [29, Corollary 4.3]) and the variance Var0macro(|Vmacro(0)|) = (λ0.B2S80p2)2 (cf [24, Table 9.5]) Hence, E0macro[|Vmacro(0)|2] = Var0macro(|Vmacro(0)|) + (E0macro[|Vmacro(0)|]2 = (λ1.B2S80p2)2 and consequently E[|Vmacro(0)|] = 1λ.B 28S0p2 .

Regarding the length of Lmacro(0) under E0MU , we can

observe that it has the same distribution as the length of the

interval L˜(0) between two consecutive handoffs (crossings of

the macro cell boundary) of, say, x axis, which covers the origin. L˜(0) is hence the zero interval (the one covering the

origin) of the point process of macro cell bound√ary crossings with the x axis. This process has intensity λc = 4 λπBSp cf [25, Equations 5.7.4 with m = 2]. Using the same inverse formula

(this time in one dimension) we obtain:

E0MU [|Lmacro(0)|] = E[|L˜(0)|] = λcE0cross[|L˜(0)|2]

where E0cross corresponds to the Palm probability of the point
process of the macro cell boundary crossings by the horizontal x axis. By [25, Table 5.7.2], E0cross[|L˜macro(0)|]2 = λ0.B8S04p . Hence,

E0

0.804 × 4

[|Lmacro(0|] = √

=

3.216 √.

MU

π × λBSp π λBSp

Plugging in the expression (12) we prove the theorem.

12

F. Proof of Theorem 3
Let E0macro denote expectation w.r.t. the Palm probability distribution P0macro (probability given that a macro BS is located at the origin). Similarly as in the proof of Theorem 2:

N SU,macro = λSU E[|Vhet(X∗)|]

E0macro[|Vhet(0)| × |Vmacro(0)|]

= λSU

E0

[|Vmacro(0)|]

macro

= λSU λBS pE0macro[|Vhet(0)| × |Vmacro(0)|] (13)

where the ﬁrst equality is by the independence between Ustatic and Φ and the second by the inverse formula of Palm calculus. Now,

given by

pPm 2/aβcro

. This is also the fraction of area

pPm 2/aβcro +(1−p)Pm 2/iβcro

over R2 where SUs are served by macro BSs.

Now, by the inverse formula of Palm calculus,

E0macro[|Vhet(0)|] =

pPm 2/aβcro
2/β

2/β

× λ 1 p , from

pPmacro +(1−p)Pmicro

BS

which the proof follows.

H. Proof of Theorem 5
Let us recall the expression for N SU,macro from Theorem 3. Note that, A((x1, x2), (y1, y2)) ≤ π(x21 + x22) + π(y12 + y22). Hence,

E0macro[|Vhet(0)| × |Vmacro(0)|]

= E0macro

1{(x1, x2) ∈ Vmacro(0)}dx1dx2
(x1 ,x2 )∈R2

×

1{(y1, y2) ∈ Vhet(0)}dy1dy2

(y1 ,y2 )∈R2

= E0macro

1{(x1, x2) ∈ Vmacro(0),
(x1,x2) (y1,y2)

(y1, y2) ∈ Vhet(0)}dx1dx2dy1dy2

=

P0macro{(x1, x2) ∈ Vmacro(0),

(x1,x2) (y1,y2)

(y1, y2) ∈ Vhet(0)}dx1dx2dy1dy2

(14)

Given that there is a macro BS at the origin, (x1, x2) ∈
Vmacro(0) and (y1, y2) ∈ Vhet(0) if and only if these three
conditions are satisﬁed: (i) there is no other macro BS in a circle centered at (x1, x2) and having radius x21 + x22, (ii) there is no other macro BS in a circle centered at (y1, y2) and having radius y12 + y22, and (iii) there is no other micro BS inside a circle centered at (y1, y2) and having radius r0 where Pmacro( y12 + y22)−β = Pmicror0−β, i.e., r0 = ( PPmicro ) β1 y12 + y22.
macro
Hence,

P0macro{(x1, x2) ∈ Vmacro(0), (y1, y2) ∈ Vhet(0)} = e−λBS pA((x1,x2),(y1,y2))−λBS (1−p)πr02 ,

where r0 = ( PPmicro ) β1 y12 + y22. This, combined with (13) macro
and (14), proves the theorem.

G. Proof of Theorem 4
Let us assume that the macro BS closest to the origin is located at a distance r from the origin. Then, the origin
will be served by the macro BS if and only if there is no micro BS in a circle centered at origin with radius R, where PmicroR−β = Pmacror−β , i.e., R = ( PPm maiccrroo )1/β r. The probability that the nearest macro BS to the origin is located at a distance between r and r + dr is given by f (r)dr where f (r) = e−λBSpπr2 λBSp × 2πr. Hence, the probability that a static user located at the origin is served by a macro BS is given by 0∞ e−λBS(1−p)π(Pmicro/Pmacro)2/βr2 f (r)dr, which, after simpliﬁcation, yields that the probability that a typical
static user located at the origin is served by a macro BS is

N SU,macro

≥ λSU λBS p
(x1,x2)∈R2 (y1,y2)∈R2
e−λBS pπ(x21+x22)−λBS pπ(y12+y22)−λBS (1−p)πr02

dx1dx2dy1dy2

Now, (x1,x2)∈R2 e−λBS pπ(x21+x22)dx1dx2 = E0macro(|Vmacro(0)|) = λB1Sp and (y1,y2)∈R2 e−λBS pπ(y12+y22)−λBS (1−p)πr02 dy1dy2 =

E0macro(|Vhet(0)|).

Hence,

N SU,macro

≥

λSU E0macro(|Vhet(0)|) := NˆSU,macro.

I. Proof of Theorem 6
Note that, N SU,macro = λSU E0MU [|Vhet(X∗)|]. But Vhet(X∗) is a subset of macro cell Vmacro(0) containing the origin, and E0MU [|Vmacro(0)|] = E[|Vmacro(0)|] = 1λ.B 28S0p2 (as shown in the proof of Theorem 2). Hence, N SU,macro ≤ . 1.2802λSU
λBS p

J. Proof of Theorem 7
We consider now the typical SU located at the origin under E0SU . Using the similar arguments as in the proof of Theorem 3, we obtain:

N SU,het = 1 + λSU E[|Vhet(0)|]

= 1 + λ E0het[|Vhet(0)|2] ,

(15)

SU E0het[|Vhet(0)|]

where E0het denotes the expectation under the Palm probability given that there is one (macro or micro) BS at the origin. Let E0macro (resp., E0micro) be the expectation under the Palm probability distribution given that there is one macro (resp.,
micro) BS at the origin. Note that, the fraction of the macro base stations is p, and the rest of base stations are micro base
stations. Using this fact and using similar arguments as in the
proof of Theorem 3, we can write:

13

E0het [|Vhet (0)|2 ]

=p
(x1,x2)∈R2 (y1,y2)∈R2
P0macro{(x1, x2) ∈ Vhet(0), (y1, y2) ∈ Vhet(0)}dx1dx2dy1dy2

+(1 − p)
(x1,x2)∈R2 (y1,y2)∈R2
P0micro{(x1, x2) ∈ Vhet(0), (y1, y2) ∈ Vhet(0)}dx1dx2dy1dy2

=p

e−λBS pA((x1,x2),(y1,y2))

(x1,x2)∈R2 (y1,y2)∈R2

e−λBS (1−p)B((x1,x2),(y1,y2))dx1dx2dy1dy2

+(1 − p)

(x1 ,x2 )∈R2

e−λBS (1−p)A((x1,x2),(y1,y2))
(y1 ,y2 )∈R2

e−λBS pD((x1,x2),(y1,y2))dx1dx2dy1dy2

(16)

Now, note that E0het[|Vhet(0)|] = 1/λBS. This, combined with (15) and (16) proves the theorem.

and
≥

rMU (p∗(ξ + κ), Pm∗ icro(ξ + κ), Pm∗ acro(ξ + κ)) +(ξ + κ)rSU (p∗(ξ + κ), Pm∗ icro(ξ + κ), Pm∗ acro(ξ + κ)) rMU (p∗(ξ), Pm∗ icro(ξ), Pm∗ acro(ξ)) +(ξ + κ)rSU (p∗(ξ), Pm∗ icro(ξ), Pm∗ acro(ξ))

Adding the above inequalities and cancelling common terms, we obtain rSU (p∗(ξ + κ), Pm∗ icro(ξ + κ), Pm∗ acro(ξ + κ)) ≥ rSU (p∗(ξ), Pm∗ icro(ξ), Pm∗ acro(ξ)), i.e., rS∗ U (ξ) is increasing in ξ. We can prove the other part in a similar way.

K. Proof of Theorem 9

As in the proof of Theorem 4, P{Vhet(X∗) =

Vhet(0)} =

pPm 2/aβcro

. The mean volume of the

pPm 2/aβcro +(1−p)Pm 2/iβcro

zero macro cell (the macro cell containing the origin) is

E(|Vmacro(0)|) = 1λ.B 28S0p2 as in the proof of Theorem 2, and E(|Umobile(Vmacro(0))|) = λMU λLE(|Vmacro(0)|). Hence,

the proof follows.

L. Proof of Theorem 10

As in the proof of Theorem 4, P{Vhet(X∗) = Vhet(0)} =

pPm 2/aβcro

. Now, P{Vhet(X∗) = Vhet(0)} = 1 −

pPm 2/aβcro +(1−p)Pm 2/iβcro

P{Vhet(X∗) = Vhet(0)}.

Similar to the proof of Theorem 4, the mean area of

a hetnet cell served by a typical macro BS is given by

E0macro[|Vhet(0)|] =

pPm 2/aβcro
2/β

2/β

× λ 1 p , and sim-

pPmacro +(1−p)Pmicro

BS

ilarly E0 [|Vhet(0)|] =

(1−p)Pm 2/iβcro

micro

pP

2/β macr

o

+(1

−

p

)P

2/β

× λBS (11−p) .

micro

Combining the above results, we prove the theorem.

M. Proof of Lemma 2
Note that, for given values of p, Pmicro and Pmacro, the function (rMU + ξrSU ) is an afﬁne, increasing function of ξ. This proves the lemma since pointwise supremum of afﬁne, increasing functions is convex, increasing.

N. Proof of Lemma 3 Consider any κ > 0. By optimality of p∗(ξ), Pm∗ icro(ξ) and
Pm∗ acro(ξ), we obtain:

rMU (p∗(ξ), Pm∗ icro(ξ), Pm∗ acro(ξ))

+ξ

r

S

U

(

p∗

(

ξ

),

P

∗ micr

o

(ξ

),

P

∗ macr

o

(

ξ

))

≥ rMU (p∗(ξ + κ), Pm∗ icro(ξ + κ), Pm∗ acro(ξ + κ))

+ξrSU (p∗(ξ + κ), Pm∗ icro(ξ + κ), Pm∗ acro(ξ + κ))

