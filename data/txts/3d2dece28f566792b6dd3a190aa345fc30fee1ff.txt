Vertiport Selection in Hybrid Air-Ground Transportation Networks via Mathematical Programs with Equilibrium Constraints
Yue Yu, Mengyuan Wang, Mehran Mesbahi, and Ufuk Topcu

arXiv:2203.05702v1 [math.OC] 11 Mar 2022

Abstract— Urban Air Mobility is a concept that promotes aerial modes of transport in urban areas. In these areas, the location and capacity of the vertiports–where the travelers embark and disembark the aircraft–not only affect the ﬂight delays of the aircraft, but can also aggravate the congestion of ground vehicles by creating extra ground travel demands. We introduce a mathematical model for selecting the vertiports location and capacity that minimizes the trafﬁc congestion in hybrid air-ground transportation networks. Our model is based on a mathematical program with bilinear equilibrium constraints. Furthermore, we show how to compute a global optimal solution of this mathematical program by solving a mixed integer linear program. We demonstrate our results via the Anaheim transportation network model, which contains more than 400 nodes and 900 links.

NOMENCLATURE

Parameters

nτ Number of different equilibria

nn Number of nodes

nv Number of candidate vertiports

nl

Number of ground and air links

nd Number of destination nodes

ng Number of ground links

na Number of air links

nm Number of options for vertiport capacity

nb Number of logical constraints

γ

Budget for selecting vertiport capacity

µ

A large positive scalar

1b The nb-dimensional vector of all 1’s

1d The nd-dimensional vector of all 1’s

1m The nm-dimensional vector of all 1’s

1v The nv-dimensional vector of all 1’s

c

Free travel time vector

f

Link capacity vector

E

Node-edge incidence matrix

D

vertiport incidence matrix

S

Source-sink matrix

G

Candidate capacity matrix

K Cost matrix

Variables

g

Vertiport capacity vector variable

p

Dual variable for link capacity constraint

q

Dual variable for vertiport capacity constraint

B

Binary selection matrix

Y. Yu and U. Topcu are with the Oden Institude of Computational Sciences and Engineering, The University of Texas at Austin, TX 78712 USA (emails: yueyu@utexas.edu, utopcu@utexas.edu). M. Wang and M. Mesbahi are with the Department of Aeronautics and Astronautics, University of Washington, Seattle, WA 98195 USA (emails: mywang10@uw.edu, mesbahi@uw.edu).

U

Dual variable for nonnegative ﬂow constraint

V

Dual variable for ﬂow conservation constraint

X

Flow matrix variable

Y

Auxiliary variable for linearizing constraints

Subscripts

[a]j The j-th element of vector a

[A]ij The ij-th element of matrix A

Sets

Rn The set of n-dimensional real vectors Rm×n The set of m × n real matrices {0, 1}n The set of n-dimensional binary vectors

{0, 1}m×n The set of m × n binary matrices

Operations

The Hadamard product

vec The vectorization function

I. INTRODUCTION
Urban Air Mobility (UAM) is a concept that promotes short-range aerial travel in urban areas [1], [2]. By adding an air transportation network supported by the vertiports– where the travelers embark and disembark the aircraft– to the existing ground transportation network, UAM has the potential to alleviate the ground trafﬁc congestion. The latter has become a growing concern among travelers and transportation authorities alike [3].
One challenge in UAM is to select the locations of the vertiports optimally among candidate options. The input of the selection includes a set of candidate vertiports (usually generated by clustering algorithms [4], [5], [6]) and the budget of the total number of vertiports. The output of the selection is a set of selected vertiports that optimizes certain performance metric of the air transportation network supported by the selected vertiports, such as the savings in total travel time [7] and the package demand served by the aircraft [8].
Since the candidate locations for vertiports are often limited by safety, accessibility, and noise emission factors, most door-to-door travel in UAM will require transportation via both aircraft and ground vehicles [4], [5], [6], [9]. Consequently, the vertiport locations can also affect the trafﬁc in the existing ground transportation network by creating additional travel demands on the way to and from the vertiports. Recent studies investigate the potential of UAM as a complement to the ground transportation systems [10]. However, how to select the vertiport locations by optimizing its impacts on the congestion in a network that allows both aerial and ground modes of transport is, to our best knowledge, still an open question.

We introduce a mathematical model for selecting the location and capacity of the vertiports in a hybrid airground transportation network. Our objective is to reduce the congestion in the network. The basis of our model is a mathematical program with equilibrium constraints, a nonconvex optimization problems with bilinear constraints widely used in transportation network design [11]. Our contributions are threefold.
1) First, we developed a linear-program-based model for the static trafﬁc equilibria in a hybrid air-ground transportation network. This model extends the Nesterov & de Palma model by adding node capacity constraints.
2) Second, we proposed a mathematical program with bilinear equilibrium constraints that optimizes the location and capacity of the vertiports subject to budget and logical constraints. In addition, we showed how to compute a global optimal solution of this mathematical program by solving a mixed-integer linear program, where the number of integer variables only depend on the candidate vertiports.
3) Finally, we demonstrated our results using the Anaheim transportation network, which contains more than 400 nodes and 900 links.
Our work is the ﬁrst step to adapt the mathematical tools for ground transportation network analysis and design in the age of UAM. In particular, we showed how to extend the ground trafﬁc equilibria model to predict trafﬁc equilibria in hybrid air-ground transportation networks. We also provide a numerical tool to design the vertiports as an extension of an existing ground transportation network.
The rest of the paper is organized as follows. Section II brieﬂy reviews some existing results in static trafﬁc equilibria and transportation network design. Section III introduces an extended Nesterov & de Palma model for static trafﬁc equilbria in hybrid air-ground transportation networks. Section IV introduces the mathematical program with equilibrium constraints for vertiports selection. We demonstrate this mathematical program using the Anaheim transportation network in Section V before concluding in Section VI.
II. RELATED WORK
Transportation network design is the problem of determining the optimal modiﬁcation, such as the addition of new road segments, of an existing ground transportation network [12], [13]. The modiﬁcations can be expanding the capacity of existing links, or adding new nodes and links to the network. The quality of the modiﬁcations is evaluated via the congestion of the travelers in the modiﬁed network and the cost of the modiﬁcations. The input of the problem includes 1) the existing transportation network topology, 2) the travel demand between each origin-destination pair for a speciﬁc time interval, 3) the characteristics of roads, such as ﬂow capacity and free travel time, 4) the set of candidate options for modiﬁcations and their cost, and 5) the total budget for modiﬁcations. The outcome of the problem is a set of modiﬁcations that satisﬁes the budget constraint and

minimizes the congestion of the travelers. See [11] for a recent survey on transportation network design.
A key step in transportation network design is to predict the collective behavior of selﬁsh travelers in congested transportation networks [14]. There are two different prediction model used in the literature: a nonlinear-convexoptimization-based model, known as the Beckmann model [15], and a linear-program-based model, known as the Nesterov & de Palma model [16], [17]. Both models provide similar prediction for the user distribution, the price of anarchy, and the Braess paradox phenomenon [18].
In transportation network design problems, the Nesterov & de Palma model is computationally more efﬁcient than the Beckmann model. Using the Nesterov & de Palma model, one can obtain the global optimal network design by solving a mixed integer linear program [19], [20], [21]. In contrast, using the Beckmann’s model, solving a mixed integer linear program–or equivalently, a linear-linear bilevel optimization problem–only provides a local descent direction, not a global optimal solution, for the optimal transportation network design problem [22].
III. STATIC TRAFFIC EQUILIBRIA IN HYBRID AIR-GROUND TRANSPORTATION NETWORKS
We ﬁrst introduce the static trafﬁc equilibria model of a hybrid air-ground transportation network. This model predicts the static regime of the trafﬁc patterns, where the number of vehicles entering and exiting a road segment (or a ﬂight leg) per unit time are the same. We will later use this model to evaluate the performance of a given transportation network. Our model is based on the following three assumptions.
1) For each origin-destination pair, only the routes with the minimum accumulated travel time are used.
2) The trafﬁc ﬂow on each road segment or ﬂight leg never exceeds its capacity; the total incoming and outgoing air trafﬁc ﬂow at each vertiport never exceeds its capacity.
3) If the ground trafﬁc ﬂow on a road segment is below its capacity, its travel time equals to a nominal value; if the capacity is reached, the travel time is higher than the nominal value. If the total incoming and outgoing air trafﬁc ﬂow at a vertiport is below its capacity, the delay (for embarkation and disembarkation) at this vertiport is zero; if the capacity is reached, the delay is nonnegative.
The above three assumptions have the following implications. The ﬁrst assumption characterize the selﬁsh and competitive nature of the travelers’ behavior; it is also known as the Wardrop equilibrium principle [23] and has been the basis of static trafﬁc equilibria models [14]. The second assumption states that the trafﬁc ﬂow on a road segment is upper bounded–typically due to the number of lanes and the green light time–and the total air trafﬁc ﬂow at a vertiport is upper bounded–typically due to the number of touchdown and lift-off pads. The third assumption is based on the empirical observation that the travel time on a road segment (or the delay at a vertiport) is at its minimum when there is no congestion, and increase with the congestion level.

Similar assumptions were ﬁrst introduced in the Nesterov & de Palma model for ground trafﬁc equilibria [17]. Here we add two additional assumptions on the capacity and delay at vertiports.
In the following, we will introduce a mathematical model for static trafﬁc equilibria that satisfy all the aforementioned assumptions. Our model is based on the Nesterov & de Palma model for ground trafﬁc equilibria.
A. Hybrid air-ground networks
We ﬁrst introduce some basic network concepts: nodes, links, incidence matrices, link and node capacity, and travel time.
1) Nodes and links: We let N = {1, 2, . . . , nn} denote the set of nodes. We let V = {v(1), v(2), . . . , v(nv)} denote the set of nodes that contain a candidate vertiport location, where v(i) ∈ N for all i = 1, 2, . . . , vn.
We let L = {1, 2, . . . , nl} denote the set of links. Each link is an ordered pair of distinct nodes, where the ﬁrst and second nodes are the “tail” and “head” of the link, respectively. In addition, we let ng ≤ nl denotes the number of ground links, and na := nl − ng denote the number of air links. The presence of link k = (i, j) with 1 ≤ k ≤ ng means that any ground vehicles can travel from node i to node j, and the presence of link k = (i, j) with ng + 1 ≤ k ≤ nl means any aircraft can ﬂy from node i to node j.
2) Incidence matrices: We represent the topology of the hybrid air-ground network using the node-edge incidence matrix E ∈ Rnn×nl . The entry [E]ik in matrix E is associated with node i and link k as follows:
 1, if node i is the tail of link k,  [E]ik = −1, if node i is the head of link k, (1) 0, otherwise.
Note that [E]ik = 0 for some ng + 1 ≤ k ≤ nl only if i ∈ V. We represent the topology of the air links and vertiports
using the following unsigned incidence matrix D ∈ Rnv×nl for air links. The entry [D]ik is associated with node i and link k as follows
[D]ik = 1, if k ≥ m + 1 and [E]v(i),k = 0, (2) 0, otherwise.
3) Demand matrix: We distinguish different travelers in the network using their destinations, denoted by a subset of nodes {s(1), s(2), . . . , s(nd)} ⊂ N . We denote the amount of trips per unit time, also known as the trafﬁc demand, between different origin and destination nodes using a demand matrix S ∈ Rnn×nd deﬁned as follows. For any i ∈ N with i = s(j), we let the entry [S]ij in matrix S denote the trafﬁc demand from node i to node s(j), i.e., the amount of travelers leaving node i heading towards node s(j) per unit time. If [S]ij > 0, then (i, s(j)) is also known as an origindestination pair. Finally, we let [S]s(j),j = − i,i=s(j)[S]ij for all j = 1, 2, . . . , nd such that the sum of each column in matrix S equals zero. Such an assignment is convenient for deﬁning the ﬂow conservation constraints in matrix form, as we will show.

3

2

4

1

5

6

4

1

3

2

Fig. 1. An example of a hybrid air-ground transportation network, where black and blue arcs denote ground and air links, respectively. The blue nodes contain candidate locations for vertiports.

4) Flow matrix: At a static trafﬁc equilibrium, the amount of travelers entering and exiting the same link are the same. We represent the amount of travelers on different links per unit time using the ﬂow matrix X ∈ Rnl×nd . In particular, the entry [X]kj in matrix X denotes the amount of travelers exiting link k while heading towards destination node s(j) per unit time.
By construction, the demand matrix S, ﬂow matrix X, and incidence matrices E together satisfy the following ﬂow conservation constraint:

EX = S, X ≥ 0.

(3)

Notice that the above constraints implicitly imply that the sum of each column in matrix S equals zero. This observation justiﬁes our deﬁnition of the negative entries in matrix S.

Example 1. To illustrate the aforementioned network concepts, we consider the example network in Fig. 1. In this case, we have N = {1, 2, 3, 4}, V = {2, 3}, L = {1, 2, 3, 4, 5, 6}, and matrices E and D are as follows

E=

110 −1 0 1 0 −1 0

000

0 1

1 −1 −1 1

,

D

=

[

0 0

0 0

0 0

0 0

1 1

1 1

].

0 0 −1 −1 0 0

Furthermore, a possible choice of demand matrix S and ﬂow matrix X that satisfy the constraints in (3), are as follows:

S=

5 −5 0 0 10 0 0 −1

,

X

=

[

5 3

0 7

0 7

0 3

0 0

0 4

]

.

5) Capacity and free travel time: The link capacity of a

(ground or air) link is the maximum amount of travelers

existing this link per unit time. For a ground link, this

capacity depends on the number of lanes and cycle time of

trafﬁc signals; for an air link, this capacity depends on the

available airspace and the maximum allowed aircraft density

of each ﬂight leg. We denote the link capacity of all the air

and

ground

links

using

the

link

capacity

vector

f

∈

R

nl +

,

where its entry [f ]k denotes the capacity on link k.

The free travel time of a (ground or air) link is the time

consumed by each traveler on this link when there is no

trafﬁc congestion. We denote the free travel time of all links using a vector c ∈ Rnl , whose k-th entry denotes the free

travel time on link k.

The Nesterov & de Palma model [16], [17] assumes that

the link capacity, the free travel time, and the ﬂow matrix

are coupled as follows. First, the trafﬁc ﬂow on each link never exceeds its capacity, i.e.,

nd

[X]kj ≤ [f ]k,

(4)

j=1

for all k ∈ L. Second, if the trafﬁc ﬂow on a link is below its capacity, then the travel time of this link equals the corresponding free travel time; if the trafﬁc ﬂow on a link equals its capacity, then the average travel time of this link is lower bounded by the corresponding free travel time. In other words, if vector c˜ ∈ Rnl is such that [c˜]k denotes the travel time on link k, then the following conditions hold for all k ∈ L:

nd

[X]kj < [f ]k ⇒ [c˜]k = [c]k,

(5a)

j=1

nd

[X]kj = [f ]k ⇒ [c˜]k ≥ [c]k.

(5b)

j=1

In addition to the above link capacity, here we also consider additional capacity of vertiports in the hybrid airground transportation network. Each vertiport can accommodate a maximum amount of take-off and landing per unit time, due to the limited number of touch-down and lift-off pads. Similar to those in Nesterov & de palma model, we make the following assumptions. First, the total amount of air trafﬁc entering and exiting a vertiport never exceeds its capacity, i.e.,

nl nd

[D]ik[X]kj ≤ [g]i.

(6)

k=1 j=1

for all i = 1, 2, . . . , nv. Second, if the trafﬁc ﬂow on a vertiport is below its capacity, then the delay at this vertiport
equals zero; if the trafﬁc ﬂow on a vertiport reaches its
capacity, then the average ﬂight delay at this vertiport is nonnegative. In other words, if vector e˜ ∈ Rnv is such that [e˜]i denote the average ﬂight delay at vertiport i, then the following condition holds for all i = 1, 2, . . . , nv:

nl nd

[D]ik[X]kj < [g]i ⇒ [e˜]i = 0,

(7a)

k=1 j=1

nl nd

[D]ik[X]kj = [g]i ⇒ [e˜]i ≥ 0.

(7b)

k=1 j=1

B. Trafﬁc equilibria with node and link capacities
We are now ready to introduce the concept of static equilibrium matrix.
Deﬁnition 1. Matrix X ∈ Rnl×nv is a static equilibrium matrix deﬁned by the tuple {S, E, D, c, f, g} if it is the optimizer of the following linear program,

Linear program for static trafﬁc equilibria

minimize c X1d
X

subject to EX = S, X ≥ 0,

(8)

X1d ≤ f, DX1d ≤ g.

Remark 1. Without the constraints in (6), optimization (8) reduces to the Nesterov & de Palma model for static trafﬁc equilibria [16], [17]. In this view, Deﬁnition 1 introduces an extension of the Nesterov & de Palma model by adding capacity constraints to the nodes that contain vertiports.

The linear program in Deﬁnition 1 is our prediction model for the trafﬁc patterns–including ﬂow and travel cost–of a hybrid air-ground transportation network. The following proposition provides two equivalent characterization of static equilibrium matrix based on the optimality condition of linear programs.
Proposition 1. Matrix X ∈ Rnl×nv is an static equilibrium matrix associated with the tuple {S, E, D, c, f, g} if and only if there exists V ∈ Rnn×nd , U ∈ Rnl×nd , p ∈ Rnl , and q ∈ Rnv such that the following two conditions hold simultaneously.
1) The following constraints are satisﬁed:

EX = S, X1d ≤ f, DX1d ≤ g,

(9a)

(c + p + D q)1d = E V + U,

(9b)

X ≥ 0, U ≥ 0, p ≥ 0, q ≥ 0.

(9c)

2) One of the following two set of constraints are satisﬁed:

either tr(X U ) = 0, p X1d = f p, (10) q DX1d = g q,

or

c X1d + f p + g q = tr(V S).

(11)

Proof. See Appendix VII-A

The conditions in (10) and (11) are also known as the complementary slackness condition and the zero-dualitygap condition. For linear programs, these two conditions are equivalent [24, Thm. 1.3.3]. Later we will use both conditions to deﬁne and simplify the mathematical program with equilibrium constraints for vertiport selection.
Let c˜ = c+p and e˜ = q. One can verify that the conditions in (9a), (9c), and (10) together imply the constraints in (3), (4), (6), (5), and (7). Hence the equilibria model in Deﬁnition 1 satisﬁes the second and the third assumptions we introduced at the beginning of this section.
Furthermore, the conditions in Proposition 1 also implies that only routes with the minimum accumulated travel time are used, a property known as the Wardrop equilibrium principle [23]. To see this implication, we deﬁne the set of route vectors from node i to destination node s(j) as follows:

P(i, s(j)) =

u ∈ {0, 1}nl [Eu]i = 1, [Eu]s(j) = −1, . [Eu]k = 0, ∀k = i, s(j). (12)

Intuitively, each vector u in set P(i, s(j)) deﬁnes a sequence of links connecting node i and node s(j) in a head-to-tail fashion; link k is on the route deﬁned by u if and only if [u]k = 1.
Based on the above deﬁnition, the following corollary shows that any tuple {X, U, V, p, q} satisfying the conditions in Proposition 1 implies that any used routes has the lowest accumulated travel time, where the travel time of link k is given by [c + p + Dq]k.

Corollary 1. Let {X, U, V, p, q} satisfy the conditions in (9) and (10), and c := c + p + Dq. Let i ∈ {1, 2, . . . , nn} and j ∈ {1, 2, . . . , nd} such that i = s(j) and [S]i,s(j) > 0. If u ∈ P(i, s(j)) and [X]kj > 0 for all k such that [u ]k = 1, then the following condition holds for all u ∈ P(i, s(j)):

c u ≤ c u.

(13)

Corollary 1 shows that the equilibria model in Deﬁnition 1 also satisﬁes the ﬁrst assumption we introduced at the beginning of this section: any routes with positive trafﬁc ﬂow has the lowest accumulated time of travel.
Alternatively, one can predict the trafﬁc equilibria using an extension of the Beckmann model, rather than an extension of the Nesterov & de Palma model [25]. However, the Beckmann model result in a set equilibrium conditions with more nonlinear equality constraints than those in Nesterov & de Palma model [12], [13]. On the other hand, studies have shown that the Nesterov & de Palma model and the Beckmann model give similar prediction results. Therefore here we chose the Nesterov & de Palma model as the basis of our equilibria model.

IV. VERTIPORT SELECTION VIA MIXED-INTEGER
PROGRAMS
We now introduce a mathematical model that selects the location and capacity of vertiports in a hybrid air-ground transportation network as an effort to optimize the resulting trafﬁc equilibria. In particular, we aim to change the optimal solution of linear program (8) by choosing the entries in the vertiport-capacity vector g among discrete values–including zero values, in which case the corresponding vertiport location is discarded.
Throughout we make the following assumptions on linear program (8).

Assumption 1. Linear program (8) is feasible and has a bounded optimal value.

Assumption 1 implies that link capacity and vertiport capacity in the hybrid air-ground transportation network are large enough to accommodate the trafﬁc demand, i.e., the ﬂow conservation constraints in (3) and capacity constraints in (4) and (6) hold simultaneously. Such an assumption trivially holds in practice, since the ground transportation network alone can accommodate the trafﬁc demand, even without adding any vertiports and air transportation networks.
Based on the above assumption, we will ﬁrst deﬁne the objective function for vertiport selection problem in

Section IV-A, then deﬁne a mathematical program with equilibrium constraints (MPEC) for vertiport selection. We further prove that this MPEC is equivalent to a mixed integer linear program (MILP) in Section IV-B.

A. Vertiport selection via MPEC
We now introduce the mathematical problem for vertiport location and capacity selection. To this end, we ﬁrst introduce three components of the vertiport selection problem: the design variables, the objective function, and the constraints.
1) The design variables: First, we introduce the design variable of the vertiport selection problem. To this end, we start with the following assumption on the vertiport capacity vector g.
Assumption 2. There exists G ∈ Rn+v×nm such that the vertiport capacity vector g in Deﬁnition 1 satisﬁes the following constraints:

[g]i ∈ {0, [G]i1, [G]i2, . . . , [G]i,nm },
where [G]i1 < [G]i2 < · · · < [G]i,nm for all i = 1, 2, . . . , nv.

Assumption 2 states that the capacity of the ith vertiport is selected from an increasing sequence {0, [G]i1, [G]i2, . . . , [G]i,nm }. For example, if nm = 3, then the capacity of the i-th vertiport can be zero–in this case, this vertiport is discarded–or a small, medium, or large value, denoted by [G]i1, [G]i2, and [G]i3, respectively.
Based on Assumption 2, we deﬁne the selection matrix as follows. Let B ∈ Rnv×nm be a binary matrix such that [g]i = [G]ij if and only if [B]ij = 1. Then Assumption 2 holds if and only if
g = (B G)1m, B1m ≤ 1v, B ∈ {0, 1}nv×nm . (14)

In other words, each choice of B that satisﬁes the constraints in (14) corresponds to a value of capacity vector g that satisﬁes Assumption 2. In the following, we will use binary matrix B as our design variable in the vertiport selection problem.
2) The objective function: Given a set of vertiport with corresponding capacity, we will introduce a quantitative measure for the quality of the trafﬁc equilibria. To this end, given a selected capacity vector g, let {X, U, V, p, q} be a tuple that satisﬁes the the equilibrium conditions in Proposition 1. We evaluate the quality of this tuple using the following network loading function:

(X, p, q) := (c + p + Dq) X1d

nl

= [c + p + Dq]k [X1d]k .

(15)

k=1

ck

xk

Here the value of ck is the travel time on link k at the equilibrium: it is the sum of the free travel time [c]k and the extra time delay caused by the congestion on the link
and nodes, given by [p + Dq]k. The value of xk is the total amount of travelers entering or exiting link k per unit time1.

1At a static equilibrium, the amount of travelers entering and exiting the same link are the same; see [17].

Assumption 2 states that the location and capacity of the vertiports depend on a binary selection matrix B: if
nj=m1[B]ij = 0, then candidate vertiport i is not selected; if [B]ij = 1, then vertiport i is selected with capacity [G]ij at the cost of [K]ij. In addition, the capacity selection for all the vertiports is subject to a budget constraints deﬁned by parameter γ.
3) The constraints: The ﬁrst set of constraints in our selection problem are given in (9), (10) (or (11)), and (14). Together these constraints deﬁne the coupling relation among the selection matrix B, the capacity vector g, and the static trafﬁc equilibria that correspond to the tuple {X, U, V, p, q}.
In addition, we also consider the following budget and logical constraints on the selection matrix B. First, constructing and maintaining a vertiport comes at a cost–which typically increases with the vertiport capacity. To impose a budget constraints in the vertiport selection problem, we introduce a cost matrix K ∈ Rnv×nc , where its entry [K]ij is the cost of selecting capacity [G]ij for the i-th vertiport. We let γ ∈ R denote the upper bound on the total cost of vertiport selection, then a budget constraint takes the following form:

1v (K B)1m ≤ γ.

(16)

Second, the choice of vertiport location are often subject to additional logical constraints: for example, two locations close to each other cannot be selected simultaneously due to noise management regulations, some locations must be selected as an air trafﬁc hub. To account for these logical constraints, we consider the following linear constraints on the selection matrix B

A vec(B) ≤ b,

(17)

where vec : Rnv×nm → Rnvnm is a vectorization map such that [vec(B)](i−1)nv+j = Bij for all i = 1, 2, . . . , nv and j = 1, 2, . . . , nm, A ∈ Rnb×(nvnm) and h ∈ Rnb deﬁnes all the logical constraints on matrix B.
Example 2. To illustrate the logical constraints on vertiport location, we consider the case with two candidate vertiport locations, and each vertiport has two candidate capacity value, i.e., nv = nm = 2. In this case, If we let

A=

1111 −1 −1 −1 −1

,

b=

1 −1

,

(18)

then the constraint in (17) implies that one and only one of the two candidate vertiport location can be selected, i.e.,

[B]11 + [B]12 + [B]21 + [B]22 = 1.

(19)

4) The MPEC for vertiport selection: We now introduce the following optimization problem that selects the value of capacity vector g as an effort to reduce the network loading deﬁned in (15):

Vertiport selection via MPEC

minimize (c + p + Dq) X1d,
g,B,p,q, X,U,V

subject to EX = S, X1d ≤ f, DX1d ≤ g,

(c + p + Dq)1d = E V + U

X ≥ 0, U ≥ 0, p ≥ 0, q ≥ 0,

(20)

c X1d + f p + g q = tr(V S),

g = (G B)1m, B1m ≤ 1v,

1v (K B)1m ≤ γ, A vec(B) ≤ b, B ∈ {0, 1}nv×nm .

Optimization (20) is a mathematical program with equilibrium constraints (MPEC): it includes the equilibrium conditions in (9) and (11) as part of its constraints. Due to Proposition 2, one can equivalently replace the duality gap constraint in optimization (20)–which was ﬁrst introduced in (11)–with the complementarity constraints in (10). However, such replacement introduces even more bilinear functions of the unknowns. Hence we choose to write optimization in its current form; a similar MPEC was also used in electriﬁed ground network design [19].
A global optimal solution of optimization (20) is difﬁcult to compute, since its objective function and constraints of optimization (20) contains bilinear function of unknowns, such as p X1d and g q.
B. Reformulation of MPEC as an equivalent MILP
We now show that the MPEC in (20), a bilinear mixed integer optimization problem, is equivalent to a mixed integer linear program (MILP). As a result, one can compute a global optimal solution of optimization (20) using off-theshelf optimization software, such as GUROBI [26].
As our ﬁrst step, the following proposition shows that, how to replace the bilinear constraints in optimzation 20 with a linear one.
Proposition 2. Let G ∈ Rn+v+×nm . There exists a large enough µ ∈ R++ such that the following two set of conditions are equivalent.
1) There exists δ ∈ R, q ∈ Rnv , B ∈ {0, 1}nv×nm and g ∈ Rnv such that
δ = g q, g = (G B)1m, B1m ≤ 1v, q ≥ 0. (21)
2) There exists δ ∈ R, q ∈ Rnv , B ∈ {0, 1}nv×nm and Y ∈ Rnv×nm , such that
δ = 1v Y 1m, 0 ≤ Y ≤ µB, B1m ≤ 1v, (22) 0 ≤ G (q1m) − Y ≤ µ(1v1m − B), q ≥ 0.
Proof. See Appendix VII-C.
Proposition 2 allows us to replace the bilinear function g q, appearing in the constraints of optimization (20), with a linear function of an auxiliary matrix Y .

Our next step is to show the bilinear objective function of optimization (20) is also equivalent to a linear one. To this end, by using Proposition 1 again we can show the following:
p X1d = f p, q DX1d = g q.
Next, thanks to Proposition 2, we can further replace the inner product q g with a linear function of the auxiliary matrix Y . By combining these results together, we can replace the bilinear objective function in (20) with a linear one.
Equipped with these results, we can reformulate optimization (20) as the following equivalent mixed integer linear program, where µ is a large enough positive scalar.
Vertiport selection via MILP
minimize c X1d + f p + 1v Y 1m
B,p,q,Y, X,U,V
subject to EX = S, X1d ≤ f, DX1d ≤ (G B)1m,
(c + p + D q)1d = E V + U X ≥ 0, U ≥ 0, p ≥ 0, q ≥ 0,
c X1d + f p + 1v Y 1m = tr(V S), 0 ≤ G (q1m) − Y ≤ µ(1v1m − B), B1m ≤ 1v, 1v (K B)1m ≤ γ, 0 ≤ Y ≤ µB, A vec(B) ≤ b, B ∈ {0, 1}nv×nm .
(23)
Optimization (23) is a MILP: its objective function and constraints only depend on linear function of the unknowns, and it contains binary unknown matrix B. One can solve such MILP and obtain a global optimal solution using offthe-shelf optimization software.
V. NUMERICAL EXPERIMENTS
We demonstrate our vertiport selection approach using the Anaheim ground transportation network model developed in [27], which contains more than 400 nodes and 900 links. Our goal is to numerically demonstrate the effects of adding different vertiports to an existing ground transportation network in terms of trafﬁc loading in the network.
The Anaheim ground transportation network model consists of a well-deﬁned arterial grid system integrated with an extensive freeway system. See Fig. 2 for an illustration 2. The model includes the data for 1) the incidence matrix, 2) the demand matrix, 3) the free travel time, and 4) the link capacity. Based on these data, we construct the Nesterov & de Palma model for the ground transportation network, which is known to produce similar results as the Beckmann model [18].
In addition to the Anaheim ground transportation network, we construct an air transportation network as follows. Based on their location and travel demands, we choose 7 nodes in
2The map image we used are generated by Mapbox https://www. mapbox.com.

Fig. 2. The Anaheim network where the candidate vertiport locations are marked with colored circles.

the Anaheim network as candidate location for vertiports; see Fig. 2 for an illustration. The capacity of each vertiport can be either 600 or 1200 takeoffs and landing per hour; choosing these capacity will take 1 or 2 units of cost. We add an air link to each pair of vertiports if their physical distance is greater than the median of the pairwise distance of all the nodes in the Anaheim network. The free travel time of these air links are set to be proportional to the corresponding distance, and the ﬂow capacity is ﬁxed to be 80 ﬂights per hour for all air links.
We also consider the following budget and logical constraints on the vertiport locations. First, the total selection budget γ is chosen such that γ ∈ [5, 11]. Second, the locations marked in Fig. 2 are subject to the logical constraints listed in Tab. I.

TABLE I LOGICAL CONSTRAINTS FOR VERTIPORT LOCATIONS MARKED IN FIG. 2

Marker color red
magenta blue green

Constraints on the corresponding locations both are selected
at least one is selected one and only one is selected one and only one is selected

We solve optimization (23) with the above choice of parameters. To demonstrate our results, we deﬁne the following notion of link loading for each link k = 1, 2, . . . , nl:

k(X, p, q) = [c + p + Dq]k[X1d]k.

(24)

Intuitively, k denotes the number of vehicles traveling on link k at the equilibrium–which is also the summand in the total link loading deﬁned in (15). Fig. 3 shows the link loading in the ground and air networks when we let choose the budget to be γ = 8. In this case, a total of six vertiports are selected, and only two of them has the larger capacity value 1200: the one near Westminster and the one near Villa Park; the latter fact is consistent with the air link loading distribution in Fig. 3: the vertiports near Westminster and

Villa Park are connecting some of the ﬂight legs with the highest loading, hence they necessarily need larger capacity.

(a) Air trafﬁc network loading.

Fig. 4. The total link loading reduction in the ground network due to vertiport addition for different budget value γ.

Fig. 5. The number of ground links whose link loading decrease (blue) and increase (orange) due to vertiport addition with different budget value γ.

(b) Ground trafﬁc network loading.
Fig. 3. The optimal air and ground trafﬁc network loading when vertiport selection budget γ = 8. The shape of the marker indicates the capacity of the corresponding vertiport: square marker means capacity value 600, costs one unit in the budget; triangle markers means capacity value 1200, which costs 2 units in the budget.
We also show how does the budget value γ in vertiport selection affect the link loading in the ground trafﬁc network. Intuitively, adding vertiports will reduce the ground link loading by providing alternative means of transportation. Furthermore, as the budget increases, the selected vertiports can support an air transportation network with larger volume of air trafﬁc, and consequently, the ground link loading will decrease more. These intuitions are conﬁrmed by Fig. 4 and Fig. 5, which shows the sum of the link loading reduction in the ground network increases with the budget value, and so does the number of ground links with decreased loading. Observe that some of the ground links also have increased loading after the addition of the vertiports. This phenomenon agrees with our intuition that adding vertiports can create extra ground trafﬁc ﬂows on the way to and from the vertiports.

VI. CONCLUSION
We introduce a mathematical model to select the optimal vertiport location and capacity for minimizing the trafﬁc congestion in a hybrid air-ground transportation network. Our model is equivalent to a mixed-integer linear program, and we demonstrate this model using the Anaheim transportation network.
Our work also opens some new research questions. For example, although the identiﬁcation of the parameters for ground transportation networks–such as free travel time and link capacity–are well studied in the literature, similar results are still missing for the air transportation networks. In order to use the mathematical models we developed, it is important to identify these parameters using realistic air trafﬁc data. Another example is to consider the impacts of different weather conditions in the vertiport selection problem. Since weather conditions are more likely to affect the operation of aircraft than automobiles, it is critical to ensure the air transportation network is robust against temporary capacity decrease caused by extreme weather conditions. We aim to answer these open questions in our future work.

VII. APPENDIX A. Proof of Proposition 1
We start by deriving the dual of linear program (8). Let the Lagrangian be deﬁned as

L(X, U, V, p, q) = c X1d − tr(V EX) + tr(V S) (25)
− tr(U X) + p (X1d − f ) + q (DX1d − g).

The dual of linear program is given by

maximize ψ(U, V, p, q)

U,V,p,q

(26)

subject to U ≥ 0, p ≥ 0, q ≥ 0.

where ψ(U, V, p, q) = minX L(X, U, V, p, q). Since matrix trace is invariant under cyclic permutation, we have

c X1d = tr(1dc X), p X1d = tr(1dp X), q DX1d = tr(1dq DX).

Substitute the above equalities into (25), we can show the following
∂ L(X, U, V, p, q)
∂X ∂
= ∂X tr((1d(c + p + q D) − V E − U )X) = (c + p + Dq)1d − E V − U

Since L(X, U, V, p, q) is a linear function of X, we
have ψ(U, V, p, q) = L(X, U, V, p, q) if and only if ∂∂X L(X, U, V, p, q) = 0. Therefore we can rewrite optimization (26) equivalently as follows

maximize tr(V S) − f p − g q
U,V,p,q
subject to (c + p + Dq)1d = E V + U (27) U ≥ 0, p ≥ 0, q ≥ 0.

Using [24, Thm. 1.3.3], we conclude that X and U, V, p, q are optimal for linear program (8) and (27), respectively, if and only if the primal and dual feasibility condition in (9) and the complementary slackness condition (10) are satisﬁed. Furthermore, the complementary slackness conditions in (10) are equivalent to the zero duality gap condition in (11).

B. Proof of Corollary 1

Since u , u ∈ P(i, s(j)), by pre-multiplying equation (9) with u and u and we can show the following:

nl
(u ) c = Vij − Vs(j),j + [u ]j [U ]kj ,
k=1 nl
u c = Vij − Vs(j),j + [u]j [U ]kj .
k=1

(28a) (28b)

In addition, the constraints in (9c) and (10) together implies that [U ]kj = 0 for all k such that [X]kj > 0. Combining this fact with the assumption that [X]kj > 0 for all k such that [u ]k = 1, we conclude that [U ]kj = 0 for all k such that [u ]k = 1. Hence

nl
(u ) c = Vij −Vs(j),j + [u ]j [U ]kj = Vij −Vs(j),j . (29)
k=1

By combining (28) and (29), we obtain the following
nl
(u ) c = Vij − Vs(j),j = u c − [u]j[U ]kj ≤ u c, (30)
k=1
where the last step is because u and U are both elementwise nonnegative.

C. Proof of Proposition 2
First, suppose δ, q, B and g satisfy the constraints in (21). Let [Y ]ij = [g]i[qt]i[B]ij for all i = 1, 2, . . . , nv and j = 1, 2, . . . , nm, and µ = maxi,j [q]i[G]ij. Then one can verify that δ, q, B and Y satisfy the constraints in (22).
Second, suppose δ, q, B and Y satisfy the constraints in (22) for some sufﬁciently large µ ∈ R++. The constraints B ∈ {0, 1}nv×nm and B1nm ≤ 1nv implies that each row of matrix B can have at most one entry equals one. Hence we can obtain an unique vector g by deﬁning its i-th entry as follows:

[g]i = [G]ij, if [B]ij = 1,

0,

if [B]ij = 0 for all j = 1, 2, . . . , nm.

(31)

Next, since µ ∈ R++ is sufﬁciently large, an upper bound

of µ can be treated as redundant. As a result, if [B]ij =

0, then the constraints in (22) implies that [Y ]ij = 0 and

[G]ij[q]i ≥ 0. Since q ≥ 0 and G ≥ 0, the latter constraint

is redundant. Furthermore, if [B]ij = 1, then the constraints

in (22) implies that

0 ≤ [Y ]ij , [G]ij [qt]i = [Y ]ij .

By combining the above two cases with the deﬁnition in

(31), we conclude that

nv i=1

nj=m1[Y ]ij =

ni=v1[g]i[q]i for

all i = 1, 2, . . . , nv and j = 1, 2, . . . , nm. Therefore, δ, q, B

and g satisfy the constraints in (21).

ACKNOWLEDGMENT
The authors would like to thank Rishabh Thakkar and Jorge Martinez Zapico for their help in obtaining trafﬁc data, and Aditya Deole, Shahriar Talebi, and Kuang-Ying Ting for helpful discussions.

REFERENCES
[1] L. A. Garrow, B. J. German, and C. E. Leonard, “Urban air mobility: A comprehensive review and comparative analysis with autonomous and electric ground transportation for informing future research,” Transp. Res. C, vol. 132, p. 103377, 2021.
[2] X. Sun, S. Wandelt, M. Husemann, and E. Stumpf, “Operational considerations regarding on-demand air mobility: A literature review and research challenges,” J. Adv. Transp., vol. 2021, 2021.
[3] N. Venkatesh, A. P. Payan, C. Y. Justin, E. Kee, and D. Mavris, “Optimal siting of sub-urban air mobility (suam) ground architectures using network ﬂow formulation,” in AIAA Aviation Forum, 2020, p. 2921.
[4] E. Lim and H. Hwang, “The selection of vertiport location for ondemand mobility and its application to seoul metro area,” Int. J. Aeronaut. Space Sci., vol. 20, no. 1, pp. 260–272, 2019.
[5] S. Rajendran and J. Zack, “Insights on strategic air taxi network infrastructure locations using an iterative constrained clustering approach,” Transp. Res. E, vol. 128, pp. 470–505, 2019.
[6] J. Jeong, M. So, and H.-Y. Hwang, “Selection of vertiports using kmeans algorithm and noise analyses for urban air mobility (uam) in the seoul metropolitan area,” Appl. Sci., vol. 11, no. 12, p. 5729, 2021.

[7] M. Daskilewicz, B. German, M. Warren, L. A. Garrow, S.-S. Boddupalli, and T. H. Douthat, “Progress in vertiport placement and estimating aircraft range requirements for evtol daily commuting,” in Proc. AIAA Aviation Technol. Integr. Oper. Conf., 2018, p. 2884.
[8] B. German, M. Daskilewicz, T. K. Hamilton, and M. M. Warren, “Cargo delivery in by passenger evtol aircraft: A case study in the san francisco bay area,” in Proc. AIAA Aerosp. Sci. Meeting, 2018, p. 2006.
[9] K. R. Antcliff, M. D. Moore, and K. H. Goodrich, “Silicon valley as an early adopter for on-demand civil vtol operations,” in Proc. AIAA Aviation Technol. Integr. Oper. Conf., 2016, p. 3466.
[10] K. Ploetner, C. Al Haddad, C. Antoniou, F. Frank, M. Fu, S. Kabel, C. Llorca, R. Moeckel, A. Moreno, A. Pukhova, et al., “Long-term application potential of urban air mobility complementing public transport: an upper bavaria example,” CEAS Aeronaut. J, vol. 11, no. 4, pp. 991–1007, 2020.
[11] R. Z. Farahani, E. Miandoabchi, W. Y. Szeto, and H. Rashidi, “A review of urban transportation network design problems,” Eur. J. Oper. Res., vol. 229, no. 2, pp. 281–302, 2013.
[12] H. Yang and M. G. H. Bell, “Models and algorithms for road network design: a review and some new developments,” Transport Reviews, vol. 18, no. 3, pp. 257–278, 1998.
[13] A. Migdalas, “Bilevel programming in trafﬁc planning: Models, methods and challenge,” Journal of global optimization, vol. 7, no. 4, pp. 381–405, 1995.
[14] M. Patriksson, The trafﬁc assignment problem: models and methods. Courier Dover Publications, 2015.
[15] M. Beckmann, C. B. McGuire, and C. B. Winsten, “Studies in the economics of transportation,” Tech. Rep., 1956.
[16] Y. Nesterov, “Stable trafﬁc equilibria: properties and applications,” Optim. Eng., vol. 1, no. 1, pp. 29–50, 2000.
[17] Y. Nesterov and A. de Palma, “Stationary dynamic solutions in congested transportation networks: summary and perspectives,” Netw. Spatial Econ., vol. 3, no. 3, pp. 371–395, 2003.
[18] F. A. Chudak, V. Dos Santos Eleuterio, and Y. Nesterov, “Static trafﬁc assignment problem: A comparison between Beckmann (1956) and Nesterov & de Palma (1998) models,” in Proc. Swiss Transp. Res Conf. ETH, 2007.
[19] W. Wei, L. Wu, J. Wang, and S. Mei, “Expansion planning of urban electriﬁed transportation networks: A mixed-integer convex programming approach,” IEEE Trans. Transp. Electriﬁc., vol. 3, no. 1, pp. 210–224, 2017.
[20] X. Wang, M. Shahidehpour, C. Jiang, and Z. Li, “Coordinated planning strategy for electric vehicle charging stations and coupled trafﬁcelectric networks,” IEEE Transactions on Power Systems, vol. 34, no. 1, pp. 268–279, 2018.
[21] F. Xia, H. Chen, M. Shahidehpour, W. Gan, M. Yan, and L. Chen, “Distributed expansion planning of electric vehicle dynamic wireless charging system in coupled power-trafﬁc networks,” IEEE Transactions on Smart Grid, 2021.
[22] M. Patriksson and R. T. Rockafellar, “A mathematical model and descent algorithm for bilevel trafﬁc management,” Transportation Science, vol. 36, no. 3, pp. 271–291, 2002.
[23] J. G. Wardrop, “Some theoretical aspects of road trafﬁc research.” Proceedings of the institution of civil engineers, vol. 1, no. 3, pp. 325–362, 1952.
[24] A. Ben-Tal and A. Nemirovski, Lectures on Modern Convex Optimization: Analysis, Algorithms, and Engineering Applications. SIAM, 2001.
[25] T. Larsson and M. Patriksson, “Side constrained trafﬁc equilibrium models—analysis, computation and applications,” Transportation Research Part B: Methodological, vol. 33, no. 4, pp. 233–264, 1999.
[26] Gurobi Optimization, LLC, “Gurobi Optimizer Reference Manual,” 2021. [Online]. Available: https://www.gurobi.com
[27] Transportation Networks for Research Core Team, “Transportation networks for research,” https://github.com/bstabler/ TransportationNetworks, 2016, accessed: 2022-01-01.

