{"id": "4b9795493a937b9034be9c26afab23f6dc751f62", "content": {"title": "Neuro-Symbolic Language Modeling with Automaton-augmented Retrieval", "abstract": "Retrieval-based language models (R-LM) model the probability of natural language text by combining a standard language model (LM) with examples retrieved from an external datastore at test time. While effective, a major bottleneck of using these models in practice is the computationally costly datastore search, which can be performed as frequently as every time step. In this paper, we present RETOMATON \u2013 retrieval automaton \u2013 which approximates the datastore search, based on (1) clustering of entries into \u201cstates\u201d, and (2) state transitions from previous entries. This effectively results in a weighted finite automaton built on top of the datastore, instead of representing the datastore as a flat list. The creation of the automaton is unsupervised, and a RETOMATON can be constructed from any text collection: either the original training corpus or from another domain. Traversing this automaton at inference time, in parallel to the LM inference, reduces its perplexity, or alternatively saves up to 83% of the nearest neighbor searches over kNN-LM (Khandelwal et al., 2020), without hurting perplexity.", "year": 2022, "ssId": "4b9795493a937b9034be9c26afab23f6dc751f62", "arXivId": "2201.12431", "link": "https://arxiv.org/pdf/2201.12431.pdf", "openAccess": true, "authors": ["Uri Alon", "Frank F. Xu", "Junxian He", "Sudipta Sengupta", "D. Roth", "Graham Neubig"], "text": {"neuro": 18, "symbolic": 19, "language": 48, "modeling": 21, "automaton": 57, "augmented": 18, "retrieval": 34, "arxiv": 9, "cs": 2, "cl": 1, "jan": 1, "uri": 1, "alon": 1, "frank": 1, "xu": 3, "junxian": 1, "sudipta": 2, "sengupta": 1, "dan": 1, "roth": 1, "graham": 2, "neubig": 9, "technologies": 4, "institute": 1, "carnegie": 1, "mellon": 1, "university": 1, "amazon": 2, "aws": 2, "ai": 1, "labs": 1, "ualon": 1, "fangzhex": 1, "junxianh": 1, "gneubig": 1, "cmu": 1, "edu": 1, "drot": 1, "com": 5, "abstract": 1, "based": 9, "models": 22, "lm": 67, "model": 30, "probability": 6, "natural": 7, "text": 13, "combining": 2, "standard": 6, "examples": 8, "retrieved": 19, "external": 3, "datastore": 64, "test": 11, "time": 48, "effective": 3, "major": 2, "bottleneck": 4, "practice": 1, "computationally": 2, "costly": 1, "search": 43, "performed": 7, "frequently": 1, "step": 15, "paper": 2, "retomaton": 57, "approximates": 2, "clustering": 38, "entries": 29, "transitions": 8, "previous": 6, "effectively": 1, "weighted": 7, "nite": 10, "built": 2, "instead": 6, "representing": 2, "list": 2, "creation": 5, "unsupervised": 4, "constructed": 8, "collection": 5, "original": 5, "training": 26, "corpus": 4, "domain": 20, "traversing": 7, "inference": 7, "parallel": 3, "reduces": 8, "perplexity": 33, "alternatively": 2, "saves": 6, "nearest": 26, "neighbor": 12, "searches": 33, "knn": 66, "khandelwal": 14, "et": 64, "al": 64, "hurting": 2, "introduction": 1, "lms": 8, "improve": 4, "neural": 26, "variety": 1, "tasks": 1, "unconditional": 1, "guu": 6, "machine": 15, "translation": 14, "zhang": 4, "gu": 3, "question": 2, "answering": 2, "karpukhin": 2, "ram": 3, "code": 4, "generation": 3, "hayati": 2, "hashimoto": 4, "key": 12, "ingredient": 1, "ability": 1, "utilize": 1, "rely": 3, "information": 6, "encoded": 1, "weights": 4, "component": 1, "base": 29, "references": 2, "prediction": 1, "fusion": 1, "improves": 1, "perspectives": 1, "including": 3, "higher": 7, "accuracy": 4, "adaptability": 1, "jiang": 2, "reduced": 1, "size": 2, "borgeaud": 5, "provide": 2, "provenance": 1, "predictions": 1, "allow": 4, "modifying": 1, "dataset": 5, "retraining": 1, "critical": 1, "frequent": 4, "hinders": 1, "practical": 1, "settings": 8, "neighbors": 22, "prominent": 1, "example": 11, "predicts": 1, "token": 24, "linearly": 1, "interpolating": 3, "output": 3, "non": 4, "parametric": 3, "distribution": 11, "searching": 4, "weighting": 3, "according": 3, "distance": 5, "current": 3, "context": 12, "notably": 1, "generated": 3, "introducing": 1, "severe": 2, "overhead": 2, "signi": 3, "cantly": 2, "slower": 2, "forward": 3, "pass": 4, "approach": 4, "main": 6, "insight": 2, "hint": 1, "future": 2, "steps": 7, "save": 6, "repetitive": 1, "later": 2, "speci": 7, "cally": 2, "construct": 3, "wfa": 2, "existing": 1, "keeping": 4, "pointers": 20, "completely": 4, "way": 2, "allows": 10, "sporadic": 1, "infrequent": 1, "exact": 2, "cheaper": 2, "traversal": 11, "illustrated": 3, "figure": 42, "concretely": 1, "applying": 1, "strong": 2, "wikitext": 21, "set": 38, "reducing": 1, "saving": 3, "additional": 8, "adaptation": 8, "simply": 2, "constructing": 4, "different": 17, "ne": 19, "tuned": 10, "decrease": 1, "iden": 1, "nn": 1, "president": 14, "vice": 1, "signed": 1, "joe": 9, "osep": 1, "biden": 10, "robinette": 4, "target": 5, "george": 1, "washington": 1, "illustration": 2, "returns": 2, "entry": 21, "gure": 2, "tuple": 2, "value": 15, "pointer": 9, "hidden": 3, "points": 3, "appears": 4, "close": 4, "clustered": 3, "form": 5, "decodes": 1, "performing": 10, "multiple": 4, "traversals": 1, "nd": 3, "useful": 2, "dashed": 1, "arrows": 2, "denote": 3, "allowed": 3, "taken": 1, "decoding": 1, "compared": 7, "tuning": 3, "finally": 2, "perform": 12, "thorough": 2, "ablation": 4, "study": 4, "showing": 1, "contribution": 4, "components": 1, "analyzing": 1, "tradeoff": 3, "coarse": 2, "vs": 4, "grained": 4, "background": 1, "estimates": 2, "trained": 11, "provided": 3, "knearest": 1, "negative": 3, "sequence": 7, "tokens": 10, "plm": 10, "let": 3, "function": 7, "maps": 3, "xed": 1, "length": 9, "vector": 5, "transformer": 3, "self": 2, "attention": 3, "layer": 2, "constructs": 1, "single": 8, "include": 3, "ith": 1, "ci": 16, "wi": 16, "pair": 3, "ned": 2, "pairs": 2, "queries": 3, "retrieve": 9, "dist": 4, "tween": 1, "typically": 1, "squared": 1, "vocabulary": 5, "item": 1, "computed": 3, "proportionally": 1, "exponent": 1, "summing": 1, "occurrences": 2, "values": 9, "pknn": 7, "exp": 2, "interpolation": 7, "scalar": 1, "hyperparameter": 2, "notice": 3, "introduces": 2, "section": 12, "avoid": 2, "majority": 2, "building": 1, "automata": 10, "datastores": 1, "build": 3, "knnlm": 2, "traverse": 2, "estimate": 1, "demonstrate": 1, "process": 2, "running": 2, "nitions": 1, "sequences": 11, "autoregressive": 3, "nes": 1, "joseph": 5, "th": 8, "contains": 1, "sentences": 2, "ii": 2, "encoding": 2, "pre": 3, "successor": 1, "cluster": 9, "vectors": 2, "share": 2, "rd": 2, "create": 1, "detailed": 4, "finite": 1, "initial": 4, "transition": 9, "denotes": 2, "power": 1, "weight": 3, "unlike": 1, "wfas": 1, "dynamic": 2, "depends": 4, "addition": 1, "input": 6, "note": 1, "imagine": 1, "retrieves": 1, "equation": 10, "sampling": 2, "argmax": 2, "equal": 4, "likely": 5, "near": 1, "contexts": 2, "followed": 2, "underlying": 1, "assumption": 1, "formulated": 1, "similarity": 2, "continuation": 1, "pi": 2, "index": 11, "outgoing": 3, "capture": 2, "grams": 12, "appeared": 5, "verbatim": 3, "able": 3, "generalize": 1, "unseen": 1, "phrases": 1, "cap": 1, "tured": 1, "ap": 1, "peared": 1, "sentence": 3, "suf": 1, "keys": 3, "automa": 1, "ton": 1, "includes": 3, "sur": 1, "rounded": 1, "marked": 2, "furthermore": 1, "containing": 2, "capturing": 2, "phrase": 2, "jospeh": 1, "algorithm": 3, "means": 25, "case": 3, "choice": 2, "kclust": 13, "determines": 1, "nal": 1, "number": 15, "ignoring": 1, "experiment": 4, "algorithms": 4, "source": 1, "allowable": 1, "clusters": 14, "pointed": 2, "formally": 2, "contained": 2, "dereferencing": 1, "operator": 1, "transitioning": 2, "currently": 2, "nodes": 1, "edges": 1, "represent": 1, "successiveness": 2, "shared": 3, "visiting": 1, "begins": 2, "union": 3, "belong": 1, "compute": 1, "follows": 1, "decision": 2, "continue": 5, "start": 4, "new": 11, "ways": 1, "experimented": 1, "alternatives": 1, "intuitive": 1, "greater": 1, "threshold": 2, "remaining": 3, "far": 1, "varying": 1, "control": 2, "trade": 1, "restarts": 2, "high": 3, "versus": 1, "lower": 5, "rare": 2, "low": 2, "intuition": 2, "appendix": 8, "sum": 1, "exponents": 1, "distances": 2, "consuming": 1, "normalize": 1, "ki": 2, "pauto": 6, "interpolate": 1, "experimental": 1, "setup": 1, "evaluate": 1, "implementation": 3, "experiments": 12, "uses": 6, "faiss": 10, "johnson": 3, "library": 5, "hyperparameters": 5, "baseline": 4, "implementations": 1, "special": 1, "matched": 1, "conduct": 1, "fair": 2, "evaluation": 2, "saved": 25, "half": 2, "precision": 2, "fp": 2, "creates": 2, "law": 22, "mt": 19, "difference": 4, "details": 2, "metrics": 1, "metric": 2, "focus": 1, "respect": 3, "fraction": 20, "foss": 42, "preliminary": 1, "measuring": 2, "wall": 16, "clock": 16, "dif": 2, "cult": 2, "reproduce": 2, "brittle": 2, "temporary": 3, "hardware": 7, "load": 4, "affected": 2, "contrarily": 1, "depend": 2, "engineering": 2, "factors": 3, "reproducible": 3, "empirically": 2, "analyze": 1, "identical": 3, "additive": 2, "constant": 2, "serves": 2, "good": 2, "proxy": 2, "data": 12, "merity": 2, "stan": 1, "dard": 1, "benchmark": 1, "wikipedia": 3, "validation": 20, "sets": 4, "vaswani": 2, "architecture": 1, "baevski": 3, "auli": 3, "adaptive": 5, "inputs": 1, "softmax": 2, "joulin": 2, "large": 3, "word": 1, "level": 1, "consists": 2, "layers": 2, "heads": 1, "dimensional": 3, "feedforward": 1, "amounting": 2, "parameters": 2, "english": 2, "german": 1, "released": 1, "koehn": 3, "knowles": 2, "resplit": 1, "aharoni": 2, "goldberg": 4, "tune": 1, "subword": 2, "units": 2, "sennrich": 2, "ng": 2, "wmt": 3, "news": 2, "crawl": 1, "barrault": 2, "baselines": 3, "compare": 2, "faster": 1, "approximate": 3, "recomputing": 1, "vary": 2, "uniformly": 1, "selecting": 1, "skip": 1, "random": 2, "adaptret": 24, "retrievalsaving": 1, "orthogonal": 2, "trains": 1, "light": 1, "mlp": 2, "predict": 3, "conceptual": 3, "skips": 4, "computes": 2, "contrast": 7, "entirely": 1, "backs": 1, "solely": 2, "discussion": 1, "differences": 1, "work": 9, "created": 1, "creating": 1, "train": 2, "rates": 1, "matching": 3, "best": 2, "surprisingly": 1, "attempt": 1, "explanation": 2, "performs": 5, "correct": 4, "general": 2, "included": 2, "twice": 1, "knns": 3, "equivalent": 1, "increasing": 1, "subset": 1, "newspapers": 1, "tested": 1, "documents": 1, "increase": 2, "gentle": 2, "ascent": 2, "increases": 6, "exponentially": 1, "caused": 2, "crucial": 1, "approximating": 2, "pruning": 1, "cases": 1, "interesting": 3, "datasets": 2, "particular": 1, "provides": 2, "stronger": 1, "effect": 2, "ected": 1, "believe": 2, "reason": 1, "gram": 5, "repetitiveness": 2, "figures": 1, "improving": 2, "fine": 1, "adapt": 1, "table": 4, "numbers": 1, "relative": 3, "reduction": 3, "parentheses": 1, "recreated": 1, "reduce": 1, "strengthen": 1, "contributions": 1, "tease": 1, "apart": 1, "spares": 1, "preprocessing": 1, "achieves": 3, "lowest": 1, "better": 2, "starting": 3, "consolidates": 1, "conjecture": 1, "performance": 1, "stems": 1, "boost": 1, "gap": 1, "longer": 4, "consecutive": 1, "granularity": 2, "smaller": 2, "larger": 5, "coarsegrained": 1, "noisy": 1, "greedy": 7, "advantage": 1, "requires": 3, "analysis": 6, "runs": 4, "version": 1, "roughly": 1, "bounded": 1, "streets": 3, "department": 1, "transportation": 1, "mdot": 1, "united": 1, "end": 2, "song": 2, "occur": 1, "red": 1, "shots": 1, "result": 1, "moved": 1, "locations": 1, "day": 3, "world": 3, "war": 1, "completed": 1, "lack": 1, "evidence": 1, "captured": 2, "selected": 2, "did": 1, "appear": 1, "merging": 1, "iterations": 1, "entire": 2, "achieve": 1, "perplexities": 1, "presents": 1, "degrades": 1, "qualitative": 1, "predicted": 2, "consecutively": 3, "highest": 1, "naturally": 1, "short": 2, "common": 1, "contain": 2, "band": 1, "memorize": 1, "compose": 1, "small": 2, "long": 7, "passage": 3, "endings": 2, "adaptively": 1, "chunks": 2, "histogram": 2, "lengths": 2, "vast": 1, "https": 8, "en": 2, "org": 3, "wiki": 2, "oh": 1, "knight": 1, "writer": 2, "scenario": 2, "unknown": 2, "lloyd": 2, "lonergan": 2, "experienced": 2, "newspaperman": 2, "employed": 2, "york": 2, "evening": 2, "surviving": 2, "gives": 2, "possibility": 2, "identifying": 2, "actors": 2, "home": 1, "mince": 1, "pie": 1, "apply": 1, "paragraph": 1, "articles": 1, "silent": 1, "dynamically": 3, "related": 1, "comparison": 4, "closest": 1, "suffers": 1, "weaknesses": 1, "apparently": 1, "likelihood": 1, "predicting": 2, "direction": 2, "expect": 2, "learning": 14, "factor": 1, "ef": 4, "ciency": 1, "disjoint": 1, "prevent": 2, "tting": 1, "cient": 3, "spending": 1, "require": 1, "methods": 8, "yogatama": 2, "prototype": 1, "chunk": 2, "implicitly": 1, "generalizes": 1, "approaches": 2, "essentially": 1, "individual": 1, "free": 1, "passages": 2, "hybrid": 1, "dyer": 2, "rijhwani": 2, "led": 1, "static": 1, "count": 2, "representations": 6, "weigh": 1, "scored": 1, "rnns": 3, "rastogi": 2, "lin": 2, "schwartz": 3, "peng": 2, "differs": 1, "providing": 1, "instances": 1, "enforcing": 1, "structure": 1, "extraction": 4, "networks": 5, "goes": 1, "giles": 4, "omlin": 2, "synthetic": 1, "simple": 1, "regular": 1, "languages": 1, "weiss": 3, "scaled": 1, "gru": 1, "lstm": 1, "architectures": 1, "extract": 1, "combine": 1, "conclusion": 1, "presented": 2, "suggest": 1, "promising": 1, "neurosymbolic": 1, "synergy": 1, "principles": 1, "applicable": 1, "ends": 1, "publicly": 1, "available": 1, "acknowledgments": 1, "thank": 1, "lucio": 1, "dery": 1, "vincent": 1, "hellendoorn": 2, "helpful": 1, "discussions": 1, "feedback": 1, "pretrained": 1, "proceedings": 17, "annual": 3, "meeting": 3, "association": 10, "computational": 10, "linguistics": 10, "pp": 20, "international": 8, "conference": 21, "bojar": 1, "costa": 1, "jussa": 1, "federmann": 1, "fishel": 1, "haddow": 2, "huck": 1, "malmasi": 1, "monz": 1, "muller": 1, "pal": 1, "post": 2, "zampieri": 1, "findings": 1, "fourth": 2, "volume": 7, "task": 3, "papers": 6, "florence": 1, "italy": 1, "august": 1, "doi": 1, "url": 4, "aclanthology": 1, "mensch": 1, "hoffmann": 1, "cai": 1, "rutherford": 1, "millican": 1, "driessche": 1, "lespiau": 1, "damoc": 1, "clark": 1, "retrieving": 1, "trillions": 1, "preprint": 4, "chen": 5, "wang": 4, "li": 5, "ren": 1, "zhu": 2, "liu": 1, "sptag": 3, "fast": 1, "github": 4, "microsoft": 1, "miller": 1, "sun": 2, "lee": 2, "extracting": 2, "order": 1, "recurrent": 3, "computation": 2, "cho": 1, "engine": 1, "guided": 1, "aaai": 1, "arti": 1, "cial": 2, "intelligence": 1, "guo": 2, "lindgren": 1, "geng": 1, "simcha": 1, "chern": 1, "kumar": 1, "accelerating": 1, "scale": 2, "anisotropic": 1, "quantization": 1, "pmlr": 3, "oren": 2, "liang": 2, "generating": 1, "editing": 1, "prototypes": 2, "transactions": 4, "tung": 1, "pasupat": 1, "chang": 1, "realm": 1, "pretraining": 1, "framework": 1, "structured": 1, "outputs": 1, "processing": 10, "systems": 4, "olivier": 1, "avvaru": 1, "yin": 1, "tomasic": 1, "empirical": 7, "berg": 2, "kirkpatrick": 2, "sparse": 3, "advances": 3, "cao": 1, "cheng": 1, "huang": 1, "kernel": 1, "smoothed": 1, "douze": 1, "jegou": 2, "billion": 1, "gpus": 3, "ieee": 1, "big": 1, "cisse": 1, "grangier": 1, "approximation": 1, "oguz": 1, "min": 1, "lewis": 3, "wu": 1, "edunov": 2, "yih": 1, "dense": 1, "open": 1, "emnlp": 1, "levy": 2, "jurafsky": 2, "zettlemoyer": 2, "generalization": 1, "memorization": 1, "openreview": 2, "net": 2, "forum": 2, "id": 3, "hklbjcekvh": 1, "fan": 1, "wcbofj": 1, "hjm": 1, "challenges": 1, "workshop": 1, "gormley": 1, "eisner": 2, "transducers": 1, "rational": 2, "relations": 1, "north": 3, "american": 3, "chapter": 3, "human": 3, "xiong": 1, "bradbury": 1, "socher": 1, "sentinel": 1, "mixture": 1, "generalizing": 1, "hybridizing": 1, "yee": 1, "ott": 1, "facebook": 1, "submission": 1, "rules": 1, "discrete": 1, "thomson": 2, "smith": 2, "recurrences": 1, "shachaf": 1, "berant": 1, "globerson": 1, "supervision": 1, "birch": 1, "words": 1, "shazeer": 1, "parmar": 1, "uszkoreit": 1, "jones": 1, "gomez": 1, "kaiser": 1, "polosukhin": 1, "need": 1, "yahav": 2, "counterexamples": 2, "deterministic": 1, "structural": 1, "locality": 1, "masson": 1, "autume": 1, "kong": 1, "semiparametric": 1, "utiyama": 1, "sumita": 1, "nakamura": 1, "guiding": 1, "pieces": 1, "cotterell": 1, "nitestate": 1, "transductions": 1, "rosenblum": 1, "anastasopoulos": 1, "lexically": 1, "aware": 1, "semi": 1, "supervised": 1, "ocr": 1, "correction": 1, "bridging": 1, "cnns": 1, "machines": 1, "brevity": 1, "repeat": 1, "intuitively": 1, "incorrect": 1, "restart": 1, "minimal": 1, "maximal": 1, "kneigh": 3, "loaded": 1, "gpu": 9, "reaching": 1, "slow": 1, "max": 1, "overall": 1, "preferring": 1, "directly": 2, "choosing": 1, "randomly": 1, "chose": 1, "match": 1, "coupled": 1, "things": 1, "pytorch": 2, "lookup": 1, "belonging": 1, "ran": 1, "cpu": 4, "cores": 1, "rtx": 2, "change": 1, "reported": 1, "alternative": 1, "scann": 1, "store": 1, "access": 1, "reading": 1, "latency": 2, "hard": 2, "drive": 2, "enables": 1, "curve": 2, "optimal": 3, "meaning": 1, "translated": 1, "penalty": 2, "bene": 2, "terms": 1, "http": 1, "rusty": 1, "setting": 1, "memory": 1, "option": 1, "reconstruct": 1, "api": 1, "implemented": 1, "support": 1, "batching": 1, "scales": 1, "pressure": 1, "overlap": 1, "scaling": 1, "gently": 1, "granularities": 1, "gures": 1, "facebookresearch": 2, "issues": 2, "percentage": 3, "types": 1}}}
