{"id": "bd2f3822801a7e2f933d06c261b8783764d8ce18", "content": {"title": "Understanding, Detecting, and Separating Out-of-Distribution Samples and Adversarial Samples in Text Classification", "abstract": "In this paper, we study the differences and commonalities between statistically out-of-distribution (OOD) samples and adversarial (Adv) samples, both of which hurting a text classi\ufb01cation model\u2019s performance. We conduct analyses to compare the two types of anomalies (OOD and Adv samples) with the in-distribution (ID) ones from three aspects: the input features, the hidden representations in each layer of the model, and the output probability distributions of the classi\ufb01er. We \ufb01nd that OOD samples expose their aberration starting from the \ufb01rst layer, while the abnormalities of Adv samples do not emerge until the deeper layers of the model. We also illustrate that the models\u2019 output probabilities for Adv samples tend to be more uncon\ufb01dent. Based on our observations, we propose a simple method to separate ID, OOD, and Adv samples using the hidden representations and output probabilities of the model. On multiple combinations of ID, OOD datasets, and Adv attacks, our proposed method shows exceptional results on distinguishing ID, OOD, and Adv samples.", "year": 2022, "ssId": "bd2f3822801a7e2f933d06c261b8783764d8ce18", "arXivId": "2204.04458", "link": "https://arxiv.org/pdf/2204.04458.pdf", "openAccess": true, "authors": ["David C. Chiang", "Hung-yi Lee"], "text": {"understanding": 2, "detecting": 6, "separating": 18, "distribution": 47, "samples": 210, "adversarial": 34, "text": 56, "classi": 65, "cation": 27, "arxiv": 5, "cs": 1, "cl": 1, "apr": 1, "cheng": 1, "han": 1, "chiang": 1, "national": 2, "taiwan": 2, "university": 2, "dcml": 1, "ntu": 2, "edu": 2, "tw": 2, "hung": 1, "yi": 4, "lee": 6, "hungyilee": 1, "abstract": 3, "paper": 9, "study": 1, "differences": 6, "commonalities": 1, "statistically": 3, "ood": 161, "adv": 169, "hurting": 1, "model": 53, "performance": 10, "conduct": 2, "analyses": 6, "compare": 6, "types": 14, "anomalies": 4, "id": 143, "ones": 17, "aspects": 3, "input": 31, "features": 37, "hidden": 40, "representations": 30, "layer": 41, "output": 18, "probability": 31, "distributions": 6, "er": 32, "nd": 17, "expose": 2, "aberration": 1, "starting": 5, "abnormalities": 1, "emerge": 1, "deeper": 8, "layers": 28, "illustrate": 3, "models": 28, "probabilities": 7, "tend": 4, "uncon": 6, "dent": 13, "based": 35, "observations": 7, "propose": 5, "simple": 6, "method": 27, "separate": 36, "multiple": 2, "combinations": 18, "datasets": 68, "attacks": 15, "proposed": 10, "exceptional": 2, "distinguishing": 2, "introduction": 2, "deep": 8, "learning": 8, "achieved": 2, "overwhelming": 1, "success": 3, "miscellaneous": 1, "benchmark": 3, "real": 4, "world": 4, "applications": 1, "despite": 2, "great": 1, "performances": 1, "degrade": 1, "faced": 3, "data": 29, "drawn": 2, "different": 60, "training": 7, "including": 7, "maliciously": 1, "created": 2, "adversaries": 6, "work": 16, "refer": 5, "dataset": 28, "examples": 16, "adversarially": 1, "intentionally": 1, "wicked": 1, "individuals": 2, "intending": 1, "bring": 2, "trained": 11, "argue": 1, "robust": 10, "able": 9, "distinguish": 6, "crafted": 2, "harm": 1, "treated": 1, "differently": 4, "detects": 1, "example": 5, "preprocess": 1, "non": 5, "feeding": 1, "sample": 25, "detected": 3, "prediction": 7, "result": 5, "sense": 2, "studied": 2, "natural": 17, "language": 21, "processing": 17, "nlp": 5, "detect": 7, "simultaneously": 1, "presented": 7, "previous": 5, "works": 3, "detection": 23, "groups": 5, "unclear": 3, "separates": 3, "inputs": 3, "categorized": 2, "falling": 2, "group": 3, "contrarily": 3, "preprint": 3, "review": 5, "considering": 3, "case": 8, "encounter": 1, "anomaly": 10, "act": 2, "important": 6, "identifying": 1, "develop": 1, "uni": 2, "ed": 3, "depth": 1, "awareness": 1, "kinds": 8, "hurt": 1, "fundamentally": 1, "aim": 4, "answer": 3, "questions": 5, "best": 4, "prior": 1, "answered": 1, "perform": 2, "perspectives": 1, "effective": 2, "stages": 1, "abundant": 2, "experiments": 12, "verify": 1, "effectiveness": 1, "contributions": 2, "follows": 3, "abnormal": 6, "highly": 3, "distinguishable": 1, "maximum": 23, "excellent": 1, "indicator": 9, "help": 2, "elegant": 1, "successful": 4, "staged": 2, "approach": 2, "attack": 15, "methods": 17, "setup": 4, "scrutinize": 1, "attempt": 1, "referring": 1, "need": 9, "ne": 16, "brie": 1, "introduce": 1, "generating": 4, "imdb": 32, "movie": 5, "binary": 4, "sentiment": 8, "contains": 4, "long": 3, "polar": 1, "reviews": 6, "goal": 4, "task": 3, "predict": 2, "piece": 1, "positive": 7, "negative": 5, "sst": 30, "containing": 1, "pithy": 1, "lengths": 3, "signi": 1, "cantly": 1, "ag": 27, "news": 32, "involves": 1, "classifying": 1, "articles": 1, "classes": 5, "topics": 2, "sports": 1, "business": 1, "science": 2, "tech": 1, "statistical": 2, "difference": 1, "include": 14, "styles": 1, "depends": 1, "viewpoint": 1, "involve": 1, "considered": 2, "simply": 3, "consider": 2, "hendrycks": 3, "gimpel": 2, "degree": 1, "section": 39, "serves": 1, "yelp": 23, "polarity": 17, "composed": 1, "restaurant": 1, "follow": 1, "yoo": 5, "et": 5, "al": 5, "synonym": 1, "substitution": 2, "textfooler": 18, "weighted": 3, "word": 8, "saliency": 2, "ren": 3, "pwws": 17, "bert": 22, "garg": 2, "ramakrishnan": 2, "bae": 20, "variant": 1, "called": 1, "tf": 21, "adj": 19, "generate": 2, "iteratively": 1, "substituting": 1, "words": 5, "benign": 8, "synonyms": 3, "ip": 1, "differ": 5, "determine": 2, "substituted": 1, "replaced": 1, "lters": 1, "legitimate": 1, "stricter": 1, "constraints": 1, "provided": 4, "textattack": 4, "library": 3, "generated": 5, "attacking": 7, "ers": 8, "tuned": 13, "roberta": 18, "introduced": 1, "details": 4, "appendix": 12, "experiment": 7, "making": 3, "total": 3, "did": 109, "dood": 42, "denote": 3, "speci": 7, "cally": 1, "train": 21, "denoted": 3, "form": 5, "test": 66, "dadv": 54, "instances": 17, "extract": 4, "set": 12, "invariant": 1, "counterparts": 3, "process": 2, "constructing": 1, "detailed": 2, "available": 2, "huggingface": 4, "number": 3, "adopt": 1, "pre": 4, "transformer": 3, "masked": 1, "mlms": 1, "current": 2, "community": 5, "better": 7, "detectors": 19, "attacked": 4, "far": 4, "low": 1, "rate": 1, "table": 19, "try": 3, "understand": 4, "exists": 1, "additionally": 1, "want": 7, "know": 3, "compared": 4, "going": 1, "deviate": 3, "count": 15, "type": 18, "score": 35, "tokens": 3, "interested": 2, "knowing": 3, "bag": 1, "ofword": 1, "bow": 16, "feature": 10, "sentence": 11, "sampled": 1, "vector": 2, "dimension": 2, "vocab": 1, "ulary": 1, "size": 3, "entry": 4, "idf": 3, "vo": 1, "cabulary": 1, "sets": 2, "vocabulary": 6, "tokenizing": 1, "sentences": 5, "tokenizer": 1, "baseuncased": 1, "base": 5, "procedure": 2, "calculate": 6, "inverse": 1, "document": 1, "frequency": 2, "token": 5, "figure": 36, "cosine": 10, "similarity": 13, "obtaining": 1, "idfs": 1, "counting": 1, "term": 3, "normalize": 1, "norm": 1, "mean": 2, "plot": 1, "scores": 8, "select": 4, "representative": 1, "uncased": 2, "change": 2, "look": 3, "lower": 3, "understandable": 1, "domains": 2, "behave": 2, "spring": 1, "fact": 2, "swapping": 1, "hold": 3, "alike": 1, "observe": 4, "closer": 2, "indistinguishable": 1, "undoubtedly": 1, "bad": 2, "idea": 1, "cases": 1, "threshold": 23, "ensure": 2, "higher": 2, "extracted": 3, "ith": 1, "xi": 26, "forwarding": 1, "vary": 2, "end": 1, "likelihood": 3, "estimator": 1, "mle": 3, "class": 8, "hli": 14, "closest": 1, "tensor": 1, "shape": 1, "ti": 3, "cls": 11, "sep": 2, "representation": 4, "single": 7, "tting": 1, "aggregate": 1, "taking": 2, "averaging": 1, "sequence": 1, "length": 1, "avg": 3, "li": 10, "later": 2, "conditional": 3, "gaussian": 4, "tied": 1, "covariance": 2, "lc": 4, "multivariate": 1, "estimated": 2, "label": 4, "parameters": 5, "tted": 1, "assign": 5, "sl": 11, "close": 1, "testing": 9, "terms": 4, "lth": 1, "largest": 1, "log": 4, "max": 2, "th": 17, "calculated": 5, "equation": 3, "aggregation": 4, "immediately": 1, "interesting": 2, "trend": 1, "distributed": 2, "leftward": 1, "indicating": 1, "utterly": 1, "shallow": 3, "unlike": 1, "resemble": 4, "abnormality": 2, "start": 2, "overlapped": 1, "distinguished": 2, "instead": 4, "gradually": 1, "deviating": 1, "reveals": 1, "abruptly": 2, "lay": 1, "network": 3, "combination": 5, "general": 3, "leave": 3, "phenomenons": 1, "observed": 3, "pronounced": 1, "way": 6, "hid": 1, "den": 1, "evolve": 2, "design": 1, "evaluate": 1, "dif": 2, "cult": 2, "detector": 29, "measures": 2, "dence": 4, "assigns": 1, "subsection": 2, "note": 5, "setting": 6, "job": 1, "representa": 1, "tions": 1, "aggregated": 1, "indicates": 1, "sam": 2, "ples": 1, "decision": 2, "report": 4, "area": 1, "receiver": 1, "operating": 1, "characteristic": 1, "curve": 1, "auroc": 26, "perfect": 1, "random": 4, "demonstrate": 1, "canonical": 1, "left": 5, "hand": 7, "easily": 6, "separated": 3, "early": 2, "remain": 1, "dissimilar": 1, "turn": 1, "attention": 1, "right": 4, "miserable": 1, "situation": 1, "twists": 1, "burst": 1, "lasting": 1, "ayer": 12, "arate": 1, "stay": 1, "equally": 2, "identi": 2, "empirically": 1, "worst": 1, "tested": 1, "inseparable": 2, "place": 1, "easiest": 1, "harder": 2, "looks": 1, "dimensional": 1, "representing": 1, "good": 1, "softmax": 2, "logit": 1, "temperature": 1, "scaling": 1, "overall": 1, "patterns": 1, "distribute": 1, "displayed": 1, "consistently": 1, "unsure": 2, "scatter": 1, "icting": 1, "assured": 1, "message": 1, "lousy": 1, "determining": 1, "sure": 2, "potential": 3, "needs": 3, "sees": 1, "handle": 1, "converted": 1, "counterpart": 2, "helps": 1, "developer": 1, "malicious": 2, "users": 1, "undertaken": 1, "secure": 1, "focus": 3, "designing": 1, "tell": 1, "kind": 2, "existing": 3, "detections": 1, "discuss": 5, "behaves": 1, "framework": 4, "scenario": 1, "corresponding": 2, "determined": 2, "stage": 38, "pipeline": 1, "earlier": 5, "build": 12, "thinks": 1, "proceed": 1, "aims": 2, "isolate": 1, "feasible": 1, "observation": 1, "cause": 2, "problems": 1, "proceeding": 1, "require": 3, "additional": 2, "stated": 2, "perfectly": 1, "averaged": 2, "varying": 1, "variance": 5, "small": 4, "aurocs": 3, "xed": 6, "selecting": 4, "highest": 2, "thresholds": 6, "precisely": 1, "explained": 2, "dividing": 1, "makes": 3, "discussed": 1, "assume": 2, "ideal": 1, "reasonable": 1, "assumption": 1, "high": 1, "decent": 1, "simpler": 1, "powerful": 1, "combining": 1, "cascading": 2, "trivial": 1, "overlooked": 1, "discussion": 1, "conclusion": 1, "analyze": 1, "benchmarked": 1, "comprehensive": 1, "characterize": 1, "unstable": 1, "refrains": 1, "utilizing": 1, "aspect": 1, "contrary": 1, "evident": 1, "analysis": 5, "original": 2, "superiority": 1, "elevate": 1, "believe": 6, "deploying": 1, "properly": 1, "step": 1, "achieve": 1, "correctly": 1, "identify": 2, "anomalous": 1, "topic": 3, "developing": 1, "trust": 2, "worthy": 2, "machine": 1, "vision": 2, "speech": 2, "tasks": 1, "pioneering": 1, "thorough": 1, "exhaustive": 1, "shed": 1, "lights": 1, "references": 2, "jacob": 1, "devlin": 1, "ming": 1, "wei": 3, "chang": 2, "kenton": 1, "kristina": 1, "toutanova": 1, "pretraining": 2, "bidirectional": 1, "transformers": 5, "proceedings": 17, "conference": 16, "north": 1, "american": 1, "chapter": 1, "association": 22, "computational": 24, "linguistics": 24, "human": 3, "technologies": 2, "volume": 3, "short": 4, "papers": 2, "pages": 18, "minneapolis": 1, "minnesota": 1, "siddhant": 1, "goutham": 1, "empirical": 7, "emnlp": 4, "online": 9, "dan": 3, "kevin": 2, "baseline": 3, "misclassi": 1, "ofdistribution": 1, "neural": 5, "networks": 3, "international": 7, "xiaoyuan": 1, "liu": 6, "eric": 1, "wallace": 1, "adam": 1, "dziedzic": 1, "rishabh": 2, "krishnan": 1, "dawn": 1, "song": 1, "pretrained": 1, "improve": 1, "robustness": 3, "annual": 5, "meeting": 5, "di": 2, "jin": 4, "zhijing": 1, "joey": 1, "tianyi": 1, "zhou": 2, "peter": 2, "szolovits": 1, "strong": 1, "entailment": 1, "aaai": 2, "arti": 2, "cial": 2, "intelligence": 2, "kimin": 1, "kibok": 1, "honglak": 1, "jinwoo": 1, "shin": 1, "advances": 2, "information": 4, "systems": 2, "quentin": 3, "lhoest": 3, "albert": 2, "villanova": 2, "del": 2, "moral": 2, "patrick": 3, "von": 4, "platen": 3, "thomas": 3, "wolf": 3, "mario": 2, "sasko": 2, "yacine": 3, "jernite": 3, "abhishek": 2, "thakur": 2, "lewis": 3, "tunstall": 2, "suraj": 2, "patil": 2, "mariama": 3, "drame": 3, "julien": 6, "chaumond": 3, "plu": 3, "joe": 3, "davison": 3, "simon": 2, "brandeis": 2, "victor": 4, "sanh": 3, "teven": 3, "le": 3, "scao": 3, "canwen": 3, "xu": 6, "nicolas": 2, "patry": 2, "steven": 1, "angelina": 2, "mcmillan": 2, "major": 2, "philipp": 2, "schmid": 2, "sylvain": 4, "gugger": 3, "nathan": 1, "raw": 1, "lesage": 1, "anton": 1, "lozhkov": 1, "matthew": 1, "carrigan": 1, "theo": 2, "matussiere": 2, "leandro": 1, "werra": 1, "lysandre": 3, "debut": 3, "stas": 2, "bekman": 2, "clement": 3, "delangue": 3, "gunjan": 1, "chhablani": 1, "bhavitvya": 1, "malik": 1, "pierric": 2, "cistac": 2, "thibault": 1, "goehringer": 1, "mustar": 1, "francois": 1, "lagunas": 1, "alexander": 2, "rush": 2, "demonstrations": 3, "punta": 1, "cana": 1, "dominican": 1, "republic": 1, "linyang": 1, "ruotian": 1, "ma": 2, "qipeng": 1, "guo": 1, "xiangyang": 1, "xue": 1, "xipeng": 1, "qiu": 1, "shiyu": 1, "liang": 1, "yixuan": 1, "srikant": 1, "enhancing": 1, "reliability": 1, "image": 1, "iclr": 1, "yinhan": 1, "myle": 1, "ott": 1, "naman": 1, "goyal": 1, "jingfei": 1, "du": 1, "mandar": 1, "joshi": 1, "danqi": 1, "chen": 1, "omer": 1, "levy": 1, "mike": 1, "luke": 1, "zettlemoyer": 1, "veselin": 1, "stoyanov": 1, "robustly": 1, "optimized": 1, "andrew": 3, "maas": 1, "raymond": 1, "daly": 1, "pham": 1, "huang": 1, "ng": 2, "christopher": 3, "potts": 2, "vectors": 1, "portland": 1, "oregon": 1, "usa": 2, "maheshwary": 2, "saket": 1, "vikram": 1, "pudi": 1, "hard": 1, "black": 1, "box": 1, "john": 2, "morris": 2, "eli": 2, "jack": 1, "lanchantin": 1, "yangfeng": 1, "ji": 1, "yanjun": 2, "qi": 2, "reevaluating": 1, "findings": 2, "yong": 1, "jake": 1, "grigsby": 1, "augmentation": 1, "danish": 1, "pruthi": 1, "bhuwan": 1, "dhingra": 1, "zachary": 1, "lipton": 1, "combating": 1, "misspellings": 1, "recognition": 1, "florence": 2, "italy": 2, "shuhuai": 1, "yihe": 1, "deng": 1, "kun": 1, "wanxiang": 2, "che": 2, "richard": 1, "socher": 1, "alex": 1, "perelygin": 1, "jean": 1, "wu": 1, "jason": 1, "chuang": 1, "manning": 1, "recursive": 1, "semantic": 1, "compositionality": 1, "treebank": 1, "seattle": 1, "washington": 1, "yuxuan": 1, "wang": 4, "ivan": 1, "titov": 1, "shay": 1, "cohen": 1, "zhilin": 1, "lei": 1, "ting": 1, "dependency": 1, "parsers": 1, "acl": 1, "ijcnlp": 2, "zhaoyang": 1, "hongtao": 1, "defense": 1, "level": 2, "encoding": 1, "engineering": 1, "management": 1, "springer": 1, "anthony": 1, "moi": 1, "tim": 1, "rault": 1, "remi": 1, "louf": 1, "morgan": 1, "funtowicz": 1, "shleifer": 1, "clara": 1, "stateof": 1, "art": 1, "hong": 2, "keqing": 1, "yuanmeng": 1, "yan": 1, "sihong": 1, "zijun": 1, "weiran": 1, "generative": 1, "distance": 1, "domain": 2, "mahalanobis": 1, "space": 1, "barcelona": 1, "spain": 1, "committee": 1, "keyang": 1, "tongzheng": 1, "shikun": 1, "zhang": 2, "yihao": 1, "feng": 1, "caiming": 1, "xiong": 1, "unsupervised": 1, "joint": 2, "kiyoon": 1, "jangho": 1, "kim": 1, "jiho": 1, "jang": 1, "nojun": 1, "kwak": 1, "density": 1, "estimation": 1, "xiang": 1, "junbo": 1, "zhao": 1, "yann": 1, "lecun": 1, "character": 1, "convolutional": 1, "yichao": 1, "jyun": 1, "yu": 1, "jiang": 1, "kai": 1, "discriminate": 1, "perturbations": 1, "blocking": 1, "kong": 1, "china": 1, "checklist": 5, "read": 2, "guidelines": 3, "carefully": 1, "question": 1, "default": 1, "todo": 1, "yes": 12, "encouraged": 1, "justi": 1, "referencing": 1, "appropriate": 1, "providing": 1, "brief": 1, "inline": 1, "description": 1, "license": 5, "code": 7, "proprietary": 1, "modify": 1, "macros": 1, "answers": 2, "page": 1, "limit": 1, "delete": 1, "instructions": 3, "block": 1, "heading": 1, "authors": 3, "main": 2, "claims": 1, "accurately": 1, "ect": 1, "scope": 1, "limitations": 1, "societal": 1, "impacts": 1, "ethics": 1, "ensured": 1, "conforms": 1, "theoretical": 3, "assumptions": 1, "complete": 1, "proofs": 1, "ran": 1, "needed": 1, "reproduce": 1, "experimental": 1, "supplemental": 2, "material": 2, "url": 2, "submitted": 1, "publicly": 1, "accepted": 1, "specify": 1, "splits": 1, "hyperparameters": 1, "chosen": 1, "error": 2, "bars": 2, "respect": 1, "seed": 1, "running": 2, "times": 1, "provide": 3, "variations": 1, "runs": 1, "compute": 1, "resources": 1, "gpus": 1, "internal": 1, "cluster": 1, "cloud": 1, "provider": 1, "assets": 6, "curating": 3, "releasing": 2, "new": 3, "uses": 1, "cite": 1, "creators": 1, "mention": 1, "licenses": 1, "consent": 1, "people": 1, "personally": 1, "offensive": 3, "content": 1, "crowdsourcing": 1, "conducted": 2, "research": 2, "subjects": 1, "participants": 2, "screenshots": 1, "applicable": 2, "participant": 2, "risks": 1, "links": 1, "institutional": 1, "board": 1, "irb": 1, "approvals": 1, "hourly": 1, "wage": 1, "paid": 1, "spent": 1, "compensation": 1, "broader": 1, "impact": 2, "ethical": 1, "building": 1, "contribution": 1, "ai": 2, "comparing": 3, "order": 1, "necessary": 1, "highlight": 1, "importance": 1, "critical": 1, "problem": 3, "emphasized": 1, "tackle": 1, "deployed": 1, "daily": 1, "life": 1, "open": 1, "crucial": 1, "direction": 1, "improving": 1, "motivated": 1, "think": 3, "possibility": 1, "mis": 1, "vicious": 1, "user": 2, "intention": 1, "knows": 1, "craft": 1, "stronger": 1, "bypass": 1, "risk": 1, "violate": 1, "ethic": 1, "neurips": 1, "load": 2, "split": 4, "means": 2, "contain": 2, "subjective": 1, "opinions": 1, "removing": 2, "languages": 1, "unable": 1, "includes": 1, "create": 1, "mismatch": 1, "download": 1, "failed": 2, "development": 4, "fool": 1, "equal": 2, "add": 1, "enlarge": 1, "pairs": 2, "preprocessing": 1, "remove": 1, "br": 2, "prevent": 1, "artifacts": 1, "implementation": 2, "summand": 1, "omit": 1, "constant": 1, "formula": 1, "hl": 2, "run": 1, "time": 1, "infrastructure": 1, "codes": 1, "implemented": 1, "pytorch": 1, "takes": 1, "hours": 1, "tesla": 1, "supplementary": 3, "figures": 1, "illustration": 1, "gure": 1, "gures": 1, "behaviors": 1, "generally": 2, "differentiate": 1, "behavior": 1, "shallower": 1, "grow": 1, "poor": 1, "remind": 1, "readers": 1, "smaller": 1, "footnote": 1, "separation": 1, "sco": 1, "core": 1, "scor": 2, "explain": 1, "cascade": 1, "dev": 5, "percentile": 4, "collect": 1, "improved": 1, "accuracy": 5, "obvious": 1, "guessing": 1, "selected": 1, "optimal": 1, "ned": 1, "precision": 1, "recall": 1, "procedures": 1, "faq": 1, "choose": 3, "comparison": 1, "utilize": 1, "tokenized": 1, "tokenizers": 1, "tried": 1, "inferior": 1, "construct": 1, "exactly": 1, "labeling": 1, "come": 1, "sampling": 1, "implementations": 1, "consist": 2, "instance": 4, "fail": 1, "included": 3, "leads": 1, "condition": 1, "normal": 1, "requires": 1, "isn": 1, "unreasonable": 1, "odd": 1, "designed": 1, "predictions": 1, "wrong": 4}}}
